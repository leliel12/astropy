<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Instantiating and Evaluating Models &mdash; Astropy v1.2.dev14978</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.dev14978',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev14978" href="../index.html" />
    <link rel="up" title="Models and Fitting (astropy.modeling)" href="index.html" />
    <link rel="next" title="Parameters" href="parameters.html" />
    <link rel="prev" title="Models and Fitting (astropy.modeling)" href="index.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="parameters.html" title="Parameters">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="index.html" title="Models and Fitting (astropy.modeling)">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v1.2.dev14978</a>
	 &raquo;
      </li>
      <li><a href="index.html" accesskey="U">Models and Fitting (<code class="docutils literal"><span class="pre">astropy.modeling</span></code>)</a> &raquo;</li>
      
      <li>Instantiating and Evaluating Models</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="instantiating-and-evaluating-models">
<span id="modeling-instantiating"></span><h1>Instantiating and Evaluating Models<a class="headerlink" href="#instantiating-and-evaluating-models" title="Permalink to this headline">Â¶</a></h1>
<p>The base class of all models is <a class="reference internal" href="../api/astropy.modeling.Model.html#astropy.modeling.Model" title="astropy.modeling.Model"><code class="xref py py-obj docutils literal"><span class="pre">Model</span></code></a>, however
fittable models should subclass <a class="reference internal" href="../api/astropy.modeling.FittableModel.html#astropy.modeling.FittableModel" title="astropy.modeling.FittableModel"><code class="xref py py-obj docutils literal"><span class="pre">FittableModel</span></code></a>.
Fittable models can be linear or nonlinear in a regression analysis sense.</p>
<p>In general models are instantiated by providing the parameter values that
define that instance of the model to the constructor, as demonstrated in
the section on <a class="reference internal" href="parameters.html#modeling-parameters"><span>Parameters</span></a>.</p>
<p>Additionally, a <a class="reference internal" href="../api/astropy.modeling.Model.html#astropy.modeling.Model" title="astropy.modeling.Model"><code class="xref py py-obj docutils literal"><span class="pre">Model</span></code></a> instance may represent a single model
with one set of parameters, or a model <em>set</em> consisting of a set of parameters
each representing a different parameterization of the same parametric model.
For example one may instantiate a single Gaussian model with one mean, standard
deviation, and amplitude.  Or one may create a set of N Gaussians, each one of
which would be fitted to, for example, a different plane in an image cube.</p>
<p>Regardless of whether using a single model, or a model set, parameter values
may be scalar values, or arrays of any size and shape, so long as they are
compatible according to the standard <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.broadcasting.html">Numpy broadcasting rules</a>.  For example,
a model may be instantiated with all scalar parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">Gaussian1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">&lt;Gaussian1D(amplitude=1.0, mean=0.0, stddev=1.0)&gt;</span>
</pre></div>
</div>
<p>The newly created model instance <code class="docutils literal"><span class="pre">g</span></code> now works like a Gaussian function
with the given parameters fixed.  It takes a single input:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">inputs</span>
<span class="go">(&#39;x&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>The model can also be called without explicitly using keyword arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>Or it may use all array parameters.  For example if all parameters are 2x2
arrays the model is computed element-wise using all elements in the arrays:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>               <span class="n">stddev</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">&lt;Gaussian1D(amplitude=[[ 1., 2.], [ 3., 4.]], mean=[[ 0., 1.], [ 1., 0.]],</span>
<span class="go">stddev=[[ 0.1, 0.2], [ 0.3, 0.4]])&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([[  1.00000000e+00,   7.45330634e-06],</span>
<span class="go">       [  1.15977604e-02,   4.00000000e+00]])</span>
</pre></div>
</div>
<p>Or it may even use a mix of scalar values and arrays of different sizes and
dimensions so long as they are compatible:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([[ 0.60653066,  1.76499381],</span>
<span class="go">       [ 1.81959198,  3.52998761]])</span>
</pre></div>
</div>
<p>In this case, four values are computed&#8211;one using each element of the amplitude
array.  Each model uses a mean of 0.1, and a standard deviation of 0.1 is
used with the amplitudes of 1 and 3, and 0.2 is used with amplitudes 2 and 4.</p>
<p>If any of the parameters have incompatible values this will result in an
error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">stddev</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">InputParameterError</span>: <span class="n">Parameter &#39;mean&#39; of shape (2,) cannot be broadcast</span>
<span class="go">with parameter &#39;stddev&#39; of shape (3,).  All parameter arrays must have</span>
<span class="go">shapes that are mutually compatible according to the broadcasting rules.</span>
</pre></div>
</div>
<div class="section" id="model-sets">
<span id="modeling-model-sets"></span><h2>Model Sets<a class="headerlink" href="#model-sets" title="Permalink to this headline">Â¶</a></h2>
<p>By default, <a class="reference internal" href="../api/astropy.modeling.Model.html#astropy.modeling.Model" title="astropy.modeling.Model"><code class="xref py py-obj docutils literal"><span class="pre">Model</span></code></a> instances represent a single model.
There are two ways, when instantiating a <a class="reference internal" href="../api/astropy.modeling.Model.html#astropy.modeling.Model" title="astropy.modeling.Model"><code class="xref py py-obj docutils literal"><span class="pre">Model</span></code></a> instance, to
create a model set instead.  The first is to specify the <code class="docutils literal"><span class="pre">n_models</span></code> argument
when instantiating the model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">stddev</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">n_models</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">&lt;Gaussian1D(amplitude=[ 1., 2.], mean=[ 0., 0.], stddev=[ 0.1, 0.2],</span>
<span class="go">n_models=2)&gt;</span>
</pre></div>
</div>
<p>When specifying some <code class="docutils literal"><span class="pre">n_models=N</span></code> this requires that the parameter values be
arrays of some kind, the first <em>axis</em> of which has as length of <code class="docutils literal"><span class="pre">N</span></code>.  This
axis is referred to as the <code class="docutils literal"><span class="pre">model_set_axis</span></code>, and by default is is the <code class="docutils literal"><span class="pre">0th</span></code>
axis of parameter arrays.  In this case the parameters were given as 1-D arrays
of length 2.  The values <code class="docutils literal"><span class="pre">amplitude=1,</span> <span class="pre">mean=0,</span> <span class="pre">stddev=0.1</span></code> are the parameters
for the first model in the set.  The values <code class="docutils literal"><span class="pre">amplitude=2,</span> <span class="pre">mean=0,</span> <span class="pre">stddev=0.2</span></code>
are the parameters defining the second model in the set.</p>
<p>This has different semantics from simply using array values for the parameters,
in that ensures that parameter values and input values are matched up according
to the model_set_axis before any other array broadcasting rules are applied.</p>
<p>For example, in the previous section we created a model with array values
like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
</pre></div>
</div>
<p>If instead we treat the rows as values for two different model sets, this
particular instantiation will fail, since only one value is given for mean:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">n_models</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">InputParameterError</span>: <span class="n">All parameter values must be arrays of dimension at</span>
<span class="go">least 1 for model_set_axis=0 (the value given for &#39;mean&#39; is only</span>
<span class="go">0-dimensional)</span>
</pre></div>
</div>
<p>To get around this for now, provide two values for mean:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>               <span class="n">stddev</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">n_models</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>This is different from the case without <code class="docutils literal"><span class="pre">n_models=2</span></code>.  It does not mean that
the value of amplitude is a 2x2 array.  Rather, it means there are <em>two</em> values
for amplitude (one for each model in the set), each of which is 1-D array of
length 2.  The value for the first model is <code class="docutils literal"><span class="pre">[1,</span> <span class="pre">2]</span></code>, and the value for the
second model is <code class="docutils literal"><span class="pre">[3,</span> <span class="pre">4]</span></code>.  Likewise, scalar values are given for the mean and
standard deviation of each model in the set.</p>
<p>When evaluating this model on a single input we get a different result from the
single-model case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([[ 0.60653066,  1.21306132],</span>
<span class="go">       [ 2.64749071,  3.52998761]])</span>
</pre></div>
</div>
<p>Each row in this output is the output for each model in the set.  The first is
the value of the Gaussian with <code class="docutils literal"><span class="pre">amplitude=[1,</span> <span class="pre">2],</span> <span class="pre">mean=0.1,</span> <span class="pre">stddev=0.1</span></code>, and
the second is the value of the Gaussian with <code class="docutils literal"><span class="pre">amplitude=[3,</span> <span class="pre">4],</span> <span class="pre">mean=0.1,</span>
<span class="pre">stddev=0.2</span></code>.</p>
<p>We can also pass a different input to each model in a model set by passing in
an array input:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">array([[  6.06530660e-01,   1.21306132e+00],</span>
<span class="go">       [  1.20195892e-04,   1.60261190e-04]])</span>
</pre></div>
</div>
<p>By default this uses the same concept of a <code class="docutils literal"><span class="pre">model_set_axis</span></code>.  The first
dimension of the input array is used to map inputs to corresponding models in
the model set.  We can use this, for example, to evaluate the model on 1-D
array inputs with a different input to each model set:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="go">array([[  6.06530660e-01,   5.15351422e-18],</span>
<span class="go">       [  7.57849134e-20,   8.84815213e-46]])</span>
</pre></div>
</div>
<p>In this case the first model is evaluated on <code class="docutils literal"><span class="pre">[0,</span> <span class="pre">1]</span></code>, and the second model
is evaluated on <code class="docutils literal"><span class="pre">[2,</span> <span class="pre">3]</span></code>.  If the input has length greater than the number of
models in the set then this is in error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Input argument &#39;x&#39; does not have the correct dimensions in</span>
<span class="go">model_set_axis=0 for a model set with n_models=2.</span>
</pre></div>
</div>
<p>And input like <code class="docutils literal"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></code> wouldn&#8217;t work anyways because it is not compatible
with the array dimensions of the parameter values.  However, what if we wanted
to evaluate all models in the set on the input <code class="docutils literal"><span class="pre">[0,</span> <span class="pre">1]</span></code>?  We could do this
by simply repeating:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">array([[  6.06530660e-01,   5.15351422e-18],</span>
<span class="go">       [  2.64749071e+00,   1.60261190e-04]])</span>
</pre></div>
</div>
<p>But there is a workaround for this use case that does not necessitate
duplication.  This is to include the argument <code class="docutils literal"><span class="pre">model_set_axis=False</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">model_set_axis</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">array([[  6.06530660e-01,   5.15351422e-18],</span>
<span class="go">       [  2.64749071e+00,   1.60261190e-04]])</span>
</pre></div>
</div>
<p>What <code class="docutils literal"><span class="pre">model_set_axis=False</span></code> implies is that an array-like input should not be
treated as though any of its dimensions map to models in a model set.  And
rather, the given input should be used to evaluate all the models in the model
set.  For scalar inputs like <code class="docutils literal"><span class="pre">g(0)</span></code>, <code class="docutils literal"><span class="pre">model_set_axis=False</span></code> is implied
automatically.  But for array inputs it is necessary to avoid ambiguity.</p>
</div>
<div class="section" id="model-inverses">
<h2>Model Inverses<a class="headerlink" href="#model-inverses" title="Permalink to this headline">Â¶</a></h2>
<p>All models have a <a class="reference internal" href="../api/astropy.modeling.Model.html#astropy.modeling.Model.inverse" title="astropy.modeling.Model.inverse"><code class="xref py py-obj docutils literal"><span class="pre">Model.inverse</span></code></a> property
which may, for some models, return a new model that is the analytic inverse of
the model it is attached to.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">Linear1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linear</span> <span class="o">=</span> <span class="n">Linear1D</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linear</span><span class="o">.</span><span class="n">inverse</span>
<span class="go">&lt;Linear1D(slope=1.25, intercept=-1.25)&gt;</span>
</pre></div>
</div>
<p>The inverse of a model will always be a fully instantiated model in its own
right, and so can be evaluated directly like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">linear</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="go">1.25</span>
</pre></div>
</div>
<p>It is also possible to assign a <em>custom</em> inverse to a model.  This may be
useful, for example, in cases where a model does not have an analytic inverse,
but may have an approximate inverse that was computed numerically and is
represented by a polynomial.  This works even if the target model has a
default analytic inverse&#8211;in this case the default is overridden with the
custom inverse:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">Polynomial1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linear</span><span class="o">.</span><span class="n">inverse</span> <span class="o">=</span> <span class="n">Polynomial1D</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c0</span><span class="o">=-</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="mf">1.25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linear</span><span class="o">.</span><span class="n">inverse</span>
<span class="go">&lt;Polynomial1D(1, c0=-1.25, c1=1.25)&gt;</span>
</pre></div>
</div>
<p>If a custom inverse has been assigned to a model, it can be deleted with
<code class="docutils literal"><span class="pre">del</span> <span class="pre">model.inverse</span></code>.  This resets the inverse to its default (if one exists).
If a default does not exist, accessing <code class="docutils literal"><span class="pre">model.inverse</span></code> raises a
<code class="xref py py-obj docutils literal"><span class="pre">NotImplementedError</span></code>.  For example polynomial models do not have a default
inverse:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">linear</span><span class="o">.</span><span class="n">inverse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linear</span><span class="o">.</span><span class="n">inverse</span>
<span class="go">&lt;Linear1D(slope=1.25, intercept=-1.25)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Polynomial1D</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">c2</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;astropy\modeling\core.py&quot;</span>, line <span class="m">796</span>, in <span class="n">inverse</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;An analytical inverse transform has not &quot;</span>
<span class="gr">NotImplementedError</span>: <span class="n">An analytical inverse transform has not been</span>
<span class="go">implemented for this model.</span>
</pre></div>
</div>
<p>One may certainly compute an inverse and assign it to a polynomial model
though.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When assigning a custom inverse to a model no validation is performed to
ensure that it is actually an inverse or even approximate inverse.  So
assign custom inverses at your own risk.</p>
</div>
</div>
<div class="section" id="further-examples">
<h2>Further examples<a class="headerlink" href="#further-examples" title="Permalink to this headline">Â¶</a></h2>
<p>The examples here assume this import statement was executed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">Gaussian1D</span><span class="p">,</span> <span class="n">Polynomial1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
<ul>
<li><p class="first">Create a model set of two 1-D Gaussians:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g1</span> <span class="o">=</span> <span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">stddev</span><span class="o">=</span><span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_models</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">g1</span><span class="p">)</span>
<span class="go">Model: Gaussian1D</span>
<span class="go">Inputs: (&#39;x&#39;,)</span>
<span class="go">Outputs: (&#39;y&#39;,)</span>
<span class="go">Model set size: 2</span>
<span class="go">Parameters:</span>
<span class="go">    amplitude mean stddev</span>
<span class="go">    --------- ---- ------</span>
<span class="go">         10.0  2.0   0.15</span>
<span class="go">          9.0  3.0    0.1</span>
</pre></div>
</div>
<p>Evaluate all models in the set on one set of input coordinates:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">g1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model_set_axis</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c"># broadcast the array to all models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 90)</span>
</pre></div>
</div>
<p>or different inputs for each model in the set:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">g1</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 90)</span>
</pre></div>
</div>
</li>
</ul>
<p>(<a class="reference external" href="../modeling/models-1.py">Source code</a>, <a class="reference external" href="../modeling/models-1.png">png</a>, <a class="reference external" href="../modeling/models-1.hires.png">hires.png</a>, <a class="reference external" href="../modeling/models-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/models-1.png" src="../_images/models-1.png" />
</div>
<p>(<a class="reference external" href="../modeling/models-2.py">Source code</a>, <a class="reference external" href="../modeling/models-2.png">png</a>, <a class="reference external" href="../modeling/models-2.hires.png">hires.png</a>, <a class="reference external" href="../modeling/models-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/models-2.png" src="../_images/models-2.png" />
</div>
<ul>
<li><p class="first">Evaluating a set of multiple polynomial models with one input data set
creates multiple output data sets:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">Polynomial1D</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_models</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="go">Model: Polynomial1D</span>
<span class="go">Inputs: (&#39;x&#39;,)</span>
<span class="go">Outputs: (&#39;y&#39;,)</span>
<span class="go">Model set size: 5</span>
<span class="go">Degree: 1</span>
<span class="go">Parameters:</span>
<span class="go">     c0  c1</span>
<span class="go">    --- ---</span>
<span class="go">    0.0 0.0</span>
<span class="go">    0.0 1.0</span>
<span class="go">    0.0 2.0</span>
<span class="go">    0.0 3.0</span>
<span class="go">    0.0 4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">p1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model_set_axis</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>(<a class="reference external" href="../modeling/models-3.py">Source code</a>, <a class="reference external" href="../modeling/models-3.png">png</a>, <a class="reference external" href="../modeling/models-3.hires.png">hires.png</a>, <a class="reference external" href="../modeling/models-3.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/models-3.png" src="../_images/models-3.png" />
</div>
<ul>
<li><p class="first">When passed a 2-D array, the same polynomial will map each row of the array
to one model in the set, one for one:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">p1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">array([[   0.,    0.,    0.,    0.,    0.,    0.],</span>
<span class="go">       [   6.,    7.,    8.,    9.,   10.,   11.],</span>
<span class="go">       [  24.,   26.,   28.,   30.,   32.,   34.],</span>
<span class="go">       [  54.,   57.,   60.,   63.,   66.,   69.],</span>
<span class="go">       [  96.,  100.,  104.,  108.,  112.,  116.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(5, 6)</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Instantiating and Evaluating Models</a><ul>
<li><a class="reference internal" href="#model-sets">Model Sets</a></li>
<li><a class="reference internal" href="#model-inverses">Model Inverses</a></li>
<li><a class="reference internal" href="#further-examples">Further examples</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/master/docs/modeling/models.rst">Edit This Page on Github</a> &nbsp;
    <a href="../_sources/modeling/models.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.5. &nbsp;
    Last built 29 Apr 2016. <br/>
  </p>
</footer>
  </body>
</html>