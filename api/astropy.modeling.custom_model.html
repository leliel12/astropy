<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>custom_model &mdash; Astropy v1.2.dev15003</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.dev15003',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev15003" href="../index.html" />
    <link rel="up" title="Models and Fitting (astropy.modeling)" href="../modeling/index.html" />
    <link rel="next" title="Fittable1DModel" href="astropy.modeling.Fittable1DModel.html" />
    <link rel="prev" title="leastsquare" href="astropy.modeling.statistic.leastsquare.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.modeling.Fittable1DModel.html" title="Fittable1DModel">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="astropy.modeling.statistic.leastsquare.html" title="leastsquare">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v1.2.dev15003</a>
	 &raquo;
      </li>
      <li><a href="../modeling/index.html" accesskey="U">Models and Fitting (<code class="docutils literal"><span class="pre">astropy.modeling</span></code>)</a> &raquo;</li>
      
      <li>custom_model</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="custom-model">
<h1>custom_model<a class="headerlink" href="#custom-model" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="astropy.modeling.custom_model">
<code class="descclassname">astropy.modeling.</code><code class="descname">custom_model</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/modeling/core.py#L2554" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/modeling/core.html#custom_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.modeling.custom_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a model from a user defined function. The inputs and parameters of
the model will be inferred from the arguments of the function.</p>
<p>This can be used either as a function or as a decorator.  See below for
examples of both usages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All model parameters have to be defined as keyword arguments with
default values in the model function.  Use <a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">None</span></code></a> as a default argument
value if you do not want to have a default value for that parameter.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>func</strong> : function</p>
<blockquote>
<div><p>Function which defines the model.  It should take N positional
arguments where <code class="docutils literal"><span class="pre">N</span></code> is dimensions of the model (the number of
independent variable in the model), and any number of keyword arguments
(the parameters).  It must return the value of the model (typically as
an array, but can also be a scalar for scalar inputs).  This
corresponds to the <a class="reference internal" href="astropy.modeling.Model.html#astropy.modeling.Model.evaluate" title="astropy.modeling.Model.evaluate"><code class="xref py py-obj docutils literal"><span class="pre">evaluate</span></code></a> method.</p>
</div></blockquote>
<p><strong>fit_deriv</strong> : function, optional</p>
<blockquote class="last">
<div><p>Function which defines the Jacobian derivative of the model. I.e., the
derivative with respect to the <em>parameters</em> of the model.  It should
have the same argument signature as <code class="docutils literal"><span class="pre">func</span></code>, but should return a
sequence where each element of the sequence is the derivative
with respect to the corresponding argument. This corresponds to the
<a class="reference internal" href="astropy.modeling.FittableModel.html#astropy.modeling.FittableModel.fit_deriv" title="astropy.modeling.FittableModel.fit_deriv"><code class="xref py py-meth docutils literal"><span class="pre">fit_deriv()</span></code></a> method.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Define a sinusoidal model function as a custom 1D model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">custom_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sine_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sine_deriv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SineModel</span> <span class="o">=</span> <span class="n">custom_model</span><span class="p">(</span><span class="n">sine_model</span><span class="p">,</span> <span class="n">fit_deriv</span><span class="o">=</span><span class="n">sine_deriv</span><span class="p">)</span>
</pre></div>
</div>
<p>Create an instance of the custom model and evaluate it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SineModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>This model instance can now be used like a usual astropy model.</p>
<p>The next example demonstrates a 2D Moffat function model, and also
demonstrates the support for docstrings (this example could also include
a derivative, but it has been omitted for simplicity):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nd">@custom_model</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">Moffat2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x_0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;Two dimensional Moffat function.&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="n">rr_gg</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rr_gg</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">Moffat2D</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
<span class="go">Two dimensional Moffat function.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Moffat2D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  
<span class="go">0.3333333333333333</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">custom_model</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/astropy.modeling.custom_model.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1. &nbsp;
    Last built 12 May 2016. <br/>
  </p>
</footer>
  </body>
</html>