<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>WCS &mdash; Astropy v1.2.dev14978</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.dev14978',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev14978" href="../index.html" />
    <link rel="up" title="World Coordinate System (astropy.wcs)" href="../wcs/index.html" />
    <link rel="next" title="WCSBase" href="astropy.wcs.WCSBase.html" />
    <link rel="prev" title="Tabprm" href="astropy.wcs.Tabprm.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.wcs.WCSBase.html" title="WCSBase">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="astropy.wcs.Tabprm.html" title="Tabprm">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v1.2.dev14978</a>
	 &raquo;
      </li>
      <li><a href="../wcs/index.html" accesskey="U">World Coordinate System (<code class="docutils literal"><span class="pre">astropy.wcs</span></code>)</a> &raquo;</li>
      
      <li>WCS</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="wcs">
<h1>WCS<a class="headerlink" href="#wcs" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="astropy.wcs.WCS">
<em class="property">class </em><code class="descclassname">astropy.wcs.</code><code class="descname">WCS</code><span class="sig-paren">(</span><em>header=None</em>, <em>fobj=None</em>, <em>key=' '</em>, <em>minerr=0.0</em>, <em>relax=True</em>, <em>naxis=None</em>, <em>keysel=None</em>, <em>colsel=None</em>, <em>fix=True</em>, <em>translate_units=''</em>, <em>_do_set=True</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L211" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="astropy.wcs.WCSBase.html#astropy.wcs.WCSBase" title="astropy.wcs.WCSBase"><code class="xref py py-class docutils literal"><span class="pre">astropy.wcs.WCSBase</span></code></a></p>
<p>WCS objects perform standard WCS transformations, and correct for
<a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> and <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup transformations, based
on the WCS keywords and supplementary data read from a FITS file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>header</strong> : astropy.io.fits header object, string, dict-like, or None, optional</p>
<blockquote>
<div><p>If <em>header</em> is not provided or None, the object will be
initialized to default values.</p>
</div></blockquote>
<p><strong>fobj</strong> : An astropy.io.fits file (hdulist) object, optional</p>
<blockquote>
<div><p>It is needed when header keywords point to a <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion
paper</a> lookup table stored in a different extension.</p>
</div></blockquote>
<p><strong>key</strong> : str, optional</p>
<blockquote>
<div><p>The name of a particular WCS transform to use.  This may be
either <code class="docutils literal"><span class="pre">'</span> <span class="pre">'</span></code> or <code class="docutils literal"><span class="pre">'A'</span></code>-<code class="docutils literal"><span class="pre">'Z'</span></code> and corresponds to the
<code class="docutils literal"><span class="pre">&quot;a&quot;</span></code> part of the <code class="docutils literal"><span class="pre">CTYPEia</span></code> cards.  <em>key</em> may only be
provided if <em>header</em> is also provided.</p>
</div></blockquote>
<p><strong>minerr</strong> : float, optional</p>
<blockquote>
<div><p>The minimum value a distortion correction must have in order
to be applied. If the value of <code class="docutils literal"><span class="pre">CQERRja</span></code> is smaller than
<em>minerr</em>, the corresponding distortion is not applied.</p>
</div></blockquote>
<p><strong>relax</strong> : bool or int, optional</p>
<blockquote>
<div><p>Degree of permissiveness:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a> (default): Admit all recognized informal extensions
of the WCS standard.</li>
<li><a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>: Recognize only FITS keywords defined by the
published WCS standard.</li>
<li><a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">int</span></code></a>: a bit field selecting specific extensions to accept.
See <a class="reference internal" href="../wcs/relax.html#relaxread"><span>Header-reading relaxation constants</span></a> for details.</li>
</ul>
</div></blockquote>
<p><strong>naxis</strong> : int or sequence, optional</p>
<blockquote>
<div><p>Extracts specific coordinate axes using
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.sub" title="astropy.wcs.Wcsprm.sub"><code class="xref py py-meth docutils literal"><span class="pre">sub()</span></code></a>.  If a header is provided, and
<em>naxis</em> is not <code class="docutils literal"><span class="pre">None</span></code>, <em>naxis</em> will be passed to
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.sub" title="astropy.wcs.Wcsprm.sub"><code class="xref py py-meth docutils literal"><span class="pre">sub()</span></code></a> in order to select specific
axes from the header.  See <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.sub" title="astropy.wcs.Wcsprm.sub"><code class="xref py py-meth docutils literal"><span class="pre">sub()</span></code></a> for
more details about this parameter.</p>
</div></blockquote>
<p><strong>keysel</strong> : sequence of flags, optional</p>
<blockquote>
<div><p>A sequence of flags used to select the keyword types
considered by wcslib.  When <code class="docutils literal"><span class="pre">None</span></code>, only the standard image
header keywords are considered (and the underlying wcspih() C
function is called).  To use binary table image array or pixel
list keywords, <em>keysel</em> must be set.</p>
<p>Each element in the list should be one of the following
strings:</p>
<ul class="simple">
<li>&#8216;image&#8217;: Image header keywords</li>
<li>&#8216;binary&#8217;: Binary table image array keywords</li>
<li>&#8216;pixel&#8217;: Pixel list keywords</li>
</ul>
<p>Keywords such as <code class="docutils literal"><span class="pre">EQUIna</span></code> or <code class="docutils literal"><span class="pre">RFRQna</span></code> that are common to
binary table image arrays and pixel lists (including
<code class="docutils literal"><span class="pre">WCSNna</span></code> and <code class="docutils literal"><span class="pre">TWCSna</span></code>) are selected by both &#8216;binary&#8217; and
&#8216;pixel&#8217;.</p>
</div></blockquote>
<p><strong>colsel</strong> : sequence of int, optional</p>
<blockquote>
<div><p>A sequence of table column numbers used to restrict the WCS
transformations considered to only those pertaining to the
specified columns.  If <a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">None</span></code></a>, there is no restriction.</p>
</div></blockquote>
<p><strong>fix</strong> : bool, optional</p>
<blockquote>
<div><p>When <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a> (default), call <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.fix" title="astropy.wcs.Wcsprm.fix"><code class="xref py py-obj docutils literal"><span class="pre">fix</span></code></a> on
the resulting object to fix any non-standard uses in the
header.  <a class="reference internal" href="astropy.wcs.FITSFixedWarning.html#astropy.wcs.FITSFixedWarning" title="astropy.wcs.FITSFixedWarning"><code class="xref py py-obj docutils literal"><span class="pre">FITSFixedWarning</span></code></a> Warnings will be emitted if any
changes were made.</p>
</div></blockquote>
<p><strong>translate_units</strong> : str, optional</p>
<blockquote>
<div><p>Specify which potentially unsafe translations of non-standard
unit strings to perform.  By default, performs none.  See
<a class="reference internal" href="#astropy.wcs.WCS.fix" title="astropy.wcs.WCS.fix"><code class="xref py py-obj docutils literal"><span class="pre">WCS.fix</span></code></a> for more information about this parameter.  Only
effective when <code class="docutils literal"><span class="pre">fix</span></code> is <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>Invalid key.</p>
</div></blockquote>
<p><strong>KeyError</strong></p>
<blockquote>
<div><p>Key not found in FITS header.</p>
</div></blockquote>
<p><strong>AssertionError</strong></p>
<blockquote class="last">
<div><p>Lookup table distortion present in the header but <em>fobj</em> was
not provided.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ol class="arabic">
<li><p class="first">astropy.wcs supports arbitrary <em>n</em> dimensions for the core WCS
(the transformations handled by WCSLIB).  However, the
<a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> lookup table and <a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> distortions must be
two dimensional.  Therefore, if you try to create a WCS object
where the core WCS has a different number of dimensions than 2
and that object also contains a <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> lookup
table or <a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> distortion, a <a class="reference external" href="http://docs.python.org/library/exceptions.html#exceptions.ValueError" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">ValueError</span></code></a>
exception will be raised.  To avoid this, consider using the
<em>naxis</em> kwarg to select two dimensions from the core WCS.</p>
</li>
<li><p class="first">The number of coordinate axes in the transformation is not
determined directly from the <code class="docutils literal"><span class="pre">NAXIS</span></code> keyword but instead from
the highest of:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">NAXIS</span></code> keyword</li>
<li><code class="docutils literal"><span class="pre">WCSAXESa</span></code> keyword</li>
<li>The highest axis number in any parameterized WCS keyword.
The keyvalue, as well as the keyword, must be
syntactically valid otherwise it will not be considered.</li>
</ul>
</div></blockquote>
<p>If none of these keyword types is present, i.e. if the header
only contains auxiliary WCS keywords for a particular
coordinate representation, then no coordinate description is
constructed for it.</p>
<p>The number of axes, which is set as the <code class="docutils literal"><span class="pre">naxis</span></code> member, may
differ for different coordinate representations of the same
image.</p>
</li>
<li><p class="first">When the header includes duplicate keywords, in most cases the
last encountered is used.</p>
</li>
<li><p class="first"><a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.set" title="astropy.wcs.Wcsprm.set"><code class="xref py py-obj docutils literal"><span class="pre">set</span></code></a> is called immediately after
construction, so any invalid keywords or transformations will
be raised by the constructor, not when subsequently calling a
transformation method.</p>
</li>
</ol>
<p class="rubric">Attributes Summary</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.axis_type_names" title="astropy.wcs.WCS.axis_type_names"><code class="xref py py-obj docutils literal"><span class="pre">axis_type_names</span></code></a></td>
<td>World names for each coordinate axis</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.celestial" title="astropy.wcs.WCS.celestial"><code class="xref py py-obj docutils literal"><span class="pre">celestial</span></code></a></td>
<td>A copy of the current WCS with only the celestial axes included</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.has_celestial" title="astropy.wcs.WCS.has_celestial"><code class="xref py py-obj docutils literal"><span class="pre">has_celestial</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.is_celestial" title="astropy.wcs.WCS.is_celestial"><code class="xref py py-obj docutils literal"><span class="pre">is_celestial</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.pixel_scale_matrix" title="astropy.wcs.WCS.pixel_scale_matrix"><code class="xref py py-obj docutils literal"><span class="pre">pixel_scale_matrix</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.all_pix2world" title="astropy.wcs.WCS.all_pix2world"><code class="xref py py-obj docutils literal"><span class="pre">all_pix2world</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Transforms pixel coordinates to world coordinates.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-obj docutils literal"><span class="pre">all_world2pix</span></code></a>(*arg[,&nbsp;accuracy,&nbsp;maxiter,&nbsp;...])</td>
<td>Transforms world coordinates to pixel coordinates, using numerical iteration to invert the full forward transformation <a class="reference internal" href="#astropy.wcs.WCS.all_pix2world" title="astropy.wcs.WCS.all_pix2world"><code class="xref py py-obj docutils literal"><span class="pre">all_pix2world</span></code></a> with complete distortion model.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.calc_footprint" title="astropy.wcs.WCS.calc_footprint"><code class="xref py py-obj docutils literal"><span class="pre">calc_footprint</span></code></a>([header,&nbsp;undistort,&nbsp;axes,&nbsp;center])</td>
<td>Calculates the footprint of the image on the sky.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.copy" title="astropy.wcs.WCS.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>()</td>
<td>Return a shallow copy of the object.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.deepcopy" title="astropy.wcs.WCS.deepcopy"><code class="xref py py-obj docutils literal"><span class="pre">deepcopy</span></code></a>()</td>
<td>Return a deep copy of the object.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.det2im" title="astropy.wcs.WCS.det2im"><code class="xref py py-obj docutils literal"><span class="pre">det2im</span></code></a>(*args)</td>
<td>Convert detector coordinates to image plane coordinates using <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.dropaxis" title="astropy.wcs.WCS.dropaxis"><code class="xref py py-obj docutils literal"><span class="pre">dropaxis</span></code></a>(dropax)</td>
<td>Remove an axis from the WCS.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.fix" title="astropy.wcs.WCS.fix"><code class="xref py py-obj docutils literal"><span class="pre">fix</span></code></a>([translate_units,&nbsp;naxis])</td>
<td>Perform the fix operations from wcslib, and warn about any changes it has made.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.footprint_to_file" title="astropy.wcs.WCS.footprint_to_file"><code class="xref py py-obj docutils literal"><span class="pre">footprint_to_file</span></code></a>([filename,&nbsp;color,&nbsp;width])</td>
<td>Writes out a <a class="reference external" href="http://hea-www.harvard.edu/RD/ds9/">ds9</a> style regions file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.get_axis_types" title="astropy.wcs.WCS.get_axis_types"><code class="xref py py-obj docutils literal"><span class="pre">get_axis_types</span></code></a>()</td>
<td>Similar to <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.axis_types" title="astropy.wcs.Wcsprm.axis_types"><code class="xref py py-obj docutils literal"><span class="pre">self.wcsprm.axis_types</span></code></a> but provides the information in a more Python-friendly format.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.p4_pix2foc" title="astropy.wcs.WCS.p4_pix2foc"><code class="xref py py-obj docutils literal"><span class="pre">p4_pix2foc</span></code></a>(*args)</td>
<td>Convert pixel coordinates to focal plane coordinates using <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.pix2foc" title="astropy.wcs.WCS.pix2foc"><code class="xref py py-obj docutils literal"><span class="pre">pix2foc</span></code></a>(*args)</td>
<td>Convert pixel coordinates to focal plane coordinates using the <a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention and <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.printwcs" title="astropy.wcs.WCS.printwcs"><code class="xref py py-obj docutils literal"><span class="pre">printwcs</span></code></a>()</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.reorient_celestial_first" title="astropy.wcs.WCS.reorient_celestial_first"><code class="xref py py-obj docutils literal"><span class="pre">reorient_celestial_first</span></code></a>()</td>
<td>Reorient the WCS such that the celestial axes are first, followed by the spectral axis, followed by any others.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.rotateCD" title="astropy.wcs.WCS.rotateCD"><code class="xref py py-obj docutils literal"><span class="pre">rotateCD</span></code></a>(theta)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.sip_foc2pix" title="astropy.wcs.WCS.sip_foc2pix"><code class="xref py py-obj docutils literal"><span class="pre">sip_foc2pix</span></code></a>(*args)</td>
<td>Convert focal plane coordinates to pixel coordinates using the <a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.sip_pix2foc" title="astropy.wcs.WCS.sip_pix2foc"><code class="xref py py-obj docutils literal"><span class="pre">sip_pix2foc</span></code></a>(*args)</td>
<td>Convert pixel coordinates to focal plane coordinates using the <a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.slice" title="astropy.wcs.WCS.slice"><code class="xref py py-obj docutils literal"><span class="pre">slice</span></code></a>(view[,&nbsp;numpy_order])</td>
<td>Slice a WCS instance using a Numpy slice.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.sub" title="astropy.wcs.WCS.sub"><code class="xref py py-obj docutils literal"><span class="pre">sub</span></code></a>(axes)</td>
<td>Extracts the coordinate description for a subimage from a <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a> object.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.swapaxes" title="astropy.wcs.WCS.swapaxes"><code class="xref py py-obj docutils literal"><span class="pre">swapaxes</span></code></a>(ax0,&nbsp;ax1)</td>
<td>Swap axes in a WCS.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.to_fits" title="astropy.wcs.WCS.to_fits"><code class="xref py py-obj docutils literal"><span class="pre">to_fits</span></code></a>([relax,&nbsp;key])</td>
<td>Generate an <a class="reference internal" href="../io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits.HDUList</span></code></a> object with all of the information stored in this object.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal"><span class="pre">to_header</span></code></a>([relax,&nbsp;key])</td>
<td>Generate an <a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits.Header</span></code></a> object with the basic WCS and SIP information stored in this object.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.to_header_string" title="astropy.wcs.WCS.to_header_string"><code class="xref py py-obj docutils literal"><span class="pre">to_header_string</span></code></a>([relax])</td>
<td>Identical to <a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal"><span class="pre">to_header</span></code></a>, but returns a string containing the header cards.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#astropy.wcs.WCS.wcs_pix2world" title="astropy.wcs.WCS.wcs_pix2world"><code class="xref py py-obj docutils literal"><span class="pre">wcs_pix2world</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Transforms pixel coordinates to world coordinates by doing only the basic <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> transformation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#astropy.wcs.WCS.wcs_world2pix" title="astropy.wcs.WCS.wcs_world2pix"><code class="xref py py-obj docutils literal"><span class="pre">wcs_world2pix</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Transforms world coordinates to pixel coordinates, using only the basic <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> WCS transformation.</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="attribute">
<dt id="astropy.wcs.WCS.axis_type_names">
<code class="descname">axis_type_names</code><a class="headerlink" href="#astropy.wcs.WCS.axis_type_names" title="Permalink to this definition">¶</a></dt>
<dd><p>World names for each coordinate axis</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A list of names along each axis</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="astropy.wcs.WCS.celestial">
<code class="descname">celestial</code><a class="headerlink" href="#astropy.wcs.WCS.celestial" title="Permalink to this definition">¶</a></dt>
<dd><p>A copy of the current WCS with only the celestial axes included</p>
</dd></dl>

<dl class="attribute">
<dt id="astropy.wcs.WCS.has_celestial">
<code class="descname">has_celestial</code><a class="headerlink" href="#astropy.wcs.WCS.has_celestial" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="astropy.wcs.WCS.is_celestial">
<code class="descname">is_celestial</code><a class="headerlink" href="#astropy.wcs.WCS.is_celestial" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="astropy.wcs.WCS.pixel_scale_matrix">
<code class="descname">pixel_scale_matrix</code><a class="headerlink" href="#astropy.wcs.WCS.pixel_scale_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="method">
<dt id="astropy.wcs.WCS.all_pix2world">
<code class="descname">all_pix2world</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L1253" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.all_pix2world"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.all_pix2world" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms pixel coordinates to world coordinates.</p>
<p>Performs all of the following in series:</p>
<blockquote>
<div><ul class="simple">
<li>Detector to image plane correction (if present in the
FITS file)</li>
<li><a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> distortion correction (if present in the FITS
file)</li>
<li><a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction (if present
in the FITS file)</li>
<li><a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> &#8220;core&#8221; WCS transformation</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>args</strong> : flexible</p>
<blockquote>
<div><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</li>
<li>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</div></blockquote>
<p><strong>ra_dec_order</strong> : bool, optional</p>
<blockquote>
<div><p>When <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal"><span class="pre">CTYPE</span></code> keywords.  Default is
<a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : array</p>
<blockquote>
<div><p>Returns the sky coordinates, in degrees.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>SingularMatrixError</strong></p>
<blockquote>
<div><p>Linear transformation matrix is singular.</p>
</div></blockquote>
<p><strong>InconsistentAxisTypesError</strong></p>
<blockquote>
<div><p>Inconsistent or unrecognized coordinate axis types.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>Invalid parameter value.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>x- and y-coordinate arrays are not the same size.</p>
</div></blockquote>
<p><strong>InvalidTransformError</strong></p>
<blockquote>
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
<p><strong>InvalidTransformError</strong></p>
<blockquote class="last">
<div><p>Ill-conditioned coordinate transformation parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The order of the axes for the result is determined by the
<code class="docutils literal"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may not
always be of the form (<em>ra</em>, <em>dec</em>).  The
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lat" title="astropy.wcs.Wcsprm.lat"><code class="xref py py-obj docutils literal"><span class="pre">lat</span></code></a>, <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lng" title="astropy.wcs.Wcsprm.lng"><code class="xref py py-obj docutils literal"><span class="pre">lng</span></code></a>,
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lattyp" title="astropy.wcs.Wcsprm.lattyp"><code class="xref py py-obj docutils literal"><span class="pre">lattyp</span></code></a> and <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lngtyp" title="astropy.wcs.Wcsprm.lngtyp"><code class="xref py py-obj docutils literal"><span class="pre">lngtyp</span></code></a>
members can be used to determine the order of the axes.</p>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.all_world2pix">
<code class="descname">all_world2pix</code><span class="sig-paren">(</span><em>*arg</em>, <em>accuracy=1.0e-4</em>, <em>maxiter=20</em>, <em>adaptive=False</em>, <em>detect_divergence=True</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L1792" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.all_world2pix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.all_world2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms world coordinates to pixel coordinates, using
numerical iteration to invert the full forward transformation
<a class="reference internal" href="#astropy.wcs.WCS.all_pix2world" title="astropy.wcs.WCS.all_pix2world"><code class="xref py py-obj docutils literal"><span class="pre">all_pix2world</span></code></a> with complete
distortion model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>args</strong> : flexible</p>
<blockquote>
<div><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</li>
<li>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</div></blockquote>
<p><strong>ra_dec_order</strong> : bool, optional</p>
<blockquote>
<div><p>When <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal"><span class="pre">CTYPE</span></code> keywords.  Default is
<a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>.</p>
</div></blockquote>
<p><strong>tolerance</strong> : float, optional (Default = 1.0e-4)</p>
<blockquote>
<div><p>Tolerance of solution. Iteration terminates when the
iterative solver estimates that the &#8220;true solution&#8221; is
within this many pixels current estimate, more
specifically, when the correction to the solution found
during the previous iteration is smaller
(in the sense of the L2 norm) than <code class="docutils literal"><span class="pre">tolerance</span></code>.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int, optional (Default = 20)</p>
<blockquote>
<div><p>Maximum number of iterations allowed to reach a solution.</p>
</div></blockquote>
<p><strong>quiet</strong> : bool, optional (Default = False)</p>
<blockquote>
<div><p>Do not throw :py:class:<code class="docutils literal"><span class="pre">NoConvergence</span></code> exceptions when
the method does not converge to a solution with the
required accuracy within a specified number of maximum
iterations set by <code class="docutils literal"><span class="pre">maxiter</span></code> parameter. Instead,
simply return the found solution.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : array</p>
<blockquote>
<div><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><p class="first"><strong>adaptive</strong> : bool, optional (Default = False)</p>
<blockquote>
<div><p>Specifies whether to adaptively select only points that
did not converge to a solution within the required
accuracy for the next iteration. Default is recommended
for HST as well as most other instruments.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> uses a vectorized
implementation of the method of consecutive
approximations (see <code class="docutils literal"><span class="pre">Notes</span></code> section below) in which it
iterates over <em>all</em> input points <em>regardless</em> until
the required accuracy has been reached for <em>all</em> input
points. In some cases it may be possible that
<em>almost all</em> points have reached the required accuracy
but there are only a few of input data points for
which additional iterations may be needed (this
depends mostly on the characteristics of the geometric
distortions for a given instrument). In this situation
it may be advantageous to set <code class="docutils literal"><span class="pre">adaptive</span></code> = <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a> in
which case <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> will continue
iterating <em>only</em> over the points that have not yet
converged to the required accuracy. However, for the
HST&#8217;s ACS/WFC detector, which has the strongest
distortions of all HST instruments, testing has
shown that enabling this option would lead to a about
50-100% penalty in computational time (depending on
specifics of the image, geometric distortions, and
number of input points to be converted). Therefore,
for HST and possibly instruments, it is recommended
to set <code class="docutils literal"><span class="pre">adaptive</span></code> = <a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>. The only danger in
getting this setting wrong will be a performance
penalty.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <code class="docutils literal"><span class="pre">detect_divergence</span></code> is <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>,
<a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> will automatically switch
to the adaptive algorithm once divergence has been
detected.</p>
</div>
</div></blockquote>
<p><strong>detect_divergence</strong> : bool, optional (Default = True)</p>
<blockquote>
<div><p>Specifies whether to perform a more detailed analysis
of the convergence to a solution. Normally
<a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> may not achieve the required
accuracy if either the <code class="docutils literal"><span class="pre">tolerance</span></code> or <code class="docutils literal"><span class="pre">maxiter</span></code> arguments
are too low. However, it may happen that for some
geometric distortions the conditions of convergence for
the the method of consecutive approximations used by
<a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> may not be satisfied, in which
case consecutive approximations to the solution will
diverge regardless of the <code class="docutils literal"><span class="pre">tolerance</span></code> or <code class="docutils literal"><span class="pre">maxiter</span></code>
settings.</p>
<p>When <code class="docutils literal"><span class="pre">detect_divergence</span></code> is <a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>, these divergent
points will be detected as not having achieved the
required accuracy (without further details). In addition,
if <code class="docutils literal"><span class="pre">adaptive</span></code> is <a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a> then the algorithm will not
know that the solution (for specific points) is diverging
and will continue iterating and trying to &#8220;improve&#8221;
diverging solutions. This may result in <code class="docutils literal"><span class="pre">NaN</span></code> or
<code class="docutils literal"><span class="pre">Inf</span></code> values in the return results (in addition to a
performance penalties). Even when <code class="docutils literal"><span class="pre">detect_divergence</span></code>
is <a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>, <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a>, at the end of the
iterative process, will identify invalid results
(<code class="docutils literal"><span class="pre">NaN</span></code> or <code class="docutils literal"><span class="pre">Inf</span></code>) as &#8220;diverging&#8221; solutions and will
raise :py:class:<code class="docutils literal"><span class="pre">NoConvergence</span></code> unless the <code class="docutils literal"><span class="pre">quiet</span></code>
parameter is set to <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>.</p>
<p>When <code class="docutils literal"><span class="pre">detect_divergence</span></code> is <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>,
<a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> will detect points for which
current correction to the coordinates is larger than
the correction applied during the previous iteration
<strong>if</strong> the requested accuracy <strong>has not yet been
achieved</strong>. In this case, if <code class="docutils literal"><span class="pre">adaptive</span></code> is <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>,
these points will be excluded from further iterations and
if <code class="docutils literal"><span class="pre">adaptive</span></code> is <a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>, <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> will
automatically switch to the adaptive algorithm. Thus, the
reported divergent solution will be the latest converging
solution computed immediately <em>before</em> divergence
has been detected.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When accuracy has been achieved, small increases in
current corrections may be possible due to rounding
errors (when <code class="docutils literal"><span class="pre">adaptive</span></code> is <a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>) and such
increases will be ignored.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Based on our testing using HST ACS/WFC images, setting
<code class="docutils literal"><span class="pre">detect_divergence</span></code> to <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a> will incur about 5-20%
performance penalty with the larger penalty
corresponding to <code class="docutils literal"><span class="pre">adaptive</span></code> set to <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>.
Because the benefits of enabling this
feature outweigh the small performance penalty,
especially when <code class="docutils literal"><span class="pre">adaptive</span></code> = <a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>, it is
recommended to set <code class="docutils literal"><span class="pre">detect_divergence</span></code> to <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>,
unless extensive testing of the distortion models for
images from specific instruments show a good stability
of the numerical method for a wide range of
coordinates (even outside the image itself).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Indices of the diverging inverse solutions will be
reported in the <code class="docutils literal"><span class="pre">divergent</span></code> attribute of the
raised :py:class:<code class="docutils literal"><span class="pre">NoConvergence</span></code> exception object.</p>
</div>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>NoConvergence</strong></p>
<blockquote>
<div><p>The method did not converge to a
solution to the required accuracy within a specified
number of maximum iterations set by the <code class="docutils literal"><span class="pre">maxiter</span></code>
parameter. To turn off this exception, set <code class="docutils literal"><span class="pre">quiet</span></code> to
<a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>. Indices of the points for which the requested
accuracy was not achieved (if any) will be listed in the
<code class="docutils literal"><span class="pre">slow_conv</span></code> attribute of the
raised :py:class:<code class="docutils literal"><span class="pre">NoConvergence</span></code> exception object.</p>
<p>See :py:class:<code class="docutils literal"><span class="pre">NoConvergence</span></code> documentation for
more details.</p>
</div></blockquote>
<p><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>SingularMatrixError</strong></p>
<blockquote>
<div><p>Linear transformation matrix is singular.</p>
</div></blockquote>
<p><strong>InconsistentAxisTypesError</strong></p>
<blockquote>
<div><p>Inconsistent or unrecognized coordinate axis types.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>Invalid parameter value.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>x- and y-coordinate arrays are not the same size.</p>
</div></blockquote>
<p><strong>InvalidTransformError</strong></p>
<blockquote>
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
<p><strong>InvalidTransformError</strong></p>
<blockquote class="last">
<div><p>Ill-conditioned coordinate transformation parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The order of the axes for the input world array is determined by
the <code class="docutils literal"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may
not always be of the form (<em>ra</em>, <em>dec</em>).  The
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lat" title="astropy.wcs.Wcsprm.lat"><code class="xref py py-obj docutils literal"><span class="pre">lat</span></code></a>, <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lng" title="astropy.wcs.Wcsprm.lng"><code class="xref py py-obj docutils literal"><span class="pre">lng</span></code></a>,
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lattyp" title="astropy.wcs.Wcsprm.lattyp"><code class="xref py py-obj docutils literal"><span class="pre">lattyp</span></code></a>, and
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lngtyp" title="astropy.wcs.Wcsprm.lngtyp"><code class="xref py py-obj docutils literal"><span class="pre">lngtyp</span></code></a>
members can be used to determine the order of the axes.</p>
<p>Using the method of fixed-point iterations approximations we
iterate starting with the initial approximation, which is
computed using the non-distortion-aware
<a class="reference internal" href="#astropy.wcs.WCS.wcs_world2pix" title="astropy.wcs.WCS.wcs_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">wcs_world2pix()</span></code></a> (or equivalent).</p>
<p>The <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> function uses a vectorized
implementation of the method of consecutive approximations and
therefore it is highly efficient (&gt;30x) when <em>all</em> data points
that need to be converted from sky coordinates to image
coordinates are passed at <em>once</em>. Therefore, it is advisable,
whenever possible, to pass as input a long array of all points
that need to be converted to <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> instead
of calling <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal"><span class="pre">all_world2pix()</span></code></a> for each data point. Also
see the note to the <code class="docutils literal"><span class="pre">adaptive</span></code> parameter.</p>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.io.fits</span> <span class="kn">as</span> <span class="nn">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.wcs</span> <span class="kn">as</span> <span class="nn">wcs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wcs</span><span class="o">.</span><span class="n">__path__</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;tests/data/j94f05bgq_flt.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">hdulist</span><span class="p">[(</span><span class="s">&#39;sci&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">header</span><span class="p">,</span> <span class="n">hdulist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_pix2world</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">ra</span><span class="p">)</span>
<span class="go">[ 5.52645627  5.52649663  5.52653698]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
<span class="go">[-72.05171757 -72.05171276 -72.05170795]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radec</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_pix2world</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">radec</span><span class="p">)</span>
<span class="go">[[  5.52645627 -72.05171757]</span>
<span class="go"> [  5.52649663 -72.05171276]</span>
<span class="go"> [  5.52653698 -72.05170795]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[ 1.00000238  2.00000237  3.00000236]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">[ 0.99999996  0.99999997  0.99999997]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">radec</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
<span class="go">[[ 1.00000238  0.99999996]</span>
<span class="go"> [ 2.00000237  0.99999997]</span>
<span class="go"> [ 3.00000236  0.99999997]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">radec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">tolerance</span><span class="o">=</span><span class="mf">1.0e-10</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NoConvergence</span>: <span class="n">&#39;WCS.all_world2pix&#39; failed to converge to the</span>
<span class="go">requested accuracy. After 3 iterations, the solution is</span>
<span class="go">diverging at least for one input point.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Now try to use some diverging data:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divradec</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_pix2world</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="p">[</span><span class="mf">10000.0</span><span class="p">,</span> <span class="mf">50000.0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">divradec</span><span class="p">)</span>
<span class="go">[[  5.52645627 -72.05171757]</span>
<span class="go"> [  7.15976932 -70.8140779 ]</span>
<span class="go"> [  5.52653698 -72.05170795]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># First, turn detect_divergence on:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>  <span class="n">xy</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">divradec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">tolerance</span><span class="o">=</span><span class="mf">1.0e-4</span><span class="p">,</span> <span class="n">adaptive</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">detect_divergence</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">quiet</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="n">wcs</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">NoConvergence</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Indices of diverging points: {0}&quot;</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">divergent</span><span class="p">))</span>
<span class="gp">... </span>  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Indices of poorly converging points: {0}&quot;</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">slow_conv</span><span class="p">))</span>
<span class="gp">... </span>  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Best solution:</span><span class="se">\n</span><span class="s">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">best_solution</span><span class="p">))</span>
<span class="gp">... </span>  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Achieved accuracy:</span><span class="se">\n</span><span class="s">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">accuracy</span><span class="p">))</span>
<span class="go">Indices of diverging points: [1]</span>
<span class="go">Indices of poorly converging points: None</span>
<span class="go">Best solution:</span>
<span class="go">[[  1.00000238e+00   9.99999965e-01]</span>
<span class="go"> [ -1.99441636e+06   1.44309097e+06]</span>
<span class="go"> [  3.00000236e+00   9.99999966e-01]]</span>
<span class="go">Achieved accuracy:</span>
<span class="go">[[  6.13968380e-05   8.59638593e-07]</span>
<span class="go"> [  8.59526812e+11   6.61713548e+11]</span>
<span class="go"> [  6.09398446e-05   8.38759724e-07]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="n">e</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NoConvergence</span>: <span class="n">&#39;WCS.all_world2pix&#39; failed to converge to the</span>
<span class="go">requested accuracy.  After 5 iterations, the solution is</span>
<span class="go">diverging at least for one input point.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># This time turn detect_divergence off:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>  <span class="n">xy</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">divradec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">tolerance</span><span class="o">=</span><span class="mf">1.0e-4</span><span class="p">,</span> <span class="n">adaptive</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">detect_divergence</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">quiet</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="n">wcs</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">NoConvergence</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Indices of diverging points: {0}&quot;</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">divergent</span><span class="p">))</span>
<span class="gp">... </span>  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Indices of poorly converging points: {0}&quot;</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">slow_conv</span><span class="p">))</span>
<span class="gp">... </span>  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Best solution:</span><span class="se">\n</span><span class="s">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">best_solution</span><span class="p">))</span>
<span class="gp">... </span>  <span class="k">print</span><span class="p">(</span><span class="s">&quot;Achieved accuracy:</span><span class="se">\n</span><span class="s">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">accuracy</span><span class="p">))</span>
<span class="go">Indices of diverging points: [1]</span>
<span class="go">Indices of poorly converging points: None</span>
<span class="go">Best solution:</span>
<span class="go">[[ 1.00000009  1.        ]</span>
<span class="go"> [        nan         nan]</span>
<span class="go"> [ 3.00000009  1.        ]]</span>
<span class="go">Achieved accuracy:</span>
<span class="go">[[  2.29417358e-06   3.21222995e-08]</span>
<span class="go"> [             nan              nan]</span>
<span class="go"> [  2.27407877e-06   3.13005639e-08]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="n">e</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NoConvergence</span>: <span class="n">&#39;WCS.all_world2pix&#39; failed to converge to the</span>
<span class="go">requested accuracy.  After 6 iterations, the solution is</span>
<span class="go">diverging at least for one input point.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.calc_footprint">
<code class="descname">calc_footprint</code><span class="sig-paren">(</span><em>header=None</em>, <em>undistort=True</em>, <em>axes=None</em>, <em>center=True</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L645" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.calc_footprint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.calc_footprint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the footprint of the image on the sky.</p>
<p>A footprint is defined as the positions of the corners of the
image on the sky after all available distortions have been
applied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>header</strong> : <a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal"><span class="pre">Header</span></code></a> object, optional</p>
<blockquote>
<div><p>Used to get <code class="docutils literal"><span class="pre">NAXIS1</span></code> and <code class="docutils literal"><span class="pre">NAXIS2</span></code>
header and axes are mutually exclusive, alternative ways
to provide the same information.</p>
</div></blockquote>
<p><strong>undistort</strong> : bool, optional</p>
<blockquote>
<div><p>If <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>, take SIP and distortion lookup table into
account</p>
</div></blockquote>
<p><strong>axes</strong> : length 2 sequence ints, optional</p>
<blockquote>
<div><p>If provided, use the given sequence as the shape of the
image.  Otherwise, use the <code class="docutils literal"><span class="pre">NAXIS1</span></code> and <code class="docutils literal"><span class="pre">NAXIS2</span></code>
keywords from the header that was used to create this
<a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a> object.</p>
</div></blockquote>
<p><strong>center</strong> : bool, optional</p>
<blockquote>
<div><p>If <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a> use the center of the pixel, otherwise use the corner.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coord</strong> : (4, 2) array of (<em>x</em>, <em>y</em>) coordinates.</p>
<blockquote class="last">
<div><p>The order is counter-clockwise starting with the bottom left corner.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L528" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a shallow copy of the object.</p>
<p>Convenience method so user doesn&#8217;t have to import the
<a class="reference external" href="http://docs.python.org/library/copy.html#module-copy" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">copy</span></code></a> stdlib module.</p>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.deepcopy">
<code class="descname">deepcopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L537" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.deepcopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a deep copy of the object.</p>
<p>Convenience method so user doesn&#8217;t have to import the
<a class="reference external" href="http://docs.python.org/library/copy.html#module-copy" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">copy</span></code></a> stdlib module.</p>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.det2im">
<code class="descname">det2im</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2260" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.det2im"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.det2im" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert detector coordinates to image plane coordinates using
<a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</p>
<p>The output is in absolute pixel coordinates, not relative to
<code class="docutils literal"><span class="pre">CRPIX</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>args</strong> : flexible</p>
<blockquote>
<div><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</li>
<li>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : array</p>
<blockquote>
<div><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.dropaxis">
<code class="descname">dropaxis</code><span class="sig-paren">(</span><em>dropax</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2738" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.dropaxis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.dropaxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an axis from the WCS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>wcs</strong> : <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a></p>
<blockquote>
<div><p>The WCS with naxis to be chopped to naxis-1</p>
</div></blockquote>
<p><strong>dropax</strong> : int</p>
<blockquote>
<div><p>The index of the WCS to drop, counting from 0 (i.e., python convention,
not FITS convention)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A new <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a> instance with one axis fewer</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.fix">
<code class="descname">fix</code><span class="sig-paren">(</span><em>translate_units=''</em>, <em>naxis=None</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L597" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.fix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.fix" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the fix operations from wcslib, and warn about any
changes it has made.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>translate_units</strong> : str, optional</p>
<blockquote>
<div><p>Specify which potentially unsafe translations of
non-standard unit strings to perform.  By default,
performs none.</p>
<p>Although <code class="docutils literal"><span class="pre">&quot;S&quot;</span></code> is commonly used to represent seconds,
its translation to <code class="docutils literal"><span class="pre">&quot;s&quot;</span></code> is potentially unsafe since the
standard recognizes <code class="docutils literal"><span class="pre">&quot;S&quot;</span></code> formally as Siemens, however
rarely that may be used.  The same applies to <code class="docutils literal"><span class="pre">&quot;H&quot;</span></code> for
hours (Henry), and <code class="docutils literal"><span class="pre">&quot;D&quot;</span></code> for days (Debye).</p>
<p>This string controls what to do in such cases, and is
case-insensitive.</p>
<ul class="simple">
<li>If the string contains <code class="docutils literal"><span class="pre">&quot;s&quot;</span></code>, translate <code class="docutils literal"><span class="pre">&quot;S&quot;</span></code> to
<code class="docutils literal"><span class="pre">&quot;s&quot;</span></code>.</li>
<li>If the string contains <code class="docutils literal"><span class="pre">&quot;h&quot;</span></code>, translate <code class="docutils literal"><span class="pre">&quot;H&quot;</span></code> to
<code class="docutils literal"><span class="pre">&quot;h&quot;</span></code>.</li>
<li>If the string contains <code class="docutils literal"><span class="pre">&quot;d&quot;</span></code>, translate <code class="docutils literal"><span class="pre">&quot;D&quot;</span></code> to
<code class="docutils literal"><span class="pre">&quot;d&quot;</span></code>.</li>
</ul>
<p>Thus <code class="docutils literal"><span class="pre">''</span></code> doesn&#8217;t do any unsafe translations, whereas
<code class="docutils literal"><span class="pre">'shd'</span></code> does all of them.</p>
</div></blockquote>
<p><strong>naxis</strong> : int array[naxis], optional</p>
<blockquote class="last">
<div><p>Image axis lengths.  If this array is set to zero or
<code class="docutils literal"><span class="pre">None</span></code>, then <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.cylfix" title="astropy.wcs.Wcsprm.cylfix"><code class="xref py py-obj docutils literal"><span class="pre">cylfix</span></code></a> will not be
invoked.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.footprint_to_file">
<code class="descname">footprint_to_file</code><span class="sig-paren">(</span><em>filename=None</em>, <em>color='green'</em>, <em>width=2</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2542" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.footprint_to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.footprint_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes out a <a class="reference external" href="http://hea-www.harvard.edu/RD/ds9/">ds9</a> style regions file. It can be loaded
directly by <a class="reference external" href="http://hea-www.harvard.edu/RD/ds9/">ds9</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str, optional</p>
<blockquote>
<div><p>Output file name - default is <code class="docutils literal"><span class="pre">'footprint.reg'</span></code></p>
</div></blockquote>
<p><strong>color</strong> : str, optional</p>
<blockquote>
<div><p>Color to use when plotting the line.</p>
</div></blockquote>
<p><strong>width</strong> : int, optional</p>
<blockquote class="last">
<div><p>Width of the region line.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.get_axis_types">
<code class="descname">get_axis_types</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2627" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.get_axis_types"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.get_axis_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.axis_types" title="astropy.wcs.Wcsprm.axis_types"><code class="xref py py-obj docutils literal"><span class="pre">self.wcsprm.axis_types</span></code></a>
but provides the information in a more Python-friendly format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : list of dicts</p>
<blockquote class="last">
<div><p>Returns a list of dictionaries, one for each axis, each
containing attributes about the type of that axis.</p>
<p>Each dictionary has the following keys:</p>
<ul class="simple">
<li>&#8216;coordinate_type&#8217;:<ul>
<li>None: Non-specific coordinate type.</li>
<li>&#8216;stokes&#8217;: Stokes coordinate.</li>
<li>&#8216;celestial&#8217;: Celestial coordinate (including <code class="docutils literal"><span class="pre">CUBEFACE</span></code>).</li>
<li>&#8216;spectral&#8217;: Spectral coordinate.</li>
</ul>
</li>
<li>&#8216;scale&#8217;:<ul>
<li>&#8216;linear&#8217;: Linear axis.</li>
<li>&#8216;quantized&#8217;: Quantized axis (<code class="docutils literal"><span class="pre">STOKES</span></code>, <code class="docutils literal"><span class="pre">CUBEFACE</span></code>).</li>
<li>&#8216;non-linear celestial&#8217;: Non-linear celestial axis.</li>
<li>&#8216;non-linear spectral&#8217;: Non-linear spectral axis.</li>
<li>&#8216;logarithmic&#8217;: Logarithmic axis.</li>
<li>&#8216;tabular&#8217;: Tabular axis.</li>
</ul>
</li>
<li>&#8216;group&#8217;<ul>
<li>Group number, e.g. lookup table number</li>
</ul>
</li>
<li>&#8216;number&#8217;<ul>
<li>For celestial axes:<ul>
<li>0: Longitude coordinate.</li>
<li>1: Latitude coordinate.</li>
<li>2: <code class="docutils literal"><span class="pre">CUBEFACE</span></code> number.</li>
</ul>
</li>
<li>For lookup tables:<ul>
<li>the axis number in a multidimensional table.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><code class="docutils literal"><span class="pre">CTYPEia</span></code> in <code class="docutils literal"><span class="pre">&quot;4-3&quot;</span></code> form with unrecognized algorithm code will
generate an error.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.p4_pix2foc">
<code class="descname">p4_pix2foc</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2231" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.p4_pix2foc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.p4_pix2foc" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixel coordinates to focal plane coordinates using
<a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</p>
<p>The output is in absolute pixel coordinates, not relative to
<code class="docutils literal"><span class="pre">CRPIX</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>args</strong> : flexible</p>
<blockquote>
<div><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</li>
<li>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : array</p>
<blockquote>
<div><p>Returns the focal coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.pix2foc">
<code class="descname">pix2foc</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2201" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.pix2foc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.pix2foc" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixel coordinates to focal plane coordinates using the
<a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention and <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion
paper</a> table-lookup correction.</p>
<p>The output is in absolute pixel coordinates, not relative to
<code class="docutils literal"><span class="pre">CRPIX</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>args</strong> : flexible</p>
<blockquote>
<div><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</li>
<li>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : array</p>
<blockquote>
<div><p>Returns the focal coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.printwcs">
<code class="descname">printwcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2589" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.printwcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.printwcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.reorient_celestial_first">
<code class="descname">reorient_celestial_first</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2785" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.reorient_celestial_first"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.reorient_celestial_first" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorient the WCS such that the celestial axes are first, followed by
the spectral axis, followed by any others.
Assumes at least celestial axes are present.</p>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.rotateCD">
<code class="descname">rotateCD</code><span class="sig-paren">(</span><em>theta</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2581" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.rotateCD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.rotateCD" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.sip_foc2pix">
<code class="descname">sip_foc2pix</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2330" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.sip_foc2pix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.sip_foc2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert focal plane coordinates to pixel coordinates using the
<a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention.</p>
<p>FITS WCS <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table lookup distortion
correction is not applied, even if that information existed in
the FITS file that initialized this <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a> object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>args</strong> : flexible</p>
<blockquote>
<div><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</li>
<li>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : array</p>
<blockquote>
<div><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.sip_pix2foc">
<code class="descname">sip_pix2foc</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2289" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.sip_pix2foc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.sip_pix2foc" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixel coordinates to focal plane coordinates using the
<a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention.</p>
<p>The output is in pixel coordinates, relative to <code class="docutils literal"><span class="pre">CRPIX</span></code>.</p>
<p>FITS WCS <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table lookup correction is not
applied, even if that information existed in the FITS file
that initialized this <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-class docutils literal"><span class="pre">WCS</span></code></a> object.  To
correct for that, use <a class="reference internal" href="#astropy.wcs.WCS.pix2foc" title="astropy.wcs.WCS.pix2foc"><code class="xref py py-obj docutils literal"><span class="pre">pix2foc</span></code></a> or
<a class="reference internal" href="#astropy.wcs.WCS.p4_pix2foc" title="astropy.wcs.WCS.p4_pix2foc"><code class="xref py py-obj docutils literal"><span class="pre">p4_pix2foc</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>args</strong> : flexible</p>
<blockquote>
<div><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</li>
<li>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : array</p>
<blockquote>
<div><p>Returns the focal coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.slice">
<code class="descname">slice</code><span class="sig-paren">(</span><em>view</em>, <em>numpy_order=True</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2793" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.slice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Slice a WCS instance using a Numpy slice. The order of the slice should
be reversed (as for the data) compared to the natural WCS order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>view</strong> : tuple</p>
<blockquote>
<div><p>A tuple containing the same number of slices as the WCS system.
The <code class="docutils literal"><span class="pre">step</span></code> method, the third argument to a slice, is not
presently supported.</p>
</div></blockquote>
<p><strong>numpy_order</strong> : bool</p>
<blockquote>
<div><p>Use numpy order, i.e. slice the WCS so that an identical slice
applied to a numpy array will slice the array and WCS in the same
way. If set to <a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>, the WCS will be sliced in FITS order,
meaning the first slice will be applied to the <em>last</em> numpy index
but the <em>first</em> WCS axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>wcs_new</strong> : <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a></p>
<blockquote class="last">
<div><p>A new resampled WCS axis</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.sub">
<code class="descname">sub</code><span class="sig-paren">(</span><em>axes</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L546" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.sub"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the coordinate description for a subimage from a
<a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a> object.</p>
<p>The world coordinate system of the subimage must be separable in the
sense that the world coordinates at any point in the subimage must
depend only on the pixel coordinates of the axes extracted.  In
practice, this means that the <code class="docutils literal"><span class="pre">PCi_ja</span></code> matrix of the original image
must not contain non-zero off-diagonal terms that associate any of the
subimage axes with any of the non-subimage axes.</p>
<p><a class="reference internal" href="#astropy.wcs.WCS.sub" title="astropy.wcs.WCS.sub"><code class="xref py py-obj docutils literal"><span class="pre">sub</span></code></a> can also add axes to a wcsprm object.  The new axes will be
created using the defaults set by the Wcsprm constructor which produce
a simple, unnamed, linear axis with world coordinates equal to the
pixel coordinate.  These default values can be changed before
invoking <a class="reference external" href="http://docs.python.org/library/stdtypes.html#set" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">set</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axes</strong> : int or a sequence.</p>
<blockquote>
<div><ul class="simple">
<li>If an int, include the first <em>N</em> axes in their original order.</li>
<li>If a sequence, may contain a combination of image axis numbers
(1-relative) or special axis identifiers (see below).  Order is
significant; <code class="docutils literal"><span class="pre">axes[0]</span></code> is the axis number of the input image
that corresponds to the first axis in the subimage, etc.  Use an
axis number of 0 to create a new axis using the defaults.</li>
<li>If <code class="docutils literal"><span class="pre">0</span></code>, <code class="docutils literal"><span class="pre">[]</span></code> or <code class="docutils literal"><span class="pre">None</span></code>, do a deep copy.</li>
</ul>
<p>Coordinate axes types may be specified using either strings or
special integer constants.  The available types are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">'longitude'</span></code> / <code class="docutils literal"><span class="pre">WCSSUB_LONGITUDE</span></code>: Celestial longitude</li>
<li><code class="docutils literal"><span class="pre">'latitude'</span></code> / <code class="docutils literal"><span class="pre">WCSSUB_LATITUDE</span></code>: Celestial latitude</li>
<li><code class="docutils literal"><span class="pre">'cubeface'</span></code> / <code class="docutils literal"><span class="pre">WCSSUB_CUBEFACE</span></code>: Quadcube <code class="docutils literal"><span class="pre">CUBEFACE</span></code> axis</li>
<li><code class="docutils literal"><span class="pre">'spectral'</span></code> / <code class="docutils literal"><span class="pre">WCSSUB_SPECTRAL</span></code>: Spectral axis</li>
<li><code class="docutils literal"><span class="pre">'stokes'</span></code> / <code class="docutils literal"><span class="pre">WCSSUB_STOKES</span></code>: Stokes axis</li>
<li><code class="docutils literal"><span class="pre">'celestial'</span></code> / <code class="docutils literal"><span class="pre">WCSSUB_CELESTIAL</span></code>: An alias for the
combination of <code class="docutils literal"><span class="pre">'longitude'</span></code>, <code class="docutils literal"><span class="pre">'latitude'</span></code> and <code class="docutils literal"><span class="pre">'cubeface'</span></code>.</li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>new_wcs</strong> : <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a> object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>InvalidSubimageSpecificationError</strong></p>
<blockquote>
<div><p>Invalid subimage specification (no spectral axis).</p>
</div></blockquote>
<p><strong>NonseparableSubimageCoordinateSystem</strong></p>
<blockquote class="last">
<div><p>Non-separable subimage coordinate system.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Combinations of subimage axes of particular types may be extracted in
the same order as they occur in the input image by combining the
integer constants with the &#8216;binary or&#8217; (<code class="docutils literal"><span class="pre">|</span></code>) operator.  For
example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">wcs</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="n">WCSSUB_LONGITUDE</span> <span class="o">|</span> <span class="n">WCSSUB_LATITUDE</span> <span class="o">|</span> <span class="n">WCSSUB_SPECTRAL</span><span class="p">])</span>
</pre></div>
</div>
<p>would extract the longitude, latitude, and spectral axes in the same
order as the input image.  If one of each were present, the resulting
object would have three dimensions.</p>
<p>For convenience, <code class="docutils literal"><span class="pre">WCSSUB_CELESTIAL</span></code> is defined as the combination
<code class="docutils literal"><span class="pre">WCSSUB_LONGITUDE</span> <span class="pre">|</span> <span class="pre">WCSSUB_LATITUDE</span> <span class="pre">|</span> <span class="pre">WCSSUB_CUBEFACE</span></code>.</p>
<p>The codes may also be negated to extract all but the types specified,
for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">wcs</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span>
  <span class="n">WCSSUB_LONGITUDE</span><span class="p">,</span>
  <span class="n">WCSSUB_LATITUDE</span><span class="p">,</span>
  <span class="n">WCSSUB_CUBEFACE</span><span class="p">,</span>
  <span class="o">-</span><span class="p">(</span><span class="n">WCSSUB_SPECTRAL</span> <span class="o">|</span> <span class="n">WCSSUB_STOKES</span><span class="p">)])</span>
</pre></div>
</div>
<p>The last of these specifies all axis types other than spectral or
Stokes.  Extraction is done in the order specified by <code class="docutils literal"><span class="pre">axes</span></code>, i.e. a
longitude axis (if present) would be extracted first (via <code class="docutils literal"><span class="pre">axes[0]</span></code>)
and not subsequently (via <code class="docutils literal"><span class="pre">axes[3]</span></code>).  Likewise for the latitude and
cubeface axes in this example.</p>
<p>The number of dimensions in the returned object may be less than or
greater than the length of <code class="docutils literal"><span class="pre">axes</span></code>.  However, it will never exceed the
number of axes in the input image.</p>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.swapaxes">
<code class="descname">swapaxes</code><span class="sig-paren">(</span><em>ax0</em>, <em>ax1</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2762" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.swapaxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.swapaxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Swap axes in a WCS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>wcs</strong> : <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a></p>
<blockquote>
<div><p>The WCS to have its axes swapped</p>
</div></blockquote>
<p><strong>ax0</strong> : int</p>
<p><strong>ax1</strong> : int</p>
<blockquote>
<div><p>The indices of the WCS to be swapped, counting from 0 (i.e., python
convention, not FITS convention)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A new <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal"><span class="pre">WCS</span></code></a> instance with the same number of axes, but two</p>
<p class="last">swapped</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.to_fits">
<code class="descname">to_fits</code><span class="sig-paren">(</span><em>relax=False</em>, <em>key=None</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2367" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.to_fits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.to_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an <a class="reference internal" href="../io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits.HDUList</span></code></a> object with all of the
information stored in this object.  This should be logically identical
to the input FITS file, but it will be normalized in a number of ways.</p>
<p>See <a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal"><span class="pre">to_header</span></code></a> for some warnings about the output produced.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>relax</strong> : bool or int, optional</p>
<blockquote>
<div><p>Degree of permissiveness:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a> (default): Write all extensions that are
considered to be safe and recommended.</li>
<li><a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>: Write all recognized informal extensions of the
WCS standard.</li>
<li><a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">int</span></code></a>: a bit field selecting specific extensions to
write.  See <a class="reference internal" href="../wcs/relax.html#relaxwrite"><span>Header-writing relaxation constants</span></a> for details.</li>
</ul>
</div></blockquote>
<p><strong>key</strong> : str</p>
<blockquote>
<div><p>The name of a particular WCS transform to use.  This may be
either <code class="docutils literal"><span class="pre">'</span> <span class="pre">'</span></code> or <code class="docutils literal"><span class="pre">'A'</span></code>-<code class="docutils literal"><span class="pre">'Z'</span></code> and corresponds to the <code class="docutils literal"><span class="pre">&quot;a&quot;</span></code>
part of the <code class="docutils literal"><span class="pre">CTYPEia</span></code> cards.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>hdulist</strong> : <a class="reference internal" href="../io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits.HDUList</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.to_header">
<code class="descname">to_header</code><span class="sig-paren">(</span><em>relax=None</em>, <em>key=None</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2410" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.to_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.to_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an <a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits.Header</span></code></a> object with the basic WCS
and SIP information stored in this object.  This should be
logically identical to the input FITS file, but it will be
normalized in a number of ways.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function does not write out FITS WCS <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion
paper</a> information, since that requires multiple FITS
header data units.  To get a full representation of
everything in this object, use <a class="reference internal" href="#astropy.wcs.WCS.to_fits" title="astropy.wcs.WCS.to_fits"><code class="xref py py-obj docutils literal"><span class="pre">to_fits</span></code></a>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>relax</strong> : bool or int, optional</p>
<blockquote>
<div><p>Degree of permissiveness:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a> (default): Write all extensions that are
considered to be safe and recommended.</li>
<li><a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>: Write all recognized informal extensions of the
WCS standard.</li>
<li><a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">int</span></code></a>: a bit field selecting specific extensions to
write.  See <a class="reference internal" href="../wcs/relax.html#relaxwrite"><span>Header-writing relaxation constants</span></a> for details.</li>
</ul>
<p>If the <code class="docutils literal"><span class="pre">relax</span></code> keyword argument is not given and any
keywords were omitted from the output, an
<a class="reference internal" href="astropy.utils.exceptions.AstropyWarning.html#astropy.utils.exceptions.AstropyWarning" title="astropy.utils.exceptions.AstropyWarning"><code class="xref py py-obj docutils literal"><span class="pre">AstropyWarning</span></code></a> is displayed.
To override this, explicitly pass a value to <code class="docutils literal"><span class="pre">relax</span></code>.</p>
</div></blockquote>
<p><strong>key</strong> : str</p>
<blockquote>
<div><p>The name of a particular WCS transform to use.  This may be
either <code class="docutils literal"><span class="pre">'</span> <span class="pre">'</span></code> or <code class="docutils literal"><span class="pre">'A'</span></code>-<code class="docutils literal"><span class="pre">'Z'</span></code> and corresponds to the <code class="docutils literal"><span class="pre">&quot;a&quot;</span></code>
part of the <code class="docutils literal"><span class="pre">CTYPEia</span></code> cards.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>header</strong> : <a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits.Header</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The output header will almost certainly differ from the input in a
number of respects:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The output header only contains WCS-related keywords.  In
particular, it does not contain syntactically-required
keywords such as <code class="docutils literal"><span class="pre">SIMPLE</span></code>, <code class="docutils literal"><span class="pre">NAXIS</span></code>, <code class="docutils literal"><span class="pre">BITPIX</span></code>, or
<code class="docutils literal"><span class="pre">END</span></code>.</li>
<li>Deprecated (e.g. <code class="docutils literal"><span class="pre">CROTAn</span></code>) or non-standard usage will
be translated to standard (this is partially dependent on
whether <code class="docutils literal"><span class="pre">fix</span></code> was applied).</li>
<li>Quantities will be converted to the units used internally,
basically SI with the addition of degrees.</li>
<li>Floating-point quantities may be given to a different decimal
precision.</li>
<li>Elements of the <code class="docutils literal"><span class="pre">PCi_j</span></code> matrix will be written if and
only if they differ from the unit matrix.  Thus, if the
matrix is unity then no elements will be written.</li>
<li>Additional keywords such as <code class="docutils literal"><span class="pre">WCSAXES</span></code>, <code class="docutils literal"><span class="pre">CUNITia</span></code>,
<code class="docutils literal"><span class="pre">LONPOLEa</span></code> and <code class="docutils literal"><span class="pre">LATPOLEa</span></code> may appear.</li>
<li>The original keycomments will be lost, although
<a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal"><span class="pre">to_header</span></code></a> tries hard to write meaningful comments.</li>
<li>Keyword order may be changed.</li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.to_header_string">
<code class="descname">to_header_string</code><span class="sig-paren">(</span><em>relax=None</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2535" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.to_header_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.to_header_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Identical to <a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal"><span class="pre">to_header</span></code></a>, but returns a string containing the
header cards.</p>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.wcs_pix2world">
<code class="descname">wcs_pix2world</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L1324" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.wcs_pix2world"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.wcs_pix2world" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms pixel coordinates to world coordinates by doing
only the basic <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> transformation.</p>
<p>No <a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> or <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table lookup correction is
applied.  To perform distortion correction, see
<a class="reference internal" href="#astropy.wcs.WCS.all_pix2world" title="astropy.wcs.WCS.all_pix2world"><code class="xref py py-obj docutils literal"><span class="pre">all_pix2world</span></code></a>,
<a class="reference internal" href="#astropy.wcs.WCS.sip_pix2foc" title="astropy.wcs.WCS.sip_pix2foc"><code class="xref py py-obj docutils literal"><span class="pre">sip_pix2foc</span></code></a>, <a class="reference internal" href="#astropy.wcs.WCS.p4_pix2foc" title="astropy.wcs.WCS.p4_pix2foc"><code class="xref py py-obj docutils literal"><span class="pre">p4_pix2foc</span></code></a>,
or <a class="reference internal" href="#astropy.wcs.WCS.pix2foc" title="astropy.wcs.WCS.pix2foc"><code class="xref py py-obj docutils literal"><span class="pre">pix2foc</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>args</strong> : flexible</p>
<blockquote>
<div><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</li>
<li>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</div></blockquote>
<p><strong>ra_dec_order</strong> : bool, optional</p>
<blockquote>
<div><p>When <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal"><span class="pre">CTYPE</span></code> keywords.  Default is
<a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : array</p>
<blockquote>
<div><p>Returns the world coordinates, in degrees.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>SingularMatrixError</strong></p>
<blockquote>
<div><p>Linear transformation matrix is singular.</p>
</div></blockquote>
<p><strong>InconsistentAxisTypesError</strong></p>
<blockquote>
<div><p>Inconsistent or unrecognized coordinate axis types.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>Invalid parameter value.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>x- and y-coordinate arrays are not the same size.</p>
</div></blockquote>
<p><strong>InvalidTransformError</strong></p>
<blockquote>
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
<p><strong>InvalidTransformError</strong></p>
<blockquote class="last">
<div><p>Ill-conditioned coordinate transformation parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The order of the axes for the result is determined by the
<code class="docutils literal"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may not
always be of the form (<em>ra</em>, <em>dec</em>).  The
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lat" title="astropy.wcs.Wcsprm.lat"><code class="xref py py-obj docutils literal"><span class="pre">lat</span></code></a>, <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lng" title="astropy.wcs.Wcsprm.lng"><code class="xref py py-obj docutils literal"><span class="pre">lng</span></code></a>,
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lattyp" title="astropy.wcs.Wcsprm.lattyp"><code class="xref py py-obj docutils literal"><span class="pre">lattyp</span></code></a> and <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lngtyp" title="astropy.wcs.Wcsprm.lngtyp"><code class="xref py py-obj docutils literal"><span class="pre">lngtyp</span></code></a>
members can be used to determine the order of the axes.</p>
</dd></dl>

<dl class="method">
<dt id="astropy.wcs.WCS.wcs_world2pix">
<code class="descname">wcs_world2pix</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/wcs/wcs.py#L2138" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.wcs_world2pix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.wcs.WCS.wcs_world2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms world coordinates to pixel coordinates, using only
the basic <a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> WCS transformation.  No <a class="reference external" href="http://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> or
<a class="reference external" href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table lookup transformation is applied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>args</strong> : flexible</p>
<blockquote>
<div><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</li>
<li>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</div></blockquote>
<p><strong>ra_dec_order</strong> : bool, optional</p>
<blockquote>
<div><p>When <a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal"><span class="pre">CTYPE</span></code> keywords.  Default is
<a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> : array</p>
<blockquote>
<div><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>MemoryError</strong></p>
<blockquote>
<div><p>Memory allocation failed.</p>
</div></blockquote>
<p><strong>SingularMatrixError</strong></p>
<blockquote>
<div><p>Linear transformation matrix is singular.</p>
</div></blockquote>
<p><strong>InconsistentAxisTypesError</strong></p>
<blockquote>
<div><p>Inconsistent or unrecognized coordinate axis types.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>Invalid parameter value.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
<p><strong>ValueError</strong></p>
<blockquote>
<div><p>x- and y-coordinate arrays are not the same size.</p>
</div></blockquote>
<p><strong>InvalidTransformError</strong></p>
<blockquote>
<div><p>Invalid coordinate transformation parameters.</p>
</div></blockquote>
<p><strong>InvalidTransformError</strong></p>
<blockquote class="last">
<div><p>Ill-conditioned coordinate transformation parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The order of the axes for the input world array is determined by
the <code class="docutils literal"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may
not always be of the form (<em>ra</em>, <em>dec</em>).  The
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lat" title="astropy.wcs.Wcsprm.lat"><code class="xref py py-obj docutils literal"><span class="pre">lat</span></code></a>, <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lng" title="astropy.wcs.Wcsprm.lng"><code class="xref py py-obj docutils literal"><span class="pre">lng</span></code></a>,
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lattyp" title="astropy.wcs.Wcsprm.lattyp"><code class="xref py py-obj docutils literal"><span class="pre">lattyp</span></code></a> and <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lngtyp" title="astropy.wcs.Wcsprm.lngtyp"><code class="xref py py-obj docutils literal"><span class="pre">lngtyp</span></code></a>
members can be used to determine the order of the axes.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">WCS</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/astropy.wcs.WCS.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.5. &nbsp;
    Last built 29 Apr 2016. <br/>
  </p>
</footer>
  </body>
</html>