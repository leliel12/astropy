<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>binned_binom_proportion &mdash; Astropy v1.2.dev14999</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.dev14999',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev14999" href="../index.html" />
    <link rel="up" title="Astrostatistics Tools (astropy.stats)" href="../stats/index.html" />
    <link rel="next" title="binom_conf_interval" href="astropy.stats.binom_conf_interval.html" />
    <link rel="prev" title="bayesian_info_criterion_lsq" href="astropy.stats.bayesian_info_criterion_lsq.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.stats.binom_conf_interval.html" title="binom_conf_interval">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="astropy.stats.bayesian_info_criterion_lsq.html" title="bayesian_info_criterion_lsq">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v1.2.dev14999</a>
	 &raquo;
      </li>
      <li><a href="../stats/index.html" accesskey="U">Astrostatistics Tools (<code class="docutils literal"><span class="pre">astropy.stats</span></code>)</a> &raquo;</li>
      
      <li>binned_binom_proportion</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="binned-binom-proportion">
<h1>binned_binom_proportion<a class="headerlink" href="#binned-binom-proportion" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="astropy.stats.binned_binom_proportion">
<code class="descclassname">astropy.stats.</code><code class="descname">binned_binom_proportion</code><span class="sig-paren">(</span><em>x</em>, <em>success</em>, <em>bins=10</em>, <em>range=None</em>, <em>conf=0.68269</em>, <em>interval='wilson'</em><span class="sig-paren">)</span><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/stats/funcs.py#L273" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="reference internal" href="../_modules/astropy/stats/funcs.html#binned_binom_proportion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astropy.stats.binned_binom_proportion" title="Permalink to this definition">¶</a></dt>
<dd><p>Binomial proportion and confidence interval in bins of a continuous
variable <code class="docutils literal"><span class="pre">x</span></code>.</p>
<p>Given a set of datapoint pairs where the <code class="docutils literal"><span class="pre">x</span></code> values are
continuously distributed and the <code class="docutils literal"><span class="pre">success</span></code> values are binomial
(&#8220;success / failure&#8221; or &#8220;true / false&#8221;), place the pairs into
bins according to <code class="docutils literal"><span class="pre">x</span></code> value and calculate the binomial proportion
(fraction of successes) and confidence interval in each bin.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : list_like</p>
<blockquote>
<div><p>Values.</p>
</div></blockquote>
<p><strong>success</strong> : list_like (bool)</p>
<blockquote>
<div><p>Success (<a class="reference external" href="http://docs.python.org/library/constants.html#True" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>) or failure (<a class="reference external" href="http://docs.python.org/library/constants.html#False" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>) corresponding to each value
in <code class="docutils literal"><span class="pre">x</span></code>.  Must be same length as <code class="docutils literal"><span class="pre">x</span></code>.</p>
</div></blockquote>
<p><strong>bins</strong> : int or sequence of scalars, optional</p>
<blockquote>
<div><p>If bins is an int, it defines the number of equal-width bins
in the given range (10, by default). If bins is a sequence, it
defines the bin edges, including the rightmost edge, allowing
for non-uniform bin widths (in this case, &#8216;range&#8217; is ignored).</p>
</div></blockquote>
<p><strong>range</strong> : (float, float), optional</p>
<blockquote>
<div><p>The lower and upper range of the bins. If <a class="reference external" href="http://docs.python.org/library/constants.html#None" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">None</span></code></a> (default),
the range is set to <code class="docutils literal"><span class="pre">(x.min(),</span> <span class="pre">x.max())</span></code>. Values outside the
range are ignored.</p>
</div></blockquote>
<p><strong>conf</strong> : float in [0, 1], optional</p>
<blockquote>
<div><p>Desired probability content in the confidence
interval <code class="docutils literal"><span class="pre">(p</span> <span class="pre">-</span> <span class="pre">perr[0],</span> <span class="pre">p</span> <span class="pre">+</span> <span class="pre">perr[1])</span></code> in each bin. Default is
0.68269.</p>
</div></blockquote>
<p><strong>interval</strong> : {&#8216;wilson&#8217;, &#8216;jeffreys&#8217;, &#8216;flat&#8217;, &#8216;wald&#8217;}, optional</p>
<blockquote>
<div><p>Formula used to calculate confidence interval on the
binomial proportion in each bin. See <a class="reference internal" href="astropy.stats.binom_conf_interval.html#astropy.stats.binom_conf_interval" title="astropy.stats.binom_conf_interval"><code class="xref py py-obj docutils literal"><span class="pre">binom_conf_interval</span></code></a> for
definition of the intervals.  The &#8216;wilson&#8217;, &#8216;jeffreys&#8217;,
and &#8216;flat&#8217; intervals generally give similar results.  &#8216;wilson&#8217;
should be somewhat faster, while &#8216;jeffreys&#8217; and &#8216;flat&#8217; are
marginally superior, but differ in the assumed prior.
The &#8216;wald&#8217; interval is generally not recommended.
It is provided for comparison purposes. Default is &#8216;wilson&#8217;.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>bin_ctr</strong> : numpy.ndarray</p>
<blockquote>
<div><p>Central value of bins. Bins without any entries are not returned.</p>
</div></blockquote>
<p><strong>bin_halfwidth</strong> : numpy.ndarray</p>
<blockquote>
<div><p>Half-width of each bin such that <code class="docutils literal"><span class="pre">bin_ctr</span> <span class="pre">-</span> <span class="pre">bin_halfwidth</span></code> and
<code class="docutils literal"><span class="pre">bin_ctr</span> <span class="pre">+</span> <span class="pre">bins_halfwidth</span></code> give the left and right side of each bin,
respectively.</p>
</div></blockquote>
<p><strong>p</strong> : numpy.ndarray</p>
<blockquote>
<div><p>Efficiency in each bin.</p>
</div></blockquote>
<p><strong>perr</strong> : numpy.ndarray</p>
<blockquote class="last">
<div><p>2-d array of shape (2, len(p)) representing the upper and lower
uncertainty on p in each bin.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="astropy.stats.binom_conf_interval.html#astropy.stats.binom_conf_interval" title="astropy.stats.binom_conf_interval"><code class="xref py py-obj docutils literal"><span class="pre">binom_conf_interval</span></code></a></dt>
<dd>Function used to estimate confidence interval in each bin.</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Suppose we wish to estimate the efficiency of a survey in
detecting astronomical sources as a function of magnitude (i.e.,
the probability of detecting a source given its magnitude). In a
realistic case, we might prepare a large number of sources with
randomly selected magnitudes, inject them into simulated images,
and then record which were detected at the end of the reduction
pipeline. As a toy example, we generate 100 data points with
randomly selected magnitudes between 20 and 30 and &#8220;observe&#8221; them
with a known detection function (here, the error function, with
50% detection probability at magnitude 25):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">erf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">binom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">true_efficiency</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">erf</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="mf">25.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mag</span> <span class="o">=</span> <span class="mf">20.</span> <span class="o">+</span> <span class="mf">10.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detected</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">true_efficiency</span><span class="p">(</span><span class="n">mag</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span><span class="p">,</span> <span class="n">binshw</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">perr</span> <span class="o">=</span> <span class="n">binned_binom_proportion</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="n">detected</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">binshw</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">perr</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">label</span><span class="o">=</span><span class="s">&#39;estimate&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../api/astropy-stats-binned_binom_proportion-1.py">Source code</a>, <a class="reference external" href="../api/astropy-stats-binned_binom_proportion-1.png">png</a>, <a class="reference external" href="../api/astropy-stats-binned_binom_proportion-1.hires.png">hires.png</a>, <a class="reference external" href="../api/astropy-stats-binned_binom_proportion-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/astropy-stats-binned_binom_proportion-1.png" src="../_images/astropy-stats-binned_binom_proportion-1.png" />
</div>
<p>The above example uses the Wilson confidence interval to calculate
the uncertainty <code class="docutils literal"><span class="pre">perr</span></code> in each bin (see the definition of various
confidence intervals in <a class="reference internal" href="astropy.stats.binom_conf_interval.html#astropy.stats.binom_conf_interval" title="astropy.stats.binom_conf_interval"><code class="xref py py-obj docutils literal"><span class="pre">binom_conf_interval</span></code></a>). A commonly used
alternative is the Wald interval. However, the Wald interval can
give nonsensical uncertainties when the efficiency is near 0 or 1,
and is therefore <strong>not</strong> recommended. As an illustration, the
following example shows the same data as above but uses the Wald
interval rather than the Wilson interval to calculate <code class="docutils literal"><span class="pre">perr</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span><span class="p">,</span> <span class="n">binshw</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">perr</span> <span class="o">=</span> <span class="n">binned_binom_proportion</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="n">detected</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>                                                <span class="n">interval</span><span class="o">=</span><span class="s">&#39;wald&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">binshw</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">perr</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">label</span><span class="o">=</span><span class="s">&#39;estimate&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../api/astropy-stats-binned_binom_proportion-2.py">Source code</a>, <a class="reference external" href="../api/astropy-stats-binned_binom_proportion-2.png">png</a>, <a class="reference external" href="../api/astropy-stats-binned_binom_proportion-2.hires.png">hires.png</a>, <a class="reference external" href="../api/astropy-stats-binned_binom_proportion-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../_images/astropy-stats-binned_binom_proportion-2.png" src="../_images/astropy-stats-binned_binom_proportion-2.png" />
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">binned_binom_proportion</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/astropy.stats.binned_binom_proportion.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1. &nbsp;
    Last built 12 May 2016. <br/>
  </p>
</footer>
  </body>
</html>