<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>poisson_conf_interval &mdash; Astropy v1.2.dev15690</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.dev15690',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev15690" href="../index.html" />
    <link rel="up" title="Astrostatistics Tools (astropy.stats)" href="../stats/index.html" />
    <link rel="next" title="rayleightest" href="astropy.stats.rayleightest.html" />
    <link rel="prev" title="median_absolute_deviation" href="astropy.stats.median_absolute_deviation.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.stats.rayleightest.html" title="rayleightest">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="astropy.stats.median_absolute_deviation.html" title="median_absolute_deviation">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v1.2.dev15690</a>
	 &raquo;
      </li>
      <li><a href="../stats/index.html" accesskey="U">Astrostatistics Tools (<code class="docutils literal"><span class="pre">astropy.stats</span></code>)</a> &raquo;</li>
      
      <li>poisson_conf_interval</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="poisson-conf-interval">
<h1>poisson_conf_interval<a class="headerlink" href="#poisson-conf-interval" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="astropy.stats.poisson_conf_interval">
<code class="descclassname">astropy.stats.</code><code class="descname">poisson_conf_interval</code><span class="sig-paren">(</span><em>n</em>, <em>interval='root-n'</em>, <em>sigma=1</em>, <em>background=0</em>, <em>conflevel=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/stats/funcs.html#poisson_conf_interval"><span class="viewcode-link">[source]</span></a><a class="reference external" href="http://github.com/astropy/astropy/tree/master/astropy/stats/funcs.py#L458" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="headerlink" href="#astropy.stats.poisson_conf_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Poisson parameter confidence interval given observed counts</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n</strong> : int or numpy.ndarray</p>
<blockquote>
<div><p>Number of counts (0 &lt;= <code class="docutils literal"><span class="pre">n</span></code>).</p>
</div></blockquote>
<p><strong>interval</strong> : {&#8216;root-n&#8217;,&#8217;root-n-0&#8217;,&#8217;pearson&#8217;,&#8217;sherpagehrels&#8217;,&#8217;frequentist-confidence&#8217;, &#8216;kraft-burrows-nousek&#8217;}, optional</p>
<blockquote>
<div><p>Formula used for confidence interval. See notes for details.
Default is <code class="docutils literal"><span class="pre">'root-n'</span></code>.</p>
</div></blockquote>
<p><strong>sigma</strong> : float, optional</p>
<blockquote>
<div><p>Number of sigma for confidence interval; only supported for
the &#8216;frequentist-confidence&#8217; mode.</p>
</div></blockquote>
<p><strong>background</strong> : float, optional</p>
<blockquote>
<div><p>Number of counts expected from the background; only supported for
the &#8216;kraft-burrows-nousek&#8217; mode. This number is assumed to be determined
from a large region so that the uncertainty on its value is negligible.</p>
</div></blockquote>
<p><strong>conflevel</strong> : float, optional</p>
<blockquote>
<div><p>Confidence level between 0 and 1; only supported for the
&#8216;kraft-burrows-nousek&#8217; mode.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>conf_interval</strong> : numpy.ndarray</p>
<blockquote class="last">
<div><p><code class="docutils literal"><span class="pre">conf_interval[0]</span></code> and <code class="docutils literal"><span class="pre">conf_interval[1]</span></code> correspond to the lower
and upper limits, respectively, for each element in <code class="docutils literal"><span class="pre">n</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The &#8220;right&#8221; confidence interval to use for Poisson data is a
matter of debate. The CDF working group [recommends][pois_eb]
using root-n throughout, largely in the interest of
comprehensibility, but discusses other possibilities. The ATLAS
group also [discusses][ErrorBars] several possibilities but
concludes that no single representation is suitable for all cases.
The suggestion has also been [floated][ac12] that error bars should be
attached to theoretical predictions instead of observed data,
which this function will not help with (but it&#8217;s easy; then you
really should use the square root of the theoretical prediction).</p>
<p>The intervals implemented here are:</p>
<p><strong>1. &#8216;root-n&#8217;</strong> This is a very widely used standard rule derived
from the maximum-likelihood estimator for the mean of the Poisson
process. While it produces questionable results for small n and
outright wrong results for n=0, it is standard enough that people are
(supposedly) used to interpreting these wonky values. The interval is</p>
<div class="math">
<p><img src="../_images/math/99beaacb3c9b6a9527beb342f2f1d880e9cc4952.png" alt="CI = (n-\sqrt{n}, n+\sqrt{n})"/></p>
</div><p><strong>2. &#8216;root-n-0&#8217;</strong> This is identical to the above except that where
n is zero the interval returned is (0,1).</p>
<p><strong>3. &#8216;pearson&#8217;</strong> This is an only-slightly-more-complicated rule
based on Pearson&#8217;s chi-squared rule (as [explained][pois_eb] by
the CDF working group). It also has the nice feature that
if your theory curve touches an endpoint of the interval, then your
data point is indeed one sigma away. The interval is</p>
<div class="math">
<p><img src="../_images/math/753ee0f51e461f6c1f655e1e370a354c2aff1d29.png" alt="CI = (n+0.5-\sqrt{n+0.25}, n+0.5+\sqrt{n+0.25})"/></p>
</div><p><strong>4. &#8216;sherpagehrels&#8217;</strong> This rule is used by default in the fitting
package &#8216;sherpa&#8217;. The [documentation][sherpa_gehrels] claims it is
based on a numerical approximation published in
[Gehrels 1986][gehrels86] but it does not actually appear there.
It is symmetrical, and while the upper limits
are within about 1% of those given by &#8216;frequentist-confidence&#8217;, the
lower limits can be badly wrong. The interval is</p>
<div class="math">
<p><img src="../_images/math/b7405a9fc74b77f771ff46a027a083c37e6d5dd6.png" alt="CI = (n-1-\sqrt{n+0.75}, n+1+\sqrt{n+0.75})"/></p>
</div><p><strong>5. &#8216;frequentist-confidence&#8217;</strong> These are frequentist central
confidence intervals:</p>
<div class="math">
<p><img src="../_images/math/6c61bccf909287f9a88ea4f2e795488040bd825e.png" alt="CI = (0.5 F_{\chi^2}^{-1}(\alpha;2n),
      0.5 F_{\chi^2}^{-1}(1-\alpha;2(n+1)))"/></p>
</div><p>where <img class="math" src="../_images/math/dc8bbcf5ce9ef41886aa58acd07ed1386c626c86.png" alt="F_{\chi^2}^{-1}"/> is the quantile of the chi-square
distribution with the indicated number of degrees of freedom and
<img class="math" src="../_images/math/ad59b6e24a4a00ac621801f8d7513d68be654ab5.png" alt="\alpha"/> is the one-tailed probability of the normal
distribution (at the point given by the parameter &#8216;sigma&#8217;). See
[Maxwell 2011][maxw11] for further details.</p>
<p><strong>6. &#8216;kraft-burrows-nousek&#8217;</strong> This is a Bayesian approach which allows
for the presence of a known background <img class="math" src="../_images/math/83956e92fcc80dee17fce864543216939a3c9da7.png" alt="B"/> in the source signal
<img class="math" src="../_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/>.
For a given confidence level <img class="math" src="../_images/math/a8e450db2c0dbd54c86acb78a560920842751479.png" alt="CL"/> the confidence interval
<img class="math" src="../_images/math/a234d4b8ebdab3df2a0b0f77f1bf504b45aa3b34.png" alt="[S_\mathrm{min}, S_\mathrm{max}]"/> is given by:</p>
<div class="math">
<p><img src="../_images/math/2a16374034b3551cf7b058321f5e462e70d99bc5.png" alt="CL = \int^{S_\mathrm{max}}_{S_\mathrm{min}} f_{N,B}(S)dS"/></p>
</div><p>where the function <img class="math" src="../_images/math/caaf63456188ce74ab52927982e07a6214461ba1.png" alt="f_{N,B}"/> is:</p>
<div class="math">
<p><img src="../_images/math/b3e7187d8e420aa6beeada3357a13b2f12472be2.png" alt="f_{N,B}(S) = C \frac{e^{-(S+B)}(S+B)^N}{N!}"/></p>
</div><p>and the normalization constant <img class="math" src="../_images/math/2bcc65482aa8e15cd4c9e9f2542451fb4e971a91.png" alt="C"/>:</p>
<div class="math">
<p><img src="../_images/math/146c41a0ec46e5e2502d0f77883bef9646dc3763.png" alt="C = \left[ \int_0^\infty \frac{e^{-(S+B)}(S+B)^N}{N!} dS \right] ^{-1}
= \left( \sum^N_{n=0} \frac{e^{-B}B^n}{n!}  \right)^{-1}"/></p>
</div><p>See [KraftBurrowsNousek][kbn1991] for further details.</p>
<p>These formulas implement a positive, uniform prior.
[KraftBurrowsNousek][kbn1991] discuss this choice in more detail and show
that the problem is relatively insensitive to the choice of prior.</p>
<p>This functions has an optional dependency: Either scipy or
<a class="reference external" href="http://mpmath.org/">mpmath</a>  need to be available. (Scipy only works for
N &lt; 100).</p>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="s">&#39;root-n&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[  0.        ,   0.        ],</span>
<span class="go">       [  0.        ,   2.        ],</span>
<span class="go">       [  0.58578644,   3.41421356],</span>
<span class="go">       [  1.26794919,   4.73205081],</span>
<span class="go">       [  2.        ,   6.        ],</span>
<span class="go">       [  2.76393202,   7.23606798],</span>
<span class="go">       [  3.55051026,   8.44948974],</span>
<span class="go">       [  4.35424869,   9.64575131],</span>
<span class="go">       [  5.17157288,  10.82842712],</span>
<span class="go">       [  6.        ,  12.        ]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="s">&#39;root-n-0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[  0.        ,   1.        ],</span>
<span class="go">       [  0.        ,   2.        ],</span>
<span class="go">       [  0.58578644,   3.41421356],</span>
<span class="go">       [  1.26794919,   4.73205081],</span>
<span class="go">       [  2.        ,   6.        ],</span>
<span class="go">       [  2.76393202,   7.23606798],</span>
<span class="go">       [  3.55051026,   8.44948974],</span>
<span class="go">       [  4.35424869,   9.64575131],</span>
<span class="go">       [  5.17157288,  10.82842712],</span>
<span class="go">       [  6.        ,  12.        ]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="s">&#39;pearson&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[  0.        ,   1.        ],</span>
<span class="go">       [  0.38196601,   2.61803399],</span>
<span class="go">       [  1.        ,   4.        ],</span>
<span class="go">       [  1.69722436,   5.30277564],</span>
<span class="go">       [  2.43844719,   6.56155281],</span>
<span class="go">       [  3.20871215,   7.79128785],</span>
<span class="go">       [  4.        ,   9.        ],</span>
<span class="go">       [  4.8074176 ,  10.1925824 ],</span>
<span class="go">       [  5.62771868,  11.37228132],</span>
<span class="go">       [  6.45861873,  12.54138127]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="n">interval</span><span class="o">=</span><span class="s">&#39;frequentist-confidence&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[  0.        ,   1.84102165],</span>
<span class="go">       [  0.17275378,   3.29952656],</span>
<span class="go">       [  0.70818544,   4.63785962],</span>
<span class="go">       [  1.36729531,   5.91818583],</span>
<span class="go">       [  2.08566081,   7.16275317],</span>
<span class="go">       [  2.84030886,   8.38247265],</span>
<span class="go">       [  3.62006862,   9.58364155],</span>
<span class="go">       [  4.41852954,  10.77028072],</span>
<span class="go">       [  5.23161394,  11.94514152],</span>
<span class="go">       [  6.05653896,  13.11020414]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">interval</span><span class="o">=</span><span class="s">&#39;frequentist-confidence&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([  4.41852954,  10.77028072])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">conflevel</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">interval</span><span class="o">=</span><span class="s">&#39;kraft-burrows-nousek&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([  3.47894005, 16.113329533])   </span>
</pre></div>
</div>
<p>[pois_eb]: <a class="reference external" href="http://www-cdf.fnal.gov/physics/statistics/notes/pois_eb.txt">http://www-cdf.fnal.gov/physics/statistics/notes/pois_eb.txt</a></p>
<p>[ErrorBars]: <a class="reference external" href="http://www.pp.rhul.ac.uk/~cowan/atlas/ErrorBars.pdf">http://www.pp.rhul.ac.uk/~cowan/atlas/ErrorBars.pdf</a></p>
<p>[ac12]: <a class="reference external" href="http://adsabs.harvard.edu/abs/2012EPJP..127...24A">http://adsabs.harvard.edu/abs/2012EPJP..127...24A</a></p>
<p>[maxw11]: <a class="reference external" href="http://adsabs.harvard.edu/abs/2011arXiv1102.0822M">http://adsabs.harvard.edu/abs/2011arXiv1102.0822M</a></p>
<p>[gehrels86]: <a class="reference external" href="http://adsabs.harvard.edu/abs/1986ApJ...303..336G">http://adsabs.harvard.edu/abs/1986ApJ...303..336G</a></p>
<p>[sherpa_gehrels]: <a class="reference external" href="http://cxc.harvard.edu/sherpa4.4/statistics/#chigehrels">http://cxc.harvard.edu/sherpa4.4/statistics/#chigehrels</a></p>
<p>[kbn1991]: <a class="reference external" href="http://adsabs.harvard.edu/abs/1991ApJ...374..344K">http://adsabs.harvard.edu/abs/1991ApJ...374..344K</a></p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">poisson_conf_interval</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/astropy.stats.poisson_conf_interval.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1. &nbsp;
    Last built 10 Jun 2016. <br/>
  </p>
</footer>
  </body>
</html>