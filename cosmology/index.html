<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Cosmological Calculations (astropy.cosmology) &mdash; Astropy v1.2.dev14980</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.dev14980',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev14980" href="../index.html" />
    <link rel="next" title="z_at_value" href="../api/astropy.cosmology.z_at_value.html" />
    <link rel="prev" title="ImageNormalize" href="../api/astropy.visualization.mpl_normalize.ImageNormalize.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../api/astropy.cosmology.z_at_value.html" title="z_at_value">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../api/astropy.visualization.mpl_normalize.ImageNormalize.html" title="ImageNormalize">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v1.2.dev14980</a>
	 &raquo;
      </li>
      
      <li>Cosmological Calculations (<code class="docutils literal"><span class="pre">astropy.cosmology</span></code>)</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cosmological-calculations-astropy-cosmology">
<span id="astropy-cosmology"></span><h1>Cosmological Calculations (<a class="reference internal" href="#module-astropy.cosmology" title="astropy.cosmology"><code class="xref py py-obj docutils literal"><span class="pre">astropy.cosmology</span></code></a>)<a class="headerlink" href="#cosmological-calculations-astropy-cosmology" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-astropy.cosmology" title="astropy.cosmology"><code class="xref py py-obj docutils literal"><span class="pre">astropy.cosmology</span></code></a> subpackage contains classes for representing
cosmologies, and utility functions for calculating commonly used
quantities that depend on a cosmological model. This includes
distances, ages and lookback times corresponding to a measured
redshift or the transverse separation corresponding to a measured
angular separation.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Cosmological quantities are calculated using methods of a
<code class="xref py py-class docutils literal"><span class="pre">Cosmology</span></code> object. For example, to calculate the
Hubble constant at z=0 (i.e., <code class="docutils literal"><span class="pre">H0</span></code>), and the number of transverse proper
kpc corresponding to an arcminute at z=3:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">WMAP9</span> <span class="k">as</span> <span class="n">cosmo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  
<span class="go">&lt;Quantity 69.32 km / (Mpc s)&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">kpc_proper_per_arcmin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  
<span class="go">&lt;Quantity 472.97709620405266 kpc / arcmin&gt;</span>
</pre></div>
</div>
<p>Here WMAP9 is a built-in object describing a cosmology with the
parameters from the 9-year WMAP results. Several other built-in
cosmologies are also available, see <a class="reference internal" href="#built-in-cosmologies">Built-in Cosmologies</a>. The
available methods of the cosmology object are listed in the methods
summary for the <a class="reference internal" href="../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW" title="astropy.cosmology.FLRW"><code class="xref py py-obj docutils literal"><span class="pre">FLRW</span></code></a> class. If you&#8217;re using
IPython you can also use tab completion to print a list of the
available methods. To do this, after importing the cosmology as in the
above example, type <code class="docutils literal"><span class="pre">cosmo.</span></code> at the IPython prompt and then press
the tab key.</p>
<p>All of these methods also accept an arbitrarily shaped array of
redshifts as input:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">WMAP9</span> <span class="k">as</span> <span class="n">cosmo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">comoving_distance</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>  
<span class="go">&lt;Quantity [ 1916.0694236 , 3363.07064333, 4451.74756242] Mpc&gt;</span>
</pre></div>
</div>
<p>You can create your own FLRW-like cosmology using one of the Cosmology
classes:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">FlatLambdaCDM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span>
<span class="go">FlatLambdaCDM(H0=70 km / (Mpc s), Om0=0.3, Tcmb0=2.725 K,</span>
<span class="go">              Neff=3.04, m_nu=[ 0.  0.  0.] eV, Ob0=None)</span>
</pre></div>
</div>
<p>Note the presence of additional cosmological parameters (e.g., <code class="docutils literal"><span class="pre">Neff</span></code>,
the number of effective neutrino species) with default values; these
can also be specified explicitly in the call to the constructor.</p>
<p>The cosmology subpackage makes use of <a class="reference internal" href="../units/index.html#module-astropy.units" title="astropy.units"><code class="xref py py-obj docutils literal"><span class="pre">units</span></code></a>, so in many
cases returns values with units attached.  Consult the documentation
for that subpackage for more details, but briefly, to access the
floating point or array values:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">WMAP9</span> <span class="k">as</span> <span class="n">cosmo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H0</span> <span class="o">=</span> <span class="n">cosmo</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">H0</span><span class="o">.</span><span class="n">unit</span>  
<span class="go">(69.32, Unit(&quot;km / (Mpc s)&quot;))</span>
</pre></div>
</div>
</div>
<div class="section" id="using-astropy-cosmology">
<h2>Using <a class="reference internal" href="#module-astropy.cosmology" title="astropy.cosmology"><code class="xref py py-obj docutils literal"><span class="pre">astropy.cosmology</span></code></a><a class="headerlink" href="#using-astropy-cosmology" title="Permalink to this headline">¶</a></h2>
<p>Most of the functionality is enabled by the <a class="reference internal" href="../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW" title="astropy.cosmology.FLRW"><code class="xref py py-obj docutils literal"><span class="pre">FLRW</span></code></a>
object. This represents a homogeneous and isotropic cosmology
(characterized by the Friedmann-Lemaitre-Robertson-Walker metric,
named after the people who solved Einstein&#8217;s field equation for this
special case).  However, you can&#8217;t work with this class directly, as
you must specify a dark energy model by using one of its subclasses
instead, such as <a class="reference internal" href="../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM" title="astropy.cosmology.FlatLambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatLambdaCDM</span></code></a>.</p>
<p>You can create a new <a class="reference internal" href="../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM" title="astropy.cosmology.FlatLambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatLambdaCDM</span></code></a> object with
arguments giving the Hubble parameter and Omega matter (both at z=0):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">FlatLambdaCDM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span>
<span class="go">FlatLambdaCDM(H0=70 km / (Mpc s), Om0=0.3, Tcmb0=2.725 K,</span>
<span class="go">              Neff=3.04, m_nu=[ 0.  0.  0.] eV, Ob0=None)</span>
</pre></div>
</div>
<p>This can also be done more explicitly using units, which is recommended:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">FlatLambdaCDM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="o">=</span><span class="mi">70</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<p>However, most of the parameters that accept units (<code class="docutils literal"><span class="pre">H0</span></code>, <code class="docutils literal"><span class="pre">Tcmb0</span></code>)
have default units, so unit quantities do not have to be used.
The exception are neutrino masses, where you must supply a
units if you want massive neutrinos.</p>
<p>The pre-defined cosmologies described in the <a class="reference internal" href="#getting-started">Getting Started</a>
section are instances of <a class="reference internal" href="../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM" title="astropy.cosmology.FlatLambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatLambdaCDM</span></code></a>, and have
the same methods. So we can find the luminosity distance to
redshift 4 by:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">luminosity_distance</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">&lt;Quantity 35842.353618623194 Mpc&gt;</span>
</pre></div>
</div>
<p>or the age of the universe at z = 0:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">age</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  
<span class="go">&lt;Quantity 13.461701658024014 Gyr&gt;</span>
</pre></div>
</div>
<p>They also accept arrays of redshifts:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">age</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span><span class="o">.</span><span class="n">value</span>  
<span class="go">array([ 8.42128047,  5.74698053,  4.19645402])</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW" title="astropy.cosmology.FLRW"><code class="xref py py-obj docutils literal"><span class="pre">FLRW</span></code></a> and
<a class="reference internal" href="../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM" title="astropy.cosmology.FlatLambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatLambdaCDM</span></code></a> object docstring for all the
methods and attributes available. In addition to flat Universes,
non-flat varieties are supported such as
<a class="reference internal" href="../api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM" title="astropy.cosmology.LambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">LambdaCDM</span></code></a>.  There are also a variety of standard
cosmologies with the parameters already defined (see <a class="reference internal" href="#built-in-cosmologies">Built-in
Cosmologies</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">WMAP7</span>   <span class="c"># WMAP 7-year cosmology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WMAP7</span><span class="o">.</span><span class="n">critical_density</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c"># critical density at z = 0  </span>
<span class="go">&lt;Quantity 9.31000324385361e-30 g / cm3&gt;</span>
</pre></div>
</div>
<p>You can see how the density parameters evolve with redshift as well:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">WMAP7</span>   <span class="c"># WMAP 7-year cosmology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WMAP7</span><span class="o">.</span><span class="n">Om</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]),</span> <span class="n">WMAP7</span><span class="o">.</span><span class="n">Ode</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>  
<span class="go">(array([ 0.272     ,  0.74898524,  0.90905239]),</span>
<span class="go"> array([ 0.72791572,  0.25055061,  0.0901026 ]))</span>
</pre></div>
</div>
<p>Note that these don&#8217;t quite add up to one even though WMAP7 assumes a
flat Universe because photons and neutrinos are included. Also note
that they are unitless and so are not <a class="reference internal" href="../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-obj docutils literal"><span class="pre">Quantity</span></code></a>
objects.</p>
<p>It is possible to specify the baryonic matter density at redshift zero
at class instantiation by passing the keyword argument <code class="docutils literal"><span class="pre">Ob0</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">FlatLambdaCDM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">Ob0</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span>
<span class="go">FlatLambdaCDM(H0=70 km / (Mpc s), Om0=0.3, Tcmb0=2.725 K,</span>
<span class="go">              Neff=3.04, m_nu=[ 0.  0.  0.] eV, Ob0=0.05)</span>
</pre></div>
</div>
<p>In this case the dark matter only density at redshift zero is
available as class attribute <code class="docutils literal"><span class="pre">Odm0</span></code> and the redshift evolution of
dark and baryonic matter densities can be computed using the methods
<code class="docutils literal"><span class="pre">Odm</span></code> and <code class="docutils literal"><span class="pre">Ob</span></code>, respectively. If <code class="docutils literal"><span class="pre">Ob0</span></code> is not specified at class
instantiation it defaults to <code class="docutils literal"><span class="pre">None</span></code> and any method relying on it
being specified will raise a <code class="docutils literal"><span class="pre">ValueError</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">FlatLambdaCDM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">Odm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Baryonic density not set for this cosmology, unclear</span>
<span class="go">meaning of dark matter density</span>
</pre></div>
</div>
<p>Cosmological instances have an optional <code class="docutils literal"><span class="pre">name</span></code> attribute which can be
used to describe the cosmology:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">FlatwCDM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatwCDM</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;SNLS3+WMAP7&#39;</span><span class="p">,</span> <span class="n">H0</span><span class="o">=</span><span class="mf">71.58</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.262</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.016</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span>
<span class="go">FlatwCDM(name=&quot;SNLS3+WMAP7&quot;, H0=71.6 km / (Mpc s), Om0=0.262,</span>
<span class="go">         w0=-1.02, Tcmb0=2.725 K, Neff=3.04, m_nu=[ 0.  0.  0.] eV,</span>
<span class="go">         Ob0=None)</span>
</pre></div>
</div>
<p>This is also an example with a different model for dark energy, a flat
Universe with a constant dark energy equation of state, but not
necessarily a cosmological constant.  A variety of additional dark
energy models are also supported &#8211; see <a class="reference internal" href="#specifying-a-dark-energy-model">Specifying a dark energy
model</a>.</p>
<p>A important point is that the cosmological parameters of each
instance are immutable &#8211; that is, if you want to change, say,
<code class="docutils literal"><span class="pre">Om</span></code>, you need to make a new instance of the class.  To make
this more convenient, a <code class="docutils literal"><span class="pre">clone</span></code> operation is provided, which
allows you to make a copy with specified values changed.
Note that you can&#8217;t change the type of cosmology with this operation
(e.g., flat to non-flat). For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">WMAP9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newcosmo</span> <span class="o">=</span> <span class="n">WMAP9</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;WMAP9 modified&#39;</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3141</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WMAP9</span><span class="o">.</span><span class="n">H0</span><span class="p">,</span> <span class="n">newcosmo</span><span class="o">.</span><span class="n">H0</span>  <span class="c"># some values unchanged</span>
<span class="go">(&lt;Quantity 69.3... km / (Mpc s)&gt;, &lt;Quantity 69.3... km / (Mpc s)&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WMAP9</span><span class="o">.</span><span class="n">Om0</span><span class="p">,</span> <span class="n">newcosmo</span><span class="o">.</span><span class="n">Om0</span>  <span class="c"># some changed</span>
<span class="go">(0.286..., 0.314...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WMAP9</span><span class="o">.</span><span class="n">Ode0</span><span class="p">,</span> <span class="n">newcosmo</span><span class="o">.</span><span class="n">Ode0</span>  <span class="c"># Indirectly changed since this is flat</span>
<span class="go">(0.713..., 0.685...)</span>
</pre></div>
</div>
<div class="section" id="finding-the-redshift-at-a-given-value-of-a-cosmological-quantity">
<h3>Finding the Redshift at a Given Value of a Cosmological Quantity<a class="headerlink" href="#finding-the-redshift-at-a-given-value-of-a-cosmological-quantity" title="Permalink to this headline">¶</a></h3>
<p>If you know a cosmological quantity and you want to know the
redshift which it corresponds to, you can use <code class="docutils literal"><span class="pre">z_at_value</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">Planck13</span><span class="p">,</span> <span class="n">z_at_value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck13</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span>  
<span class="go">3.1981226843560968</span>
</pre></div>
</div>
<p>For some quantities there can be more than one redshift that satisfies
a value. In this case you can use the <code class="docutils literal"><span class="pre">zmin</span></code> and <code class="docutils literal"><span class="pre">zmax</span></code> keywords
to restrict the search range. See the <code class="docutils literal"><span class="pre">z_at_value</span></code> docstring for more
detailed usage examples.</p>
</div>
<div class="section" id="built-in-cosmologies">
<h3>Built-in Cosmologies<a class="headerlink" href="#built-in-cosmologies" title="Permalink to this headline">¶</a></h3>
<p>A number of pre-loaded cosmologies are available from analyses using
the WMAP and Planck satellite data. For example,</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">Planck13</span>  <span class="c"># Planck 2013</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Planck13</span><span class="o">.</span><span class="n">lookback_time</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c"># lookback time in Gyr at z=2  </span>
<span class="go">&lt;Quantity 10.511841788576083 Gyr&gt;</span>
</pre></div>
</div>
<p>A full list of the pre-defined cosmologies is given by
<code class="docutils literal"><span class="pre">cosmology.parameters.available</span></code>, and summarized below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="7%" />
<col width="9%" />
<col width="13%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Source</th>
<th class="head">H0</th>
<th class="head">Om</th>
<th class="head">Flat</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>WMAP5</td>
<td>Komatsu et al. 2009</td>
<td>70.2</td>
<td>0.277</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>WMAP7</td>
<td>Komatsu et al. 2011</td>
<td>70.4</td>
<td>0.272</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>WMAP9</td>
<td>Hinshaw et al. 2013</td>
<td>69.3</td>
<td>0.287</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Planck13</td>
<td>Planck Collab 2013, Paper XVI</td>
<td>67.8</td>
<td>0.307</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Planck15</td>
<td>Planck Collab 2015, Paper XIII</td>
<td>67.7</td>
<td>0.307</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p>Currently, all are instances of <a class="reference internal" href="../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM" title="astropy.cosmology.FlatLambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatLambdaCDM</span></code></a>.
More details about exactly where each set of parameters come from
are available in the docstring for each object:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">WMAP7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">WMAP7</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>
<span class="go">WMAP7 instance of FlatLambdaCDM cosmology</span>
<span class="go">(from Komatsu et al. 2011, ApJS, 192, 18, doi: 10.1088/0067-0049/192/2/18.</span>
<span class="go">Table 1 (WMAP + BAO + H0 ML).)</span>
</pre></div>
</div>
</div>
<div class="section" id="specifying-a-dark-energy-model">
<h3>Specifying a dark energy model<a class="headerlink" href="#specifying-a-dark-energy-model" title="Permalink to this headline">¶</a></h3>
<p>In addition to the standard <a class="reference internal" href="../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM" title="astropy.cosmology.FlatLambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatLambdaCDM</span></code></a> model
described above, a number of additional dark energy models are
provided.  <a class="reference internal" href="../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM" title="astropy.cosmology.FlatLambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatLambdaCDM</span></code></a>
and <a class="reference internal" href="../api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM" title="astropy.cosmology.LambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">LambdaCDM</span></code></a> assume that dark
energy is a cosmological constant, and should be the most commonly
used cases; the former assumes a flat Universe, the latter allows
for spatial curvature.  <a class="reference internal" href="../api/astropy.cosmology.FlatwCDM.html#astropy.cosmology.FlatwCDM" title="astropy.cosmology.FlatwCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatwCDM</span></code></a> and
<a class="reference internal" href="../api/astropy.cosmology.wCDM.html#astropy.cosmology.wCDM" title="astropy.cosmology.wCDM"><code class="xref py py-obj docutils literal"><span class="pre">wCDM</span></code></a> assume a constant dark
energy equation of state parameterized by <img class="math" src="../_images/math/9335638aefc19461029ec382539e3c3eeb8b1209.png" alt="w_{0}"/>. Two forms of a
variable dark energy equation of state are provided: the simple first
order linear expansion <img class="math" src="../_images/math/f716c54cd5698d21e86f215e2799694f0e57e3e8.png" alt="w(z) = w_{0} + w_{z} z"/> by
<a class="reference internal" href="../api/astropy.cosmology.w0wzCDM.html#astropy.cosmology.w0wzCDM" title="astropy.cosmology.w0wzCDM"><code class="xref py py-obj docutils literal"><span class="pre">w0wzCDM</span></code></a>, as well as the common CPL form by
<a class="reference internal" href="../api/astropy.cosmology.w0waCDM.html#astropy.cosmology.w0waCDM" title="astropy.cosmology.w0waCDM"><code class="xref py py-obj docutils literal"><span class="pre">w0waCDM</span></code></a>: <img class="math" src="../_images/math/a307c96057f138b56dcb756a76a6307dcb28faaa.png" alt="w(z) = w_{0} + w_{a} (1 - a) =
w_{0} + w_{a} z / (1 + z)"/> and its generalization to include a pivot
redshift by <a class="reference internal" href="../api/astropy.cosmology.wpwaCDM.html#astropy.cosmology.wpwaCDM" title="astropy.cosmology.wpwaCDM"><code class="xref py py-obj docutils literal"><span class="pre">wpwaCDM</span></code></a>: <img class="math" src="../_images/math/ef338dd500ae34ed9dd7d454dd05a3826de21bc2.png" alt="w(z) = w_{p} + w_{a}
(a_{p} - a)"/>.</p>
<p>Users can specify their own equation of state by sub-classing
<a class="reference internal" href="../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW" title="astropy.cosmology.FLRW"><code class="xref py py-obj docutils literal"><span class="pre">FLRW</span></code></a>.  See the provided subclasses for
examples. It is recommended, but not required, that all arguments to the
constructor of a new subclass be available as properties, since the
<code class="docutils literal"><span class="pre">clone</span></code> method assumes this is the case.  It is also advisable
to stick to subclassing <a class="reference internal" href="../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW" title="astropy.cosmology.FLRW"><code class="xref py py-obj docutils literal"><span class="pre">FLRW</span></code></a> rather than one of
its subclasses, since some of them use internal optimizations that
also need to be propagated to any subclasses.  Users wishing to
use similar tricks (which can make distance calculations much faster)
should consult the cosmology module source code for details.</p>
</div>
<div class="section" id="photons-and-neutrinos">
<h3>Photons and Neutrinos<a class="headerlink" href="#photons-and-neutrinos" title="Permalink to this headline">¶</a></h3>
<p>The cosmology classes include the contribution to the energy density
from both photons and neutrinos.  By default, the latter are assumed
massless.  The three parameters controlling the properties of these
species, which are arguments to the initializers of all the
cosmological classes, are <code class="docutils literal"><span class="pre">Tcmb0</span></code> (the temperature of the CMB at z=0),
<code class="docutils literal"><span class="pre">Neff</span></code>, the effective number of neutrino species, and <code class="docutils literal"><span class="pre">m_nu</span></code>, the rest
mass of the neutrino species.  <code class="docutils literal"><span class="pre">Tcmb0</span></code> and <code class="docutils literal"><span class="pre">m_nu</span></code> should be expressed
as unit Quantities.  All three have standard default values (2.725 K,
3.04, and 0 eV respectively; the reason that <code class="docutils literal"><span class="pre">Neff</span></code> is not 3 primarily
has to do with a small bump in the neutrino energy spectrum due to
electron-positron annihilation, but is also affected by weak
interaction physics).</p>
<p>Massive neutrinos are treated using the approach described in the
WMAP 7-year cosmology paper (Komatsu et al. 2011, ApJS, 192, 18, section 3.3).
This is not the simple
<img class="math" src="../_images/math/1402135b7a1b910eb35a258576bac947e1bb3002.png" alt="\Omega_{\nu 0} h^2 = \sum_i m_{\nu\, i} / 93.04\,\mathrm{eV}"/>
approximation.  Also note that the values of <img class="math" src="../_images/math/b8698fafc4f5e44b5a8efceddceb79694e47b3c9.png" alt="\Omega_{\nu}(z)"/>
include both the kinetic energy and the rest-mass energy components,
and that the Planck13 and Planck15 cosmologies includes a single
species of neutrinos with non-zero mass (which is not included in
<img class="math" src="../_images/math/e8f75d5334c2dc7a6e55676041e3602aac3c7813.png" alt="\Omega_{m0}"/>).</p>
<p>Adding massive neutrinos can have significant performance implications.
In particular, the computation of distance measures and lookback times
are factors of 3-4 slower than in the massless neutrino case.  Therefore,
if you need to compute a lot of distances in such a cosmology and
performance is critical, it is particularly useful to calculate them on
a grid and use interpolation.</p>
<p>The contribution of photons and neutrinos to the total mass-energy density
can be found as a function of redshift:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">WMAP7</span>   <span class="c"># WMAP 7-year cosmology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WMAP7</span><span class="o">.</span><span class="n">Ogamma0</span><span class="p">,</span> <span class="n">WMAP7</span><span class="o">.</span><span class="n">Onu0</span>  <span class="c"># Current epoch values  </span>
<span class="go">(4.985694972799396e-05, 3.442154948307989e-05)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WMAP7</span><span class="o">.</span><span class="n">Ogamma</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">WMAP7</span><span class="o">.</span><span class="n">Onu</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">(array([  4.98569497e-05,   2.74574409e-04,   4.99881391e-04]),</span>
<span class="go"> array([  3.44215495e-05,   1.89567887e-04,   3.45121234e-04]))</span>
</pre></div>
</div>
<p>If you want to exclude photons and neutrinos from your calculations,
simply set <code class="docutils literal"><span class="pre">Tcmb0</span></code> to 0:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">FlatLambdaCDM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="mf">70.4</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span> <span class="mf">0.272</span><span class="p">,</span> <span class="n">Tcmb0</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="o">.</span><span class="n">Ogamma0</span><span class="p">,</span> <span class="n">cos</span><span class="o">.</span><span class="n">Onu0</span>
<span class="go">(0.0, 0.0)</span>
</pre></div>
</div>
<p>Neutrinos can be removed (while leaving photons) by setting <code class="docutils literal"><span class="pre">Neff</span></code> to 0:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">FlatLambdaCDM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="mf">70.4</span><span class="p">,</span> <span class="mf">0.272</span><span class="p">,</span> <span class="n">Neff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="o">.</span><span class="n">Ogamma</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c"># Photons are still present  </span>
<span class="go">array([  4.98569497e-05,   2.74623215e-04,   5.00051839e-04])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="o">.</span><span class="n">Onu</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c"># But not neutrinos</span>
<span class="go">array([ 0.,  0.,  0.])</span>
</pre></div>
</div>
<p>The number of neutrino species is assumed to be the floor of <code class="docutils literal"><span class="pre">Neff</span></code>,
which in the default case is 3.  Therefore, if non-zero neutrino masses
are desired, then 3 masses should be provided.  However, if only one
value is provided, all the species are assumed to have the same mass.
<code class="docutils literal"><span class="pre">Neff</span></code> is assumed to be shared equally between each species.</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">FlatLambdaCDM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H0</span> <span class="o">=</span> <span class="mf">70.4</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m_nu</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="p">,</span> <span class="mf">0.272</span><span class="p">,</span> <span class="n">m_nu</span><span class="o">=</span><span class="n">m_nu</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">has_massive_nu</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">m_nu</span>
<span class="go">&lt;Quantity [ 0., 0., 0.] eV&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m_nu</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="p">,</span> <span class="mf">0.272</span><span class="p">,</span> <span class="n">m_nu</span><span class="o">=</span><span class="n">m_nu</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">has_massive_nu</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">m_nu</span>
<span class="go">&lt;Quantity [ 0.  , 0.05, 0.1 ] eV&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">Onu</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">])</span>  
<span class="go">array([ 0.00326988,  0.00896783,  0.0125786 ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span><span class="o">.</span><span class="n">Onu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">cosmo</span><span class="o">.</span><span class="n">critical_density</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  
<span class="go">&lt;Quantity 2.444380380370406e-31 g / cm3&gt;</span>
</pre></div>
</div>
<p>While these examples used <a class="reference internal" href="../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM" title="astropy.cosmology.FlatLambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatLambdaCDM</span></code></a>,
the above examples also apply for all of the other cosmology classes.</p>
</div>
</div>
<div class="section" id="for-developers-using-astropy-cosmology-inside-astropy">
<h2>For Developers: Using <a class="reference internal" href="#module-astropy.cosmology" title="astropy.cosmology"><code class="xref py py-obj docutils literal"><span class="pre">astropy.cosmology</span></code></a> inside Astropy<a class="headerlink" href="#for-developers-using-astropy-cosmology-inside-astropy" title="Permalink to this headline">¶</a></h2>
<p>If you are writing code for the Astropy core or an affiliated package,
it&#8217;s often useful to assume a default cosmology, so that the exact
cosmology doesn&#8217;t have to be specified every time a function or method
is called. In this case it&#8217;s possible to specify a &#8220;default&#8221;
cosmology.</p>
<p>You can set the default cosmology to a pre-defined value by using the
&#8220;default_cosmology&#8221; option in the <code class="docutils literal"><span class="pre">[cosmology.core]</span></code> section of the
configuration file (see <a class="reference internal" href="../config/index.html#astropy-config"><span class="std std-ref">Configuration system (astropy.config)</span></a>). Alternatively, you can
use the <code class="docutils literal"><span class="pre">set</span></code> function of <a class="reference internal" href="../api/astropy.cosmology.default_cosmology.html#astropy.cosmology.default_cosmology" title="astropy.cosmology.default_cosmology"><code class="xref py py-obj docutils literal"><span class="pre">default_cosmology</span></code></a> to
set a cosmology for the current Python session. If you haven&#8217;t set a
default cosmology using one of the methods described above, then the
cosmology module will default to using the 9-year WMAP parameters.</p>
<p>It is strongly recommended that you use the default cosmology through
the <a class="reference internal" href="../api/astropy.cosmology.default_cosmology.html#astropy.cosmology.default_cosmology" title="astropy.cosmology.default_cosmology"><code class="xref py py-obj docutils literal"><span class="pre">default_cosmology</span></code></a> science state object. An
override option can then be provided using something like the
following:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">cosmo</span><span class="o">=</span><span class="k">None</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="k">import</span> <span class="n">default_cosmology</span>

    <span class="k">if</span> <span class="n">cosmo</span> <span class="ow">is</span> <span class="k">None</span><span class="p">:</span>
        <span class="n">cosmo</span> <span class="o">=</span> <span class="n">default_cosmology</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

    <span class="o">...</span> <span class="n">your</span> <span class="n">code</span> <span class="n">here</span> <span class="o">...</span>
</pre></div>
</div>
<p>This ensures that all code consistently uses the default cosmology
unless explicitly overridden.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In general it&#8217;s better to use an explicit cosmology (for example
<code class="docutils literal"><span class="pre">WMAP9.H(0)</span></code> instead of
<code class="docutils literal"><span class="pre">cosmology.default_cosmology.get().H(0)</span></code>). Use of the default
cosmology should generally be reserved for code that will be
included in the Astropy core or an affiliated package.</p>
</div>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Hogg, &#8220;Distance measures in cosmology&#8221;,
<a class="reference external" href="http://arxiv.org/abs/astroph/9905116">http://arxiv.org/abs/astroph/9905116</a></li>
<li>Linder, &#8220;Exploring the Expansion History of the Universe&#8221;, <a class="reference external" href="http://arxiv.org/abs/astro-ph/0208512">http://arxiv.org/abs/astro-ph/0208512</a></li>
<li>NASA&#8217;s Legacy Archive for Microwave Background Data Analysis,
<a class="reference external" href="http://lambda.gsfc.nasa.gov/">http://lambda.gsfc.nasa.gov/</a></li>
</ul>
</div>
<div class="section" id="range-of-validity-and-reliability">
<h2>Range of validity and reliability<a class="headerlink" href="#range-of-validity-and-reliability" title="Permalink to this headline">¶</a></h2>
<p>The code in this sub-package is tested against several widely-used
online cosmology calculators, and has been used to perform many
calculations in refereed papers. You can check the range of redshifts
over which the code is regularly tested in the module
<code class="docutils literal"><span class="pre">astropy.cosmology.tests.test_cosmology</span></code>. If you find any bugs,
please let us know by <a class="reference external" href="https://github.com/astropy/astropy/issues">opening an issue at the github repository</a>!</p>
<p>The built in cosmologies use the parameters as listed in the
respective papers.  These provide only a limited range of precision,
and so you should not expect derived quantities to match beyond
that precision.  For example, the Planck 2013 and 2015 results only provide the
Hubble constant to 4 digits.  Therefore, they shouldn&#8217;t be expected
to match the age quoted by the Planck team to better than that, despite
the fact that 5 digits are quoted in the papers.</p>
</div>
<div class="section" id="reference-api">
<h2>Reference/API<a class="headerlink" href="#reference-api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-astropy.cosmology">
<span id="astropy-cosmology-package"></span><h3>astropy.cosmology Package<a class="headerlink" href="#module-astropy.cosmology" title="Permalink to this headline">¶</a></h3>
<p>astropy.cosmology contains classes and functions for cosmological
distance measures and other cosmology-related calculations.</p>
<p>See the <a class="reference external" href="http://docs.astropy.org/en/latest/cosmology/index.html">Astropy documentation</a> for more
detailed usage examples and references.</p>
<div class="section" id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.cosmology.z_at_value.html#astropy.cosmology.z_at_value" title="astropy.cosmology.z_at_value"><code class="xref py py-obj docutils literal"><span class="pre">z_at_value</span></code></a>(func,&nbsp;fval[,&nbsp;zmin,&nbsp;zmax,&nbsp;ztol,&nbsp;...])</td>
<td>Find the redshift <code class="docutils literal"><span class="pre">z</span></code> at which <code class="docutils literal"><span class="pre">func(z)</span> <span class="pre">=</span> <span class="pre">fval</span></code>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="classes">
<h4>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW" title="astropy.cosmology.FLRW"><code class="xref py py-obj docutils literal"><span class="pre">FLRW</span></code></a>(H0,&nbsp;Om0,&nbsp;Ode0[,&nbsp;Tcmb0,&nbsp;Neff,&nbsp;m_nu,&nbsp;...])</td>
<td>A class describing an isotropic and homogeneous (Friedmann-Lemaitre-Robertson-Walker) cosmology.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM" title="astropy.cosmology.FlatLambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatLambdaCDM</span></code></a>(H0,&nbsp;Om0[,&nbsp;Tcmb0,&nbsp;Neff,&nbsp;m_nu,&nbsp;...])</td>
<td>FLRW cosmology with a cosmological constant and no curvature.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.cosmology.Flatw0waCDM.html#astropy.cosmology.Flatw0waCDM" title="astropy.cosmology.Flatw0waCDM"><code class="xref py py-obj docutils literal"><span class="pre">Flatw0waCDM</span></code></a>(H0,&nbsp;Om0[,&nbsp;w0,&nbsp;wa,&nbsp;Tcmb0,&nbsp;Neff,&nbsp;...])</td>
<td>FLRW cosmology with a CPL dark energy equation of state and no curvature.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/astropy.cosmology.FlatwCDM.html#astropy.cosmology.FlatwCDM" title="astropy.cosmology.FlatwCDM"><code class="xref py py-obj docutils literal"><span class="pre">FlatwCDM</span></code></a>(H0,&nbsp;Om0[,&nbsp;w0,&nbsp;Tcmb0,&nbsp;Neff,&nbsp;m_nu,&nbsp;...])</td>
<td>FLRW cosmology with a constant dark energy equation of state and no spatial curvature.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM" title="astropy.cosmology.LambdaCDM"><code class="xref py py-obj docutils literal"><span class="pre">LambdaCDM</span></code></a>(H0,&nbsp;Om0,&nbsp;Ode0[,&nbsp;Tcmb0,&nbsp;Neff,&nbsp;...])</td>
<td>FLRW cosmology with a cosmological constant and curvature.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/astropy.cosmology.default_cosmology.html#astropy.cosmology.default_cosmology" title="astropy.cosmology.default_cosmology"><code class="xref py py-obj docutils literal"><span class="pre">default_cosmology</span></code></a>()</td>
<td>The default cosmology to use.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.cosmology.w0waCDM.html#astropy.cosmology.w0waCDM" title="astropy.cosmology.w0waCDM"><code class="xref py py-obj docutils literal"><span class="pre">w0waCDM</span></code></a>(H0,&nbsp;Om0,&nbsp;Ode0[,&nbsp;w0,&nbsp;wa,&nbsp;Tcmb0,&nbsp;...])</td>
<td>FLRW cosmology with a CPL dark energy equation of state and curvature.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/astropy.cosmology.w0wzCDM.html#astropy.cosmology.w0wzCDM" title="astropy.cosmology.w0wzCDM"><code class="xref py py-obj docutils literal"><span class="pre">w0wzCDM</span></code></a>(H0,&nbsp;Om0,&nbsp;Ode0[,&nbsp;w0,&nbsp;wz,&nbsp;Tcmb0,&nbsp;...])</td>
<td>FLRW cosmology with a variable dark energy equation of state and curvature.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.cosmology.wCDM.html#astropy.cosmology.wCDM" title="astropy.cosmology.wCDM"><code class="xref py py-obj docutils literal"><span class="pre">wCDM</span></code></a>(H0,&nbsp;Om0,&nbsp;Ode0[,&nbsp;w0,&nbsp;Tcmb0,&nbsp;Neff,&nbsp;m_nu,&nbsp;...])</td>
<td>FLRW cosmology with a constant dark energy equation of state and curvature.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/astropy.cosmology.wpwaCDM.html#astropy.cosmology.wpwaCDM" title="astropy.cosmology.wpwaCDM"><code class="xref py py-obj docutils literal"><span class="pre">wpwaCDM</span></code></a>(H0,&nbsp;Om0,&nbsp;Ode0[,&nbsp;wp,&nbsp;wa,&nbsp;zp,&nbsp;Tcmb0,&nbsp;...])</td>
<td>FLRW cosmology with a CPL dark energy equation of state, a pivot redshift, and curvature.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="class-inheritance-diagram">
<h4>Class Inheritance Diagram<a class="headerlink" href="#class-inheritance-diagram" title="Permalink to this headline">¶</a></h4>
<object data="../_images/inheritance-50c34e433ab39059c9b85ee11468f8a3f4f29ba7.svg" type="image/svg+xml">
            <p class="warning">Inheritance diagram of astropy.cosmology.core.FLRW, astropy.cosmology.core.FlatLambdaCDM, astropy.cosmology.core.Flatw0waCDM, astropy.cosmology.core.FlatwCDM, astropy.cosmology.core.LambdaCDM, astropy.cosmology.core.default_cosmology, astropy.cosmology.core.w0waCDM, astropy.cosmology.core.w0wzCDM, astropy.cosmology.core.wCDM, astropy.cosmology.core.wpwaCDM</p></object>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Cosmological Calculations (<code class="docutils literal"><span class="pre">astropy.cosmology</span></code>)</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li><a class="reference internal" href="#using-astropy-cosmology">Using <code class="docutils literal"><span class="pre">astropy.cosmology</span></code></a><ul>
<li><a class="reference internal" href="#finding-the-redshift-at-a-given-value-of-a-cosmological-quantity">Finding the Redshift at a Given Value of a Cosmological Quantity</a></li>
<li><a class="reference internal" href="#built-in-cosmologies">Built-in Cosmologies</a></li>
<li><a class="reference internal" href="#specifying-a-dark-energy-model">Specifying a dark energy model</a></li>
<li><a class="reference internal" href="#photons-and-neutrinos">Photons and Neutrinos</a></li>
</ul>
</li>
<li><a class="reference internal" href="#for-developers-using-astropy-cosmology-inside-astropy">For Developers: Using <code class="docutils literal"><span class="pre">astropy.cosmology</span></code> inside Astropy</a></li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
<li><a class="reference internal" href="#range-of-validity-and-reliability">Range of validity and reliability</a></li>
<li><a class="reference internal" href="#reference-api">Reference/API</a><ul>
<li><a class="reference internal" href="#module-astropy.cosmology">astropy.cosmology Package</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/master/docs/cosmology/index.rst">Edit This Page on Github</a> &nbsp;
    <a href="../_sources/cosmology/index.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.1. &nbsp;
    Last built 29 Apr 2016. <br/>
  </p>
</footer>
  </body>
</html>