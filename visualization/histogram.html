<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Choosing Histogram Bins &mdash; Astropy v1.2.dev14999</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.dev14999',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev14999" href="../index.html" />
    <link rel="up" title="Data Visualization (astropy.visualization)" href="index.html" />
    <link rel="next" title="hist" href="../api/astropy.visualization.hist.html" />
    <link rel="prev" title="Image stretching and normalization" href="normalization.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../api/astropy.visualization.hist.html" title="hist">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="normalization.html" title="Image stretching and normalization">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v1.2.dev14999</a>
	 &raquo;
      </li>
      <li><a href="index.html" accesskey="U">Data Visualization (<code class="docutils literal"><span class="pre">astropy.visualization</span></code>)</a> &raquo;</li>
      
      <li>Choosing Histogram Bins</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="choosing-histogram-bins">
<span id="astropy-visualization-hist"></span><h1>Choosing Histogram Bins<a class="headerlink" href="#choosing-histogram-bins" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="index.html#module-astropy.visualization" title="astropy.visualization"><code class="xref py py-mod docutils literal"><span class="pre">astropy.visualization</span></code></a> module provides the
<a class="reference internal" href="../api/astropy.visualization.hist.html#astropy.visualization.hist" title="astropy.visualization.hist"><code class="xref py py-func docutils literal"><span class="pre">hist()</span></code></a> function, which is a generalization of
matplotlib&#8217;s histogram function which allows for more flexible specification
of histogram bins. For computing bins without the accompanying plot, see
<a class="reference internal" href="../api/astropy.stats.histogram.html#astropy.stats.histogram" title="astropy.stats.histogram"><code class="xref py py-func docutils literal"><span class="pre">astropy.stats.histogram()</span></code></a>.</p>
<p>As a motivation for this, consider the following two histograms, which are
constructed from the same underlying set of 5000 points, the first with
matplotlib&#8217;s default of 10 bins, the second with an arbitrarily chosen
200 bins:</p>
<p>(<a class="reference external" href="../visualization/histogram-1.py">Source code</a>, <a class="reference external" href="../visualization/histogram-1.png">png</a>, <a class="reference external" href="../visualization/histogram-1.hires.png">hires.png</a>, <a class="reference external" href="../visualization/histogram-1.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../_images/histogram-1.png" src="../_images/histogram-1.png" />
</div>
<p>Upon visual inspection, it is clear that each of these choices is suboptimal:
with 10 bins, the fine structure of the data distribution is lost, while with
200 bins, heights of individual bins are affected by sampling error.
The tried-and-true method employed by most scientists is a trial and error
approach that attempts to find a suitable midpoint between these.</p>
<p>Astropy&#8217;s <a class="reference internal" href="../api/astropy.visualization.hist.html#astropy.visualization.hist" title="astropy.visualization.hist"><code class="xref py py-func docutils literal"><span class="pre">hist()</span></code></a> function addresses this by
providing several methods of automatically tuning the histogram bin size.
It has a syntax identical to matplotlib&#8217;s <code class="docutils literal"><span class="pre">plt.hist</span></code> function, with the
exception of the <code class="docutils literal"><span class="pre">bins</span></code> parameter, which allows specification of one of
four different methods for automatic bin selection. These methods are
implemented in <a class="reference internal" href="../api/astropy.stats.histogram.html#astropy.stats.histogram" title="astropy.stats.histogram"><code class="xref py py-func docutils literal"><span class="pre">astropy.stats.histogram()</span></code></a>, which has a similar syntax
to the <code class="docutils literal"><span class="pre">np.histogram</span></code> function.</p>
<div class="section" id="normal-reference-rules">
<h2>Normal Reference Rules<a class="headerlink" href="#normal-reference-rules" title="Permalink to this headline">¶</a></h2>
<p>The simplest methods of tuning the number of bins are the normal reference
rules due to Scott (implemented in <a class="reference internal" href="../api/astropy.stats.scott_bin_width.html#astropy.stats.scott_bin_width" title="astropy.stats.scott_bin_width"><code class="xref py py-func docutils literal"><span class="pre">scott_bin_width()</span></code></a>) and
Freedman &amp; Diaconis (implemented in <a class="reference internal" href="../api/astropy.stats.freedman_bin_width.html#astropy.stats.freedman_bin_width" title="astropy.stats.freedman_bin_width"><code class="xref py py-func docutils literal"><span class="pre">freedman_bin_width()</span></code></a>).
These rules proceed by assuming the data is close to normally-distributed, and
applying a rule-of-thumb intended to minimize the difference between the
histogram and the underlying distribution of data.</p>
<p>The following figure shows the results of these two rules on the above dataset:</p>
<p>(<a class="reference external" href="../visualization/histogram-2.py">Source code</a>, <a class="reference external" href="../visualization/histogram-2.png">png</a>, <a class="reference external" href="../visualization/histogram-2.hires.png">hires.png</a>, <a class="reference external" href="../visualization/histogram-2.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../_images/histogram-2.png" src="../_images/histogram-2.png" />
</div>
<p>As we can see, both of these rules of thumb choose an intermediate number of
bins which provide a good tradeoff between data representation and noise
suppression.</p>
</div>
<div class="section" id="bayesian-models">
<h2>Bayesian Models<a class="headerlink" href="#bayesian-models" title="Permalink to this headline">¶</a></h2>
<p>Though rules-of-thumb like Scott&#8217;s rule and the Freedman-Diaconis rule are
fast and convenient, their strong assumptions about the data make them
suboptimal for more complicated distributions. Other methods of bin selection
use fitness functions computed on the actual data to choose an optimal binning.
Astropy implements two of these examples: Knuth&#8217;s rule (implemented in
<a class="reference internal" href="../api/astropy.stats.knuth_bin_width.html#astropy.stats.knuth_bin_width" title="astropy.stats.knuth_bin_width"><code class="xref py py-func docutils literal"><span class="pre">knuth_bin_width()</span></code></a>) and Bayesian Blocks (implemented in
<a class="reference internal" href="../api/astropy.stats.bayesian_blocks.html#astropy.stats.bayesian_blocks" title="astropy.stats.bayesian_blocks"><code class="xref py py-func docutils literal"><span class="pre">bayesian_blocks()</span></code></a>).</p>
<p>Knuth&#8217;s rule chooses a constant bin size which minimizes the error of the
histogram&#8217;s approximation to the data, while the Bayesian Blocks uses a more
flexible method which allows varying bin widths. Because both of these require
the minimization of a cost function across the dataset, they are more
computationally intensive than the rules-of-thumb mentioned above. Here are
the results of these procedures for the above dataset:</p>
<p>(<a class="reference external" href="../visualization/histogram-3.py">Source code</a>, <a class="reference external" href="../visualization/histogram-3.png">png</a>, <a class="reference external" href="../visualization/histogram-3.hires.png">hires.png</a>, <a class="reference external" href="../visualization/histogram-3.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../_images/histogram-3.png" src="../_images/histogram-3.png" />
</div>
<p>Notice that both of these capture the shape of the distribution very
accurately, and that the <code class="docutils literal"><span class="pre">bins='blocks'</span></code> panel selects bin widths which vary
in width depending on the local structure in the data. Compared to standard
defaults, these Bayesian optimization methods provide a much more principled
means of choosing histogram binning.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Choosing Histogram Bins</a><ul>
<li><a class="reference internal" href="#normal-reference-rules">Normal Reference Rules</a></li>
<li><a class="reference internal" href="#bayesian-models">Bayesian Models</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/master/docs/visualization/histogram.rst">Edit This Page on Github</a> &nbsp;
    <a href="../_sources/visualization/histogram.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1. &nbsp;
    Last built 12 May 2016. <br/>
  </p>
</footer>
  </body>
</html>