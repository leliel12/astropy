<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>FITS File handling (astropy.io.fits) &mdash; Astropy v1.2.dev15690</title>
    
    <link rel="stylesheet" href="../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.2.dev15690',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev15690" href="../../index.html" />
    <link rel="next" title="FITS Headers" href="usage/headers.html" />
    <link rel="prev" title="Unified file read/write interface" href="../unified.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="usage/headers.html" title="FITS Headers">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../unified.html" title="Unified file read/write interface">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">Astropy v1.2.dev15690</a>
	 &raquo;
      </li>
      
      <li>FITS File handling (<code class="docutils literal"><span class="pre">astropy.io.fits</span></code>)</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fits-file-handling-astropy-io-fits">
<span id="astropy-io-fits"></span><h1>FITS File handling (<a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits</span></code></a>)<a class="headerlink" href="#fits-file-handling-astropy-io-fits" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-mod docutils literal"><span class="pre">astropy.io.fits</span></code></a> package provides access to FITS files. FITS
(Flexible Image Transport System) is a portable file standard widely used in
the astronomy community to store images and tables.</p>
</div>
<div class="section" id="getting-started">
<span id="tutorial"></span><h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>This section provides a quick introduction of using <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-mod docutils literal"><span class="pre">astropy.io.fits</span></code></a>. The
goal is to demonstrate the package&#8217;s basic features without getting into too
much detail. If you are a first time user or have never used Astropy or PyFITS,
this is where you should start.  See also the <a class="reference internal" href="appendix/faq.html#io-fits-faq"><span>FAQ</span></a> for
answers to common questions/issues.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you want to read or write a single table in FITS format then the
simplest method is often via the high-level <a class="reference internal" href="../unified.html#table-io"><span>Unified file read/write interface</span></a>.  In particular
see the <a class="reference internal" href="../unified.html#table-io-fits"><span>Unified I/O FITS</span></a> section.</p>
</div>
<div class="section" id="reading-and-updating-existing-fits-files">
<h3>Reading and Updating Existing FITS Files<a class="headerlink" href="#reading-and-updating-existing-fits-files" title="Permalink to this headline">¶</a></h3>
<div class="section" id="opening-a-fits-file">
<h4>Opening a FITS file<a class="headerlink" href="#opening-a-fits-file" title="Permalink to this headline">¶</a></h4>
<p>Once the <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits</span></code></a> package is loaded using the standard convention<a class="footnote-reference" href="#f1" id="id1">[1]</a>, we can open an existing FITS file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;input.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal"><span class="pre">open()</span></code></a> function has several optional arguments which will be
discussed in a later chapter. The default mode, as in the above example, is
&#8220;readonly&#8221;.  The open function returns an object called an <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal"><span class="pre">HDUList</span></code></a>
which is a <a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.5)"><code class="xref py py-obj docutils literal"><span class="pre">list</span></code></a>-like collection of HDU objects. An HDU (Header Data Unit) is
the highest level component of the FITS file structure, consisting of a header
and (typically) a data array or table.</p>
<p>After the above open call, <code class="docutils literal"><span class="pre">hdulist[0]</span></code> is the primary HDU, <code class="docutils literal"><span class="pre">hdulist[1]</span></code> is
the first extension HDU, etc (if there are any extensions), and so on.  It
should be noted that Astropy is using zero-based indexing when referring to
HDUs and header cards, though the FITS standard (which was designed with
FORTRAN in mind) uses one-based indexing.</p>
<p>The <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal"><span class="pre">HDUList</span></code></a> has a useful method <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.info" title="astropy.io.fits.HDUList.info"><code class="xref py py-meth docutils literal"><span class="pre">HDUList.info()</span></code></a>, which
summarizes the content of the opened FITS file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">Filename: test1.fits</span>
<span class="go">No. Name  Type       Cards Dimensions Format</span>
<span class="go">0 PRIMARY PrimaryHDU   220 ()         int16</span>
<span class="go">1 SCI     ImageHDU      61 (800, 800) float32</span>
<span class="go">2 SCI     ImageHDU      61 (800, 800) float32</span>
<span class="go">3 SCI     ImageHDU      61 (800, 800) float32</span>
<span class="go">4 SCI     ImageHDU      61 (800, 800) float32</span>
</pre></div>
</div>
<p>After you are done with the opened file, close it with the
<a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.close" title="astropy.io.fits.HDUList.close"><code class="xref py py-meth docutils literal"><span class="pre">HDUList.close()</span></code></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The headers will still be accessible after the HDUList is closed. The data may
or may not be accessible depending on whether the data are touched and if they
are memory-mapped, see later chapters for detail.</p>
<div class="section" id="working-with-large-files">
<span id="fits-large-files"></span><h5>Working with large files<a class="headerlink" href="#working-with-large-files" title="Permalink to this headline">¶</a></h5>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal"><span class="pre">open()</span></code></a> function supports a <code class="docutils literal"><span class="pre">memmap=True</span></code> argument that allows the
array data of each HDU to be accessed with mmap, rather than being read into
memory all at once.  This is particularly useful for working with very large
arrays that cannot fit entirely into physical memory.</p>
<p>This has minimal impact on smaller files as well, though some operations, such
as reading the array data sequentially, may incur some additional overhead.  On
32-bit systems arrays larger than 2-3 GB cannot be mmap&#8217;d (which is fine,
because by that point you&#8217;re likely to run out of physical memory anyways), but
64-bit systems are much less limited in this respect.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>When opening a file with <code class="docutils literal"><span class="pre">memmap=True</span></code>, because of how mmap works this means that
when the HDU data is accessed (i.e. <code class="docutils literal"><span class="pre">hdul[0].data</span></code>) another handle to the FITS file
is opened by mmap. This means that even after calling <code class="docutils literal"><span class="pre">hdul.close()</span></code> the mmap still
holds an open handle to the data so that it can still be accessed by unwary programs
that were built with the assumption that the .data attribute has all the data in-memory.</p>
<p class="last">In order to force the mmap to close either wait for the containing <code class="docutils literal"><span class="pre">HDUList</span></code> object to go
out of scope, or manually call <code class="docutils literal"><span class="pre">del</span> <span class="pre">hdul[0].data</span></code> (this works so long as there are no other
references held to the data array).</p>
</div>
</div>
<div class="section" id="unsigned-integers">
<h5>Unsigned integers<a class="headerlink" href="#unsigned-integers" title="Permalink to this headline">¶</a></h5>
<p>Due to the FITS format&#8217;s FORTRAN origins, FITS does not natively support
unsigned integer data in images or tables.  However, there is a common
convention to store unsigned integers as signed integers, along with a
<em>shift</em> instruction (a <code class="docutils literal"><span class="pre">BZERO</span></code> keyword with value <code class="docutils literal"><span class="pre">2</span> <span class="pre">**</span> <span class="pre">(BITPIX</span> <span class="pre">-</span> <span class="pre">1)</span></code>) to
shift up all signed integers to unsigned inters.  For example, when writing
the value <code class="docutils literal"><span class="pre">0</span></code> as an unsigned 32-bit integer, it is stored in the FITS
file as <code class="docutils literal"><span class="pre">-32768</span></code>, along with the header keyword <code class="docutils literal"><span class="pre">BZERO</span> <span class="pre">=</span> <span class="pre">32768</span></code>.</p>
<p>Astropy recognizes and applies this convention by default, so that all data
that looks like it should be interpreted as unsigned integers is automatically
converted (this applies to both images and tables).  In Astropy versions prior
to v1.1.0 this was <em>not</em> applied automatically, and it is necessary to pass the
argument <code class="docutils literal"><span class="pre">uint=True</span></code> to <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal"><span class="pre">open()</span></code></a>.  In v1.1.0 or later this is the
default.</p>
<p>Even with <code class="docutils literal"><span class="pre">uint=False</span></code>, the <code class="docutils literal"><span class="pre">BZERO</span></code> shift is still applied, but the
returned array is of &#8220;float64&#8221; type.  To disable scaling/shifting entirely, use
<code class="docutils literal"><span class="pre">do_not_scale_image_data=True</span></code> (see <a class="reference internal" href="appendix/faq.html#fits-scaled-data-faq"><span>Why is an image containing integer data being converted unexpectedly to floats?</span></a> in the FAQ
for more details).</p>
</div>
<div class="section" id="working-with-compressed-files">
<h5>Working with compressed files<a class="headerlink" href="#working-with-compressed-files" title="Permalink to this headline">¶</a></h5>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal"><span class="pre">open()</span></code></a> function will seamlessly open FITS files that have been
compressed with gzip, bzip2 or pkzip. Note that in this context we&#8217;re talking
about a fits file that has been compressed with one of these utilities - e.g. a
.fits.gz file. Files that use compressed HDUs within the FITS file are discussed
in <a class="reference internal" href="usage/unfamiliar.html#astropy-io-fits-compressedimagedata"><span>Compressed Image Data</span></a>.</p>
<p>There are some limitations with working with compressed files. For example with Zip
files that contain multiple compressed files, only the first file will be accessible.
Also bzip does not support the append or update access modes.</p>
<p>When writing a file (e.g. with the <a class="reference internal" href="api/files.html#astropy.io.fits.writeto" title="astropy.io.fits.writeto"><code class="xref py py-func docutils literal"><span class="pre">writeto()</span></code></a> function), compression will be
determined based on the filename extension given, or the compression used in a
pre-existing file that is being written to.</p>
</div>
</div>
<div class="section" id="working-with-fits-headers">
<h4>Working with FITS Headers<a class="headerlink" href="#working-with-fits-headers" title="Permalink to this headline">¶</a></h4>
<p>As mentioned earlier, each element of an <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal"><span class="pre">HDUList</span></code></a> is an HDU object with
<code class="docutils literal"><span class="pre">.header</span></code> and <code class="docutils literal"><span class="pre">.data</span></code> attributes, which can be used to access the header
and data portions of the HDU.</p>
<p>For those unfamiliar with FITS headers, they consist of a list of 80 byte
&#8220;cards&#8221;, where a card contains a keyword, a value, and a comment.  The keyword
and comment must both be strings, whereas the value can be a string or an
integer, floating point number, complex number, or <a class="reference external" href="http://docs.python.org/3/library/constants.html#True" title="(in Python v3.5)"><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></a>/<a class="reference external" href="http://docs.python.org/3/library/constants.html#False" title="(in Python v3.5)"><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></a>.  Keywords
are usually unique within a header, except in a few special cases.</p>
<p>The header attribute is a Header instance, another Astropy object. To get the
value associated with a header keyword, simply do (a la Python dicts):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span>
<span class="go">&#39;NGC121&#39;</span>
</pre></div>
</div>
<p>to get the value of the keyword targname, which is a string &#8216;NGC121&#8217;.</p>
<p>Although keyword names are always in upper case inside the FITS file,
specifying a keyword name with Astropy is case-insensitive, for the user&#8217;s
convenience. If the specified keyword name does not exist, it will raise a
<a class="reference external" href="http://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.5)"><code class="xref py py-obj docutils literal"><span class="pre">KeyError</span></code></a> exception.</p>
<p>We can also get the keyword value by indexing (a la Python lists):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span>
<span class="go">96</span>
</pre></div>
</div>
<p>This example returns the 28th (like Python lists, it is 0-indexed) keyword&#8217;s
value&#8211;an integer&#8211;96.</p>
<p>Similarly, it is easy to update a keyword&#8217;s value in Astropy, either through
keyword name or index:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;NGC121-a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
</pre></div>
</div>
<p>Please note however that almost all application code should update header
values via their keyword name and not via their positional index.  This is
because most FITS keywords may appear at any position in the header.</p>
<p>It is also possible to update both the value and comment associated with a
keyword by assigning them as a tuple:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;NGC121-a&#39;</span><span class="p">,</span> <span class="s">&#39;the observation target&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span>
<span class="go">&#39;NGC121-a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="o">.</span><span class="n">comments</span><span class="p">[</span><span class="s">&#39;targname&#39;</span><span class="p">]</span>
<span class="go">&#39;the observation target&#39;</span>
</pre></div>
</div>
<p>Like a dict, one may also use the above syntax to add a new keyword/value pair
(and optionally a comment as well).  In this case the new card is appended to
the end of the header (unless it&#8217;s a commentary keyword such as COMMENT or
HISTORY, in which case it is appended after the last card with that keyword).</p>
<p>Another way to either update an existing card or append a new one is to use the
<a class="reference internal" href="api/headers.html#astropy.io.fits.Header.set" title="astropy.io.fits.Header.set"><code class="xref py py-meth docutils literal"><span class="pre">Header.set()</span></code></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;observer&#39;</span><span class="p">,</span> <span class="s">&#39;Edwin Hubble&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Comment or history records are added like normal cards, though in their case a
new card is always created, rather than updating an existing HISTORY or COMMENT
card:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;history&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;I updated this file 2/26/09&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Edwin Hubble really knew his stuff&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;I like using HST observations&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;history&#39;</span><span class="p">]</span>
<span class="go">I updated this file 2/26/09</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span>
<span class="go">Edwin Hubble really knew his stuff</span>
<span class="go">I like using HST observations</span>
</pre></div>
</div>
<p>Note: Be careful not to confuse COMMENT cards with the comment value for normal
cards.</p>
<p>To update existing COMMENT or HISTORY cards, reference them by index:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;history&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;I updated this file on 2/27/09&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;history&#39;</span><span class="p">]</span>
<span class="go">I updated this file on 2/27/09</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;I like using JWST observations&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span>
<span class="go">Edwin Hubble really knew his stuff</span>
<span class="go">I like using JWST observations</span>
</pre></div>
</div>
<p>To see the entire header as it appears in the FITS file (with the END card and
padding stripped), simply enter the header object by itself, or
<code class="docutils literal"><span class="pre">print(repr(header))</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">header</span>
<span class="go">SIMPLE  =                    T / file does conform to FITS standard</span>
<span class="go">BITPIX  =                   16 / number of bits per data pixel</span>
<span class="go">NAXIS   =                    0 / number of data axes</span>
<span class="go">all cards are shown...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">header</span><span class="p">))</span>
<span class="gp">... </span><span class="n">identical</span> <span class="o">...</span>
</pre></div>
</div>
<p>Entering simply <code class="docutils literal"><span class="pre">print(header)</span></code> will also work, but may not be very legible
on most displays, as this displays the header as it is written in the FITS file
itself, which means there are no linebreaks between cards.  This is a common
source of confusion for new users.</p>
<p>It&#8217;s also possible to view a slice of the header:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">header</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">SIMPLE  =                    T / file does conform to FITS standard</span>
<span class="go">BITPIX  =                   16 / number of bits per data pixel</span>
</pre></div>
</div>
<p>Only the first two cards are shown above.</p>
<p>To get a list of all keywords, use the <a class="reference internal" href="api/headers.html#astropy.io.fits.Header.keys" title="astropy.io.fits.Header.keys"><code class="xref py py-meth docutils literal"><span class="pre">Header.keys()</span></code></a> method just as you
would with a dict:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;SIMPLE&#39;, &#39;BITPIX&#39;, &#39;NAXIS&#39;, ...]</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Examples:</p>
<p>See also <span class="xref std std-ref">sphx_glr_generated_examples_io_modify-fits-header.py</span>.</p>
</div>
</div>
<div class="section" id="working-with-image-data">
<h4>Working with Image Data<a class="headerlink" href="#working-with-image-data" title="Permalink to this headline">¶</a></h4>
<p>If an HDU&#8217;s data is an image, the data attribute of the HDU object will return
a numpy <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.11)"><code class="xref py py-obj docutils literal"><span class="pre">ndarray</span></code></a> object. Refer to the numpy documentation for details
on manipulating these numerical arrays.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>Here, scidata points to the data object in the second HDU (the first HDU,
<code class="docutils literal"><span class="pre">hdulist[0]</span></code>, being the primary HDU) which corresponds to the &#8216;SCI&#8217;
extension. Alternatively, you can access the extension by its extension name
(specified in the EXTNAME keyword):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="s">&#39;SCI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>If there is more than one extension with the same EXTNAME, the EXTVER value
needs to be specified along with the EXTNAME as a tuple; e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="s">&#39;sci&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>Note that the EXTNAME is also case-insensitive.</p>
<p>The returned numpy object has many attributes and methods for a user to get
information about the array, e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(800, 800)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;float32&#39;</span>
</pre></div>
</div>
<p>Since image data is a numpy object, we can slice it, view it, and perform
mathematical operations on it. To see the pixel value at x=5, y=2:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">scidata</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<p>Note that, like C (and unlike FORTRAN), Python is 0-indexed and the indices
have the slowest axis first and fastest changing axis last; i.e. for a 2-D
image, the fast axis (X-axis) which corresponds to the FITS NAXIS1 keyword, is
the second index. Similarly, the 1-indexed sub-section of x=11 to 20
(inclusive) and y=31 to 40 (inclusive) would be given in Python as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
<p>To update the value of a pixel or a sub-section:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">scidata</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">999</span>
</pre></div>
</div>
<p>This example changes the values of both the pixel [1, 4] and the sub-section
[30:40, 10:20] to the new value of 999.  See the <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">Numpy documentation</a> for
more details on Python-style array indexing and slicing.</p>
<p>The next example of array manipulation is to convert the image data from counts
to flux:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">photflam</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s">&#39;photflam&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exptime</span> <span class="o">=</span> <span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;exptime&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scidata</span> <span class="o">*=</span> <span class="n">photflam</span> <span class="o">/</span> <span class="n">exptime</span>
</pre></div>
</div>
<p>Note that performing an operation like this on an entire image requires holding
the entire image in memory.  This example performs the multiplication in-place
so that no copies are made, but the original image must first be able to fit in
main memory.  For most observations this should not be an issue on modern
personal computers.</p>
<p>If at this point you want to preserve all the changes you made and write it to
a new file, you can use the <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.writeto" title="astropy.io.fits.HDUList.writeto"><code class="xref py py-meth docutils literal"><span class="pre">HDUList.writeto()</span></code></a> method (see below).</p>
<div class="topic">
<p class="topic-title first">Examples:</p>
<p>See also <span class="xref std std-ref">sphx_glr_generated_examples_io_plot_fits-image.py</span>.</p>
</div>
</div>
<div class="section" id="working-with-table-data">
<h4>Working With Table Data<a class="headerlink" href="#working-with-table-data" title="Permalink to this headline">¶</a></h4>
<p>This section describes reading and writing table data in the FITS format using
the <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal"><span class="pre">fits</span></code></a> package directly.  For simple cases, however, the
high-level <a class="reference internal" href="../unified.html#table-io"><span>Unified file read/write interface</span></a> will often suffice and is somewhat easier to use.
See the <a class="reference internal" href="../unified.html#table-io-fits"><span>Unified I/O FITS</span></a> section for details.</p>
<p>Like images, the data portion of a FITS table extension is in the <code class="docutils literal"><span class="pre">.data</span></code>
attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;table.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="c"># assuming the first extension is a table</span>
</pre></div>
</div>
<p>If you are familiar with numpy <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.11)"><code class="xref py py-obj docutils literal"><span class="pre">recarray</span></code></a> (record array) objects, you
will find the table data is basically a record array with some extra
properties. But familiarity with record arrays is not a prerequisite for this
guide.</p>
<p>To see the first row of the table:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">tbdata</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(1, &#39;abc&#39;, 3.7000002861022949, 0)</span>
</pre></div>
</div>
<p>Each row in the table is a <a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_record" title="astropy.io.fits.FITS_record"><code class="xref py py-class docutils literal"><span class="pre">FITS_record</span></code></a> object which looks like a
(Python) tuple containing elements of heterogeneous data types. In this
example: an integer, a string, a floating point number, and a Boolean value. So
the table data are just an array of such records. More commonly, a user is
likely to access the data in a column-wise way. This is accomplished by using
the <a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_rec.field" title="astropy.io.fits.FITS_rec.field"><code class="xref py py-meth docutils literal"><span class="pre">field()</span></code></a> method. To get the first column (or &#8220;field&#8221; in
Numpy parlance&#8211;it is used here interchangeably with &#8220;column&#8221;) of the table,
use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([1, 2])</span>
</pre></div>
</div>
<p>A numpy object with the data type of the specified field is returned.</p>
<p>Like header keywords, a column can be referred either by index, as above, or by
name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span>
<span class="go">array([1, 2])</span>
</pre></div>
</div>
<p>When accessing a column by name, dict-like access is also possible (and even
preferable):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span>
<span class="go">array([1, 2])</span>
</pre></div>
</div>
<p>In most cases it is preferable to access columns by their name, as the column
name is entirely independent of its physical order in the table.  As with
header keywords, column names are case-insensitive.</p>
<p>But how do we know what columns we have in a table? First, let&#8217;s introduce
another attribute of the table HDU: the <a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU.columns" title="astropy.io.fits.BinTableHDU.columns"><code class="xref py py-attr docutils literal"><span class="pre">columns</span></code></a>
attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<p>This attribute is a <a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs" title="astropy.io.fits.ColDefs"><code class="xref py py-class docutils literal"><span class="pre">ColDefs</span></code></a> (column definitions) object. If we use the
<a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs.info" title="astropy.io.fits.ColDefs.info"><code class="xref py py-meth docutils literal"><span class="pre">ColDefs.info()</span></code></a> method from the interactive prompt:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go"> name:</span>
<span class="go">      [&#39;c1&#39;, &#39;c2&#39;, &#39;c3&#39;, &#39;c4&#39;]</span>
<span class="go"> format:</span>
<span class="go">      [&#39;1J&#39;, &#39;3A&#39;, &#39;1E&#39;, &#39;1L&#39;]</span>
<span class="go"> unit:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go"> null:</span>
<span class="go">      [-2147483647, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go"> bscale:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, 3, &#39;&#39;]</span>
<span class="go"> bzero:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, 0.40000000000000002, &#39;&#39;]</span>
<span class="go"> disp:</span>
<span class="go">      [&#39;I11&#39;, &#39;A3&#39;, &#39;G15.7&#39;, &#39;L6&#39;]</span>
<span class="go"> start:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go"> dim:</span>
<span class="go">      [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
</pre></div>
</div>
<p>it will show the attributes of all columns in the table, such as their names,
formats, bscales, bzeros, etc. A similar output that will display the column
names and their formats can be printed from within a script with:</p>
<div class="highlight-python"><div class="highlight"><pre>print hdulist[1].columns
</pre></div>
</div>
<p>We can also get these properties individually;
e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span><span class="o">.</span><span class="n">names</span>
<span class="go">[&#39;ID&#39;, &#39;name&#39;, &#39;mag&#39;, &#39;flag&#39;]</span>
</pre></div>
</div>
<p>returns a (Python) list of field names.</p>
<p>Since each field is a Numpy object, we&#8217;ll have the entire arsenal of Numpy
tools to use. We can reassign (update) the values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span><span class="p">[</span><span class="s">&#39;flag&#39;</span><span class="p">][:]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>take the mean of a column:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbdata</span><span class="p">[</span><span class="s">&#39;mag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">84.4</span>
</pre></div>
</div>
<p>and so on.</p>
<div class="topic">
<p class="topic-title first">Examples:</p>
<p>See also <span class="xref std std-ref">sphx_glr_generated_examples_io_fits-tables.py</span>.</p>
</div>
</div>
<div class="section" id="save-file-changes">
<h4>Save File Changes<a class="headerlink" href="#save-file-changes" title="Permalink to this headline">¶</a></h4>
<p>As mentioned earlier, after a user opened a file, made a few changes to either
header or data, the user can use <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.writeto" title="astropy.io.fits.HDUList.writeto"><code class="xref py py-meth docutils literal"><span class="pre">HDUList.writeto()</span></code></a> to save the changes.
This takes the version of headers and data in memory and writes them to a new
FITS file on disk. Subsequent operations can be performed to the data in memory
and written out to yet another different file, all without recopying the
original data to (more) memory.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;newimage.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>will write the current content of <code class="docutils literal"><span class="pre">hdulist</span></code> to a new disk file newfile.fits.
If a file was opened with the update mode, the <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.flush" title="astropy.io.fits.HDUList.flush"><code class="xref py py-meth docutils literal"><span class="pre">HDUList.flush()</span></code></a> method can
also be used to write all the changes made since <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal"><span class="pre">open()</span></code></a>, back to the
original file. The <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.close" title="astropy.io.fits.HDUList.close"><code class="xref py py-meth docutils literal"><span class="pre">close()</span></code></a> method will do the same for a FITS
file opened with update mode:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;original.fits&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;update&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="c"># making changes in data and/or header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>  <span class="c"># changes are written back to original.fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c"># closing the file will also flush any changes and prevent</span>
<span class="gp">... </span>           <span class="c"># further writing</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-a-new-fits-file">
<h3>Creating a New FITS File<a class="headerlink" href="#creating-a-new-fits-file" title="Permalink to this headline">¶</a></h3>
<div class="section" id="creating-a-new-image-file">
<h4>Creating a New Image File<a class="headerlink" href="#creating-a-new-image-file" title="Permalink to this headline">¶</a></h4>
<p>So far we have demonstrated how to read and update an existing FITS file. But
how about creating a new FITS file from scratch? Such tasks are very easy in
Astropy for an image HDU. We&#8217;ll first demonstrate how to create a FITS file
consisting only the primary HDU with image data.</p>
<p>First, we create a numpy object for the data part:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span> <span class="c"># a simple sequence of floats from 0.0 to 99.9</span>
</pre></div>
</div>
<p>Next, we create a <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal"><span class="pre">PrimaryHDU</span></code></a> object to encapsulate the data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>We then create a HDUList to contain the newly created primary HDU, and write to
a new file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">hdu</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;new.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>That&#8217;s it! In fact, Astropy even provides a shortcut for the last two lines to
accomplish the same behavior:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;new.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will write a single HDU to a FITS file without having to manually
encapsulate it in an <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal"><span class="pre">HDUList</span></code></a> object first.</p>
</div>
<div class="section" id="creating-a-new-table-file">
<h4>Creating a New Table File<a class="headerlink" href="#creating-a-new-table-file" title="Permalink to this headline">¶</a></h4>
<p>To create a table HDU is a little more involved than image HDU, because a
table&#8217;s structure needs more information. First of all, tables can only be an
extension HDU, not a primary. There are two kinds of FITS table extensions:
ASCII and binary. We&#8217;ll use binary table examples here.</p>
<p>To create a table from scratch, we need to define columns first, by
constructing the <a class="reference internal" href="api/tables.html#astropy.io.fits.Column" title="astropy.io.fits.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> objects and their data. Suppose we have two
columns, the first containing strings, and the second containing floating point
numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;NGC1001&#39;</span><span class="p">,</span> <span class="s">&#39;NGC1002&#39;</span><span class="p">,</span> <span class="s">&#39;NGC1003&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">11.1</span><span class="p">,</span> <span class="mf">12.3</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;target&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;20A&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;V_mag&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a2</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, create a <a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs" title="astropy.io.fits.ColDefs"><code class="xref py py-class docutils literal"><span class="pre">ColDefs</span></code></a> (column-definitions) object for all columns:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">])</span>
</pre></div>
</div>
<p>Now, create a new binary table HDU object by using the
<a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU.from_columns" title="astropy.io.fits.BinTableHDU.from_columns"><code class="xref py py-func docutils literal"><span class="pre">BinTableHDU.from_columns()</span></code></a> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbhdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</pre></div>
</div>
<p>This function returns (in this case) a <a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU" title="astropy.io.fits.BinTableHDU"><code class="xref py py-class docutils literal"><span class="pre">BinTableHDU</span></code></a>.</p>
<p>Of course, you can do this more concisely without creating intermediate
variables for the individual columns and without manually creating a
<a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs" title="astropy.io.fits.ColDefs"><code class="xref py py-class docutils literal"><span class="pre">ColDefs</span></code></a> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tbhdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;target&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;20A&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a1</span><span class="p">),</span>
<span class="gp">... </span>     <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;V_mag&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;E&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a2</span><span class="p">)])</span>
</pre></div>
</div>
<p>Now you may write this new table HDU directly to a FITS file like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tbhdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;table.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This shortcut will automatically create a minimal primary HDU with no data and
prepend it to the table HDU to create a valid FITS file.  If you require
additional data or header keywords in the primary HDU you may still create a
<a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal"><span class="pre">PrimaryHDU</span></code></a> object and build up the FITS file manually using an
<a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal"><span class="pre">HDUList</span></code></a>.</p>
<p>For example, first create a new <a class="reference internal" href="api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-class docutils literal"><span class="pre">Header</span></code></a> object to encapsulate any
keywords you want to include in the primary HDU, then as before create a
<a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal"><span class="pre">PrimaryHDU</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Header</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;OBSERVER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Edwin Hubble&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdr</span><span class="p">[</span><span class="s">&#39;COMMENT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Here&#39;s some commentary about this FITS file.&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prihdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">prihdr</span><span class="p">)</span>
</pre></div>
</div>
<p>When we create a new primary HDU with a custom header as in the above example,
this will automatically include any additional header keywords that are
<em>required</em> by the FITS format (keywords such as <code class="docutils literal"><span class="pre">SIMPLE</span></code> and <code class="docutils literal"><span class="pre">NAXIS</span></code> for
example).  In general, users should not have to manually manage such keywords,
and should only create and modify observation-specific informational keywords.</p>
<p>We then create a HDUList containing both the primary HDU and the newly created
table extension, and write to a new file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">thdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">prihdu</span><span class="p">,</span> <span class="n">tbhdu</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thdulist</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;table.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, we can append the table to the HDU list we already created in
the image file section:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tbhdu</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;image_and_table.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The data structure used to represent FITS tables is called a <a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_rec" title="astropy.io.fits.FITS_rec"><code class="xref py py-class docutils literal"><span class="pre">FITS_rec</span></code></a>
and is derived from the <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.11)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a> interface.  When creating
a new table HDU the individual column arrays will be assembled into a single
<a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_rec" title="astropy.io.fits.FITS_rec"><code class="xref py py-class docutils literal"><span class="pre">FITS_rec</span></code></a> array.</p>
<p>So far, we have covered the most basic features of <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits</span></code></a>. In the
following chapters we&#8217;ll show more advanced examples and explain options in
each class and method.</p>
<div class="topic">
<p class="topic-title first">Examples:</p>
<p>See also <span class="xref std std-ref">sphx_glr_generated_examples_io_create-mef.py</span>.</p>
</div>
</div>
</div>
<div class="section" id="convenience-functions">
<h3>Convenience Functions<a class="headerlink" href="#convenience-functions" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits</span></code></a> also provides several high level (&#8220;convenience&#8221;) functions.
Such a convenience function is a &#8220;canned&#8221; operation to achieve one simple task.
By using these &#8220;convenience&#8221; functions, a user does not have to worry about
opening or closing a file, all the housekeeping is done implicitly.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">These functions are useful for interactive Python sessions and simple
analysis scripts, but should not be used for application code, as they
are highly inefficient.  For example, each call to <a class="reference internal" href="api/files.html#astropy.io.fits.getval" title="astropy.io.fits.getval"><code class="xref py py-func docutils literal"><span class="pre">getval()</span></code></a>
requires re-parsing the entire FITS file.  Code that makes repeated use
of these functions should instead open the file with <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal"><span class="pre">open()</span></code></a>
and access the data structures directly.</p>
</div>
<p>The first of these functions is <a class="reference internal" href="api/files.html#astropy.io.fits.getheader" title="astropy.io.fits.getheader"><code class="xref py py-func docutils literal"><span class="pre">getheader()</span></code></a>, to get the header of an HDU.
Here are several examples of getting the header. Only the file name is required
for this function. The rest of the arguments are optional and flexible to
specify which HDU the user wants to access:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getheader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">)</span>  <span class="c"># get default HDU (=0), i.e. primary HDU&#39;s header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c"># get primary HDU&#39;s header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c"># the second extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">)</span>  <span class="c"># the first HDU with EXTNAME=&#39;SCI&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c"># HDU with EXTNAME=&#39;SCI&#39; and EXTVER=2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c"># use a tuple to do the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c"># the second extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="n">extname</span><span class="o">=</span><span class="s">&#39;sci&#39;</span><span class="p">)</span>  <span class="c"># first HDU with EXTNAME=&#39;SCI&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="n">extname</span><span class="o">=</span><span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="n">extver</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Ambiguous specifications will raise an exception:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">extname</span><span class="o">=</span><span class="s">&#39;err&#39;</span><span class="p">,</span> <span class="n">extver</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">TypeError: Redundant/conflicting extension arguments(s): {&#39;ext&#39;: (&#39;sci&#39;,</span>
<span class="go">1), &#39;args&#39;: (), &#39;extver&#39;: 2, &#39;extname&#39;: &#39;err&#39;}</span>
</pre></div>
</div>
<p>After you get the header, you can access the information in it, such as getting
and modifying a keyword value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getheader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c"># get first extension&#39;s header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">filter</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s">&#39;filter&#39;</span><span class="p">]</span>         <span class="c"># get the value of the keyword &quot;filter&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>                  <span class="c"># get the 11th keyword&#39;s value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s">&#39;filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;FW555&#39;</span>        <span class="c"># change the keyword value</span>
</pre></div>
</div>
<p>For the header keywords, the header is like a dictionary, as well as a list.
The user can access the keywords either by name or by numeric index, as
explained earlier in this chapter.</p>
<p>If a user only needs to read one keyword, the  <a class="reference internal" href="api/files.html#astropy.io.fits.getval" title="astropy.io.fits.getval"><code class="xref py py-func docutils literal"><span class="pre">getval()</span></code></a> function can
further simplify to just one call, instead of two as shown in the above
examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flt</span> <span class="o">=</span> <span class="n">getval</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="s">&#39;filter&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c"># get 1st extension&#39;s keyword</span>
<span class="go">                                          # FILTER&#39;s value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">getval</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c"># get the 2nd sci extension&#39;s</span>
<span class="go">                                           # 11th keyword&#39;s value</span>
</pre></div>
</div>
<p>The function <a class="reference internal" href="api/files.html#astropy.io.fits.getdata" title="astropy.io.fits.getdata"><code class="xref py py-func docutils literal"><span class="pre">getdata()</span></code></a> gets the data of an HDU. Similar to
<a class="reference internal" href="api/files.html#astropy.io.fits.getheader" title="astropy.io.fits.getheader"><code class="xref py py-func docutils literal"><span class="pre">getheader()</span></code></a>, it only requires the input FITS file name while the
extension is specified through the optional arguments. It does have one extra
optional argument header. If header is set to True, this function will return
both data and header, otherwise only data is returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getdata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c"># get 3rd sci extension&#39;s data</span>
<span class="gp">... </span><span class="c"># get 1st extension&#39;s data and header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="s">&#39;in.fits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The functions introduced above are for reading. The next few functions
demonstrate convenience functions for writing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s">&#39;out.fits&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.writeto" title="astropy.io.fits.writeto"><code class="xref py py-func docutils literal"><span class="pre">writeto()</span></code></a> function uses the provided data and an optional header to
write to an output FITS file.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;out.fits&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.append" title="astropy.io.fits.append"><code class="xref py py-func docutils literal"><span class="pre">append()</span></code></a> function will use the provided data and the optional header
to append to an existing FITS file. If the specified output file does not
exist, it will create one.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">update</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">hdr</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">)</span>  <span class="c"># update the &#39;sci&#39; extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>           <span class="c"># update the 3rd extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">hdr</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>      <span class="c"># update the 3rd extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="s">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c"># update the 2nd SCI extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">hdr</span><span class="p">)</span>      <span class="c"># update the 3rd extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">hdr</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c"># update the 5th extension</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.update" title="astropy.io.fits.update"><code class="xref py py-func docutils literal"><span class="pre">update()</span></code></a> function will update the specified extension with the input
data/header. The 3rd argument can be the header associated with the data. If
the 3rd argument is not a header, it (and other positional arguments) are
assumed to be the extension specification(s). Header and extension specs can
also be keyword arguments.</p>
<p>Finally, the <a class="reference internal" href="api/files.html#astropy.io.fits.info" title="astropy.io.fits.info"><code class="xref py py-func docutils literal"><span class="pre">info()</span></code></a> function will print out information of the specified
FITS file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;test0.fits&#39;</span><span class="p">)</span>
<span class="go">Filename: test0.fits</span>
<span class="go">No. Name    Type       Cards Dimensions Format</span>
<span class="go">0   PRIMARY PrimaryHDU   138 ()         Int16</span>
<span class="go">1   SCI     ImageHDU      61 (400, 400) Int16</span>
<span class="go">2   SCI     ImageHDU      61 (400, 400) Int16</span>
<span class="go">3   SCI     ImageHDU      61 (400, 400) Int16</span>
<span class="go">4   SCI     ImageHDU      61 (400, 400) Int16</span>
</pre></div>
</div>
<p>This is one of the most useful convenience functions for getting an overview of
what a given file contains without looking at any of the details.</p>
</div>
</div>
<div class="section" id="using-astropy-io-fits">
<h2>Using <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.fits</span></code></a><a class="headerlink" href="#using-astropy-io-fits" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage/headers.html">FITS Headers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#header-of-an-hdu">Header of an HDU</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#the-header-attribute">The Header Attribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#card-images">Card Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#continue-cards">CONTINUE Cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#hierarch-cards">HIERARCH Cards</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/image.html">Image Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/image.html#image-data-as-an-array">Image Data as an Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/image.html#scaled-data">Scaled Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/image.html#data-sections">Data Sections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/table.html">Table Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#table-data-as-a-record-array">Table Data as a Record Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#table-operations">Table Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#scaled-data-in-tables">Scaled Data in Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#creating-a-fits-table">Creating a FITS Table</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/verification.html">Verification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#fits-standard">FITS Standard</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#verification-options">Verification Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#verifications-at-different-data-object-levels">Verifications at Different Data Object Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#verification-using-the-fits-checksum-keyword-convention">Verification using the FITS Checksum Keyword Convention</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/unfamiliar.html">Less Familiar Objects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#ascii-tables">ASCII Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#variable-length-array-tables">Variable Length Array Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#random-access-groups">Random Access Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#compressed-image-data">Compressed Image Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/scripts.html">Executable Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#module-astropy.io.fits.scripts.fitsinfo">fitsinfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#module-astropy.io.fits.scripts.fitsheader">fitsheader</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#module-astropy.io.fits.scripts.fitscheck">fitscheck</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#fitsdiff">fitsdiff</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/misc.html">Miscellaneous Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/misc.html#differs">Differs</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="other-information">
<h2>Other Information<a class="headerlink" href="#other-information" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="appendix/faq.html">astropy.io.fits FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix/header_transition.html">Header Interface Transition Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix/history.html">astropy.io.fits History</a></li>
</ul>
</div>
</div>
<div class="section" id="module-astropy.io.fits">
<span id="reference-api"></span><h2>Reference/API<a class="headerlink" href="#module-astropy.io.fits" title="Permalink to this headline">¶</a></h2>
<p>A package for reading and writing FITS files and manipulating their
contents.</p>
<p>A module for reading and writing Flexible Image Transport System
(FITS) files.  This file format was endorsed by the International
Astronomical Union in 1999 and mandated by NASA as the standard format
for storing high energy astrophysics data.  For details of the FITS
standard, see the NASA/Science Office of Standards and Technology
publication, NOST 100-2.0.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/files.html">File Handling and Convenience Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#open"><code class="docutils literal"><span class="pre">open()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#writeto"><code class="docutils literal"><span class="pre">writeto()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#info"><code class="docutils literal"><span class="pre">info()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#append"><code class="docutils literal"><span class="pre">append()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#update"><code class="docutils literal"><span class="pre">update()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#getdata"><code class="docutils literal"><span class="pre">getdata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#getheader"><code class="docutils literal"><span class="pre">getheader()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#getval"><code class="docutils literal"><span class="pre">getval()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#setval"><code class="docutils literal"><span class="pre">setval()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#delval"><code class="docutils literal"><span class="pre">delval()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/hdulists.html">HDU Lists</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/hdulists.html#hdulist"><code class="docutils literal"><span class="pre">HDUList</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/hdus.html">Header Data Units</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#primaryhdu"><code class="docutils literal"><span class="pre">PrimaryHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#groupshdu"><code class="docutils literal"><span class="pre">GroupsHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#groupdata"><code class="docutils literal"><span class="pre">GroupData</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/hdus.html#group"><code class="docutils literal"><span class="pre">Group</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#streaminghdu"><code class="docutils literal"><span class="pre">StreamingHDU</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/headers.html">Headers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/headers.html#header"><code class="docutils literal"><span class="pre">Header</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/cards.html">Cards</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/cards.html#card"><code class="docutils literal"><span class="pre">Card</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/cards.html#deprecated-interfaces">Deprecated Interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/tables.html">Tables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#bintablehdu"><code class="docutils literal"><span class="pre">BinTableHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#tablehdu"><code class="docutils literal"><span class="pre">TableHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#column"><code class="docutils literal"><span class="pre">Column</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#coldefs"><code class="docutils literal"><span class="pre">ColDefs</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#fits-rec"><code class="docutils literal"><span class="pre">FITS_rec</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#fits-record"><code class="docutils literal"><span class="pre">FITS_record</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#table-functions">Table Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#new-table"><code class="docutils literal"><span class="pre">new_table()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#tabledump"><code class="docutils literal"><span class="pre">tabledump()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#tableload"><code class="docutils literal"><span class="pre">tableload()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#table-to-hdu"><code class="docutils literal"><span class="pre">table_to_hdu()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/images.html">Images</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/images.html#imagehdu"><code class="docutils literal"><span class="pre">ImageHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/images.html#compimagehdu"><code class="docutils literal"><span class="pre">CompImageHDU</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/images.html#section"><code class="docutils literal"><span class="pre">Section</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/diff.html">Differs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#fitsdiff"><code class="docutils literal"><span class="pre">FITSDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#hdudiff"><code class="docutils literal"><span class="pre">HDUDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#headerdiff"><code class="docutils literal"><span class="pre">HeaderDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#imagedatadiff"><code class="docutils literal"><span class="pre">ImageDataDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#rawdatadiff"><code class="docutils literal"><span class="pre">RawDataDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#tabledatadiff"><code class="docutils literal"><span class="pre">TableDataDiff</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/verification.html">Verification options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#exception">exception</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#ignore">ignore</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#fix">fix</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#silentfix">silentfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#warn">warn</a></li>
</ul>
</li>
</ul>
</div>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="f1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>For legacy code only that already depends on PyFITS, it&#8217;s acceptable to continue using &#8220;from astropy.io import fits as pyfits&#8221;.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">FITS File handling (<code class="docutils literal"><span class="pre">astropy.io.fits</span></code>)</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li><a class="reference internal" href="#reading-and-updating-existing-fits-files">Reading and Updating Existing FITS Files</a><ul>
<li><a class="reference internal" href="#opening-a-fits-file">Opening a FITS file</a><ul>
<li><a class="reference internal" href="#working-with-large-files">Working with large files</a></li>
<li><a class="reference internal" href="#unsigned-integers">Unsigned integers</a></li>
<li><a class="reference internal" href="#working-with-compressed-files">Working with compressed files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-fits-headers">Working with FITS Headers</a></li>
<li><a class="reference internal" href="#working-with-image-data">Working with Image Data</a></li>
<li><a class="reference internal" href="#working-with-table-data">Working With Table Data</a></li>
<li><a class="reference internal" href="#save-file-changes">Save File Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-new-fits-file">Creating a New FITS File</a><ul>
<li><a class="reference internal" href="#creating-a-new-image-file">Creating a New Image File</a></li>
<li><a class="reference internal" href="#creating-a-new-table-file">Creating a New Table File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#convenience-functions">Convenience Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-astropy-io-fits">Using <code class="docutils literal"><span class="pre">astropy.io.fits</span></code></a></li>
<li><a class="reference internal" href="#other-information">Other Information</a></li>
<li><a class="reference internal" href="#module-astropy.io.fits">Reference/API</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/master/docs/io/fits/index.rst">Edit This Page on Github</a> &nbsp;
    <a href="../../_sources/io/fits/index.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1. &nbsp;
    Last built 10 Jun 2016. <br/>
  </p>
</footer>
  </body>
</html>