<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>I/O Registry (astropy.io.registry) &mdash; Astropy v1.2.dev14979</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.dev14979',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev14979" href="../index.html" />
    <link rel="next" title="register_reader" href="../api/astropy.io.registry.register_reader.html" />
    <link rel="prev" title="set_temp_config" href="../api/astropy.config.set_temp_config.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../api/astropy.io.registry.register_reader.html" title="register_reader">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../api/astropy.config.set_temp_config.html" title="set_temp_config">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v1.2.dev14979</a>
	 &raquo;
      </li>
      
      <li>I/O Registry (<code class="docutils literal"><span class="pre">astropy.io.registry</span></code>)</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="i-o-registry-astropy-io-registry">
<span id="io-registry"></span><h1>I/O Registry (<a class="reference internal" href="#module-astropy.io.registry" title="astropy.io.registry"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.registry</span></code></a>)<a class="headerlink" href="#i-o-registry-astropy-io-registry" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The I/O registry is only meant to be used directly by users who want
to define their own custom readers/writers. Users who want to find
out more about what built-in formats are supported by
<a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> by default should see
<a class="reference internal" href="unified.html#table-io"><span class="std std-ref">Unified file read/write interface</span></a>. No built-in formats are currently defined for
<a class="reference internal" href="../api/astropy.nddata.NDData.html#astropy.nddata.NDData" title="astropy.nddata.NDData"><code class="xref py py-class docutils literal"><span class="pre">NDData</span></code></a>, but this will be added in
future).</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The I/O registry is a sub-module used to define the readers/writers available
for the <a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> and
<a class="reference internal" href="../api/astropy.nddata.NDData.html#astropy.nddata.NDData" title="astropy.nddata.NDData"><code class="xref py py-class docutils literal"><span class="pre">NDData</span></code></a> classes.</p>
</div>
<div class="section" id="using-astropy-io-registry">
<h2>Using <a class="reference internal" href="#module-astropy.io.registry" title="astropy.io.registry"><code class="xref py py-obj docutils literal"><span class="pre">astropy.io.registry</span></code></a><a class="headerlink" href="#using-astropy-io-registry" title="Permalink to this headline">¶</a></h2>
<p>This section demonstrates how to create a custom reader/writer. A reader is
written as a function that can take any arguments except <code class="docutils literal"><span class="pre">format</span></code> (which is
needed when manually specifying the format - see below) and returns an
instance of the <a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> or
<a class="reference internal" href="../api/astropy.nddata.NDData.html#astropy.nddata.NDData" title="astropy.nddata.NDData"><code class="xref py py-class docutils literal"><span class="pre">NDData</span></code></a> classes (or sub-classes). For demonstration,
let&#8217;s assume that we are trying to write a reader/writer for the
<a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> class:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">astropy.table</span> <span class="k">import</span> <span class="n">Table</span>

<span class="k">def</span> <span class="nf">my_table_reader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">some_option</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c"># Read in the table by any means necessary</span>
    <span class="k">return</span> <span class="n">table</span>  <span class="c"># should be an instance of Table</span>
</pre></div>
</div>
<p>Such a function can then be registered with the I/O registry:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">registry</span>
<span class="n">registry</span><span class="o">.</span><span class="n">register_reader</span><span class="p">(</span><span class="s">&#39;my-table-format&#39;</span><span class="p">,</span> <span class="n">Table</span><span class="p">,</span> <span class="n">my_table_reader</span><span class="p">)</span>
</pre></div>
</div>
<p>where the first argument is the name of the format, the second argument is the
class that the function returns an instance for, and the third argument is the
reader itself.</p>
<p>We can then read in a table with:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">d</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;my_table_file.mtf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">&#39;my-table-format&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In practice, it would be nice to have the <code class="docutils literal"><span class="pre">read</span></code> method automatically
identify that this file is in the <code class="docutils literal"><span class="pre">my-table-format</span></code> format, so we can
construct a function that can recognize these files, which we refer to here as
an <em>identifier</em> function.</p>
<p>An identifier function should take a first argument that is a string
which indicates whether the identifier is being called from <code class="docutils literal"><span class="pre">read</span></code> or
<code class="docutils literal"><span class="pre">write</span></code>, and should then accept arbitrary number of positional and keyword
arguments via <code class="docutils literal"><span class="pre">*args</span></code> and <code class="docutils literal"><span class="pre">**kwargs</span></code>, which are the arguments passed to
the <code class="docutils literal"><span class="pre">read</span></code> method.</p>
<p>In the above case, we can write a simplistic function that only looks at
filenames (but in practice, this function could even look at the first few
bytes of the file for example). The only requirement for the identifier
function is that it return a boolean indicating whether the input matches that
expected for the format. In our example, we want to automatically recognize
files with filenames ending in <code class="docutils literal"><span class="pre">.mtf</span></code> as being in the <code class="docutils literal"><span class="pre">my-table-format</span></code>
format:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">astropy.extern</span> <span class="k">import</span> <span class="n">six</span>

<span class="k">def</span> <span class="nf">identify_mtf</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">)</span> <span class="ow">and</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;.mtf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Identifier functions should be prepared for arbitrary input - in
particular, the first argument may not be a filename or file
object, so it should not assume that this is the case.</p>
</div>
<p>We then register this identifier function, similarly to the reader function:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">registry</span><span class="o">.</span><span class="n">register_identifier</span><span class="p">(</span><span class="s">&#39;my-table-format&#39;</span><span class="p">,</span> <span class="n">Table</span><span class="p">,</span> <span class="n">identify_mtf</span><span class="p">)</span>
</pre></div>
</div>
<p>Having registered this function, we can then do:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;catalog.mtf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If multiple formats match the current input, then an exception is
raised, and similarly if no format matches the current input. In that
case, the format should be explicitly given with the <code class="docutils literal"><span class="pre">format=</span></code>
keyword argument.</p>
<p>It is also possible to create custom writers. To go with our custom reader
above, we can write a custom writer:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_table_writer</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">clobber</span><span class="o">=</span><span class="k">False</span><span class="p">):</span>
    <span class="o">...</span>  <span class="c"># Write the table out to a file</span>
</pre></div>
</div>
<p>Writer functons should take a dataset object (either an instance of the
<a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> or <a class="reference internal" href="../api/astropy.nddata.NDData.html#astropy.nddata.NDData" title="astropy.nddata.NDData"><code class="xref py py-class docutils literal"><span class="pre">NDData</span></code></a>
classes or sub-classes), and any number of subsequent positional and keyword
arguments - although as for the reader, the <code class="docutils literal"><span class="pre">format</span></code> keyword argument cannot
be used.</p>
<p>We then register the writer:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">registry</span><span class="o">.</span><span class="n">register_writer</span><span class="p">(</span><span class="s">&#39;my-custom-format&#39;</span><span class="p">,</span> <span class="n">Table</span><span class="p">,</span> <span class="n">my_table_writer</span><span class="p">)</span>
</pre></div>
</div>
<p>We can write the table out to a file:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;catalog_new.mtf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">&#39;my-table-format&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Since we have already registered the identifier function, we can also simply
do:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;catalog_new.mtf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reference-api">
<h2>Reference/API<a class="headerlink" href="#reference-api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-astropy.io.registry">
<span id="astropy-io-registry-module"></span><h3>astropy.io.registry Module<a class="headerlink" href="#module-astropy.io.registry" title="Permalink to this headline">¶</a></h3>
<div class="section" id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h4>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.io.registry.register_reader.html#astropy.io.registry.register_reader" title="astropy.io.registry.register_reader"><code class="xref py py-obj docutils literal"><span class="pre">register_reader</span></code></a>(data_format,&nbsp;data_class,&nbsp;...)</td>
<td>Register a reader function.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/astropy.io.registry.register_writer.html#astropy.io.registry.register_writer" title="astropy.io.registry.register_writer"><code class="xref py py-obj docutils literal"><span class="pre">register_writer</span></code></a>(data_format,&nbsp;data_class,&nbsp;...)</td>
<td>Register a table writer function.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.io.registry.register_identifier.html#astropy.io.registry.register_identifier" title="astropy.io.registry.register_identifier"><code class="xref py py-obj docutils literal"><span class="pre">register_identifier</span></code></a>(data_format,&nbsp;data_class,&nbsp;...)</td>
<td>Associate an identifier function with a specific data type.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/astropy.io.registry.identify_format.html#astropy.io.registry.identify_format" title="astropy.io.registry.identify_format"><code class="xref py py-obj docutils literal"><span class="pre">identify_format</span></code></a>(origin,&nbsp;data_class_required,&nbsp;...)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.io.registry.get_reader.html#astropy.io.registry.get_reader" title="astropy.io.registry.get_reader"><code class="xref py py-obj docutils literal"><span class="pre">get_reader</span></code></a>(data_format,&nbsp;data_class)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/astropy.io.registry.get_writer.html#astropy.io.registry.get_writer" title="astropy.io.registry.get_writer"><code class="xref py py-obj docutils literal"><span class="pre">get_writer</span></code></a>(data_format,&nbsp;data_class)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.io.registry.read.html#astropy.io.registry.read" title="astropy.io.registry.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(cls,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Read in data</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../api/astropy.io.registry.write.html#astropy.io.registry.write" title="astropy.io.registry.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a>(data,&nbsp;*args,&nbsp;**kwargs)</td>
<td>Write out data</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../api/astropy.io.registry.get_formats.html#astropy.io.registry.get_formats" title="astropy.io.registry.get_formats"><code class="xref py py-obj docutils literal"><span class="pre">get_formats</span></code></a>([data_class])</td>
<td>Get the list of registered I/O formats as a Table.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">I/O Registry (<code class="docutils literal"><span class="pre">astropy.io.registry</span></code>)</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#using-astropy-io-registry">Using <code class="docutils literal"><span class="pre">astropy.io.registry</span></code></a></li>
<li><a class="reference internal" href="#reference-api">Reference/API</a><ul>
<li><a class="reference internal" href="#module-astropy.io.registry">astropy.io.registry Module</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/master/docs/io/registry.rst">Edit This Page on Github</a> &nbsp;
    <a href="../_sources/io/registry.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.1. &nbsp;
    Last built 29 Apr 2016. <br/>
  </p>
</footer>
  </body>
</html>