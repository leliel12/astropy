<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>astropy.coordinates.sky_coordinate &mdash; Astropy v1.2.dev15003</title>
    
    <link rel="stylesheet" href="../../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.2.dev15003',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev15003" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../../../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">Astropy v1.2.dev15003</a>
	 &raquo;
      </li>
      <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for astropy.coordinates.sky_coordinate</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">..utils.compat.misc</span> <span class="kn">import</span> <span class="n">override__dir__</span>
<span class="kn">from</span> <span class="nn">..extern</span> <span class="kn">import</span> <span class="n">six</span>
<span class="kn">from</span> <span class="nn">..extern.six.moves</span> <span class="kn">import</span> <span class="nb">zip</span>
<span class="kn">from</span> <span class="nn">..units</span> <span class="kn">import</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">IrreducibleUnit</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">..wcs.utils</span> <span class="kn">import</span> <span class="n">skycoord_to_pixel</span><span class="p">,</span> <span class="n">pixel_to_skycoord</span>
<span class="kn">from</span> <span class="nn">..utils.exceptions</span> <span class="kn">import</span> <span class="n">AstropyDeprecationWarning</span>
<span class="kn">from</span> <span class="nn">..utils.data_info</span> <span class="kn">import</span> <span class="n">MixinInfo</span>

<span class="kn">from</span> <span class="nn">.distances</span> <span class="kn">import</span> <span class="n">Distance</span>
<span class="kn">from</span> <span class="nn">.baseframe</span> <span class="kn">import</span> <span class="n">BaseCoordinateFrame</span><span class="p">,</span> <span class="n">frame_transform_graph</span><span class="p">,</span> <span class="n">GenericFrame</span><span class="p">,</span> <span class="n">_get_repr_cls</span>
<span class="kn">from</span> <span class="nn">.builtin_frames</span> <span class="kn">import</span> <span class="n">ICRS</span>
<span class="kn">from</span> <span class="nn">.representation</span> <span class="kn">import</span> <span class="p">(</span><span class="n">BaseRepresentation</span><span class="p">,</span> <span class="n">SphericalRepresentation</span><span class="p">,</span>
                             <span class="n">UnitSphericalRepresentation</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;SkyCoord&#39;</span><span class="p">]</span>

<span class="n">PLUS_MINUS_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;(\+|\-)&#39;</span><span class="p">)</span>
<span class="n">J_PREFIXED_RA_DEC_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="sd">r&quot;&quot;&quot;J                              # J prefix</span>
<span class="sd">    ([0-9]{6,7}\.?[0-9]{0,2})          # RA as HHMMSS.ss or DDDMMSS.ss, optional decimal digits</span>
<span class="sd">    ([\+\-][0-9]{6}\.?[0-9]{0,2})\s*$  # Dec as DDMMSS.ss, optional decimal digits</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>


<span class="c"># Define a convenience mapping.  This is used like a module constants</span>
<span class="c"># but is actually dynamically evaluated.</span>
<span class="k">def</span> <span class="nf">FRAME_ATTR_NAMES_SET</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Set of all possible frame-specific attributes&quot;&quot;&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">frame_cls</span> <span class="ow">in</span> <span class="n">frame_transform_graph</span><span class="o">.</span><span class="n">frame_set</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">frame_cls</span><span class="o">.</span><span class="n">get_frame_attr_names</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">out</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>


<span class="k">class</span> <span class="nc">SkyCoordInfo</span><span class="p">(</span><span class="n">MixinInfo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Container for meta information like name, description, format.  This is</span>
<span class="sd">    required when the object is used as a mixin column within a table, but can</span>
<span class="sd">    be used as a general way to store meta information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attrs_from_parent</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s">&#39;unit&#39;</span><span class="p">])</span>  <span class="c"># Unit is read-only</span>
    <span class="n">_supports_indexing</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">default_format</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="n">repr_data</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">_repr_data</span>
        <span class="n">formats</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;{0.&#39;</span> <span class="o">+</span> <span class="n">compname</span> <span class="o">+</span> <span class="s">&#39;.value:}&#39;</span> <span class="k">for</span> <span class="n">compname</span>
                   <span class="ow">in</span> <span class="n">repr_data</span><span class="o">.</span><span class="n">components</span><span class="p">]</span>
        <span class="k">return</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formats</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">repr_data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">repr_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repr_data</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="s">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">repr_data</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="ow">or</span> <span class="s">&#39;None&#39;</span>
                        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">repr_data</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_repr_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">representation</span><span class="p">,</span> <span class="n">SphericalRepresentation</span><span class="p">)</span> <span class="ow">and</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">UnitSphericalRepresentation</span><span class="p">)):</span>
            <span class="n">repr_data</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">represent_as</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">in_frame_units</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">repr_data</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">represent_as</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">representation</span><span class="p">,</span> <span class="n">in_frame_units</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">repr_data</span>


<div class="viewcode-block" id="SkyCoord"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord">[docs]</a><span class="k">class</span> <span class="nc">SkyCoord</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;High-level object providing a flexible interface for celestial coordinate</span>
<span class="sd">    representation, manipulation, and transformation between systems.</span>

<span class="sd">    The `SkyCoord` class accepts a wide variety of inputs for initialization. At</span>
<span class="sd">    a minimum these must provide one or more celestial coordinate values with</span>
<span class="sd">    unambiguous units.  Inputs may be scalars or lists/tuples/arrays, yielding</span>
<span class="sd">    scalar or array coordinates (can be checked via ``SkyCoord.isscalar``).</span>
<span class="sd">    Typically one also specifies the coordinate frame, though this is not</span>
<span class="sd">    required. The general pattern for spherical representations is::</span>

<span class="sd">      SkyCoord(COORD, [FRAME], keyword_args ...)</span>
<span class="sd">      SkyCoord(LON, LAT, [FRAME], keyword_args ...)</span>
<span class="sd">      SkyCoord(LON, LAT, [DISTANCE], frame=FRAME, unit=UNIT, keyword_args ...)</span>
<span class="sd">      SkyCoord([FRAME], &lt;lon_attr&gt;=LON, &lt;lat_attr&gt;=LAT, keyword_args ...)</span>

<span class="sd">    It is also possible to input coordinate values in other representations</span>
<span class="sd">    such as cartesian or cylindrical.  In this case one includes the keyword</span>
<span class="sd">    argument ``representation=&#39;cartesian&#39;`` (for example) along with data in</span>
<span class="sd">    ``x``, ``y``, and ``z``.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    The examples below illustrate common ways of initializing a `SkyCoord`</span>
<span class="sd">    object.  For a complete description of the allowed syntax see the</span>
<span class="sd">    full coordinates documentation.  First some imports::</span>

<span class="sd">      &gt;&gt;&gt; from astropy.coordinates import SkyCoord  # High-level coordinates</span>
<span class="sd">      &gt;&gt;&gt; from astropy.coordinates import ICRS, Galactic, FK4, FK5  # Low-level frames</span>
<span class="sd">      &gt;&gt;&gt; from astropy.coordinates import Angle, Latitude, Longitude  # Angles</span>
<span class="sd">      &gt;&gt;&gt; import astropy.units as u</span>

<span class="sd">    The coordinate values and frame specification can now be provided using</span>
<span class="sd">    positional and keyword arguments::</span>

<span class="sd">      &gt;&gt;&gt; c = SkyCoord(10, 20, unit=&quot;deg&quot;)  # defaults to ICRS frame</span>
<span class="sd">      &gt;&gt;&gt; c = SkyCoord([1, 2, 3], [-30, 45, 8], &quot;icrs&quot;, unit=&quot;deg&quot;)  # 3 coords</span>

<span class="sd">      &gt;&gt;&gt; coords = [&quot;1:12:43.2 +1:12:43&quot;, &quot;1 12 43.2 +1 12 43&quot;]</span>
<span class="sd">      &gt;&gt;&gt; c = SkyCoord(coords, FK4, unit=(u.deg, u.hourangle), obstime=&quot;J1992.21&quot;)</span>

<span class="sd">      &gt;&gt;&gt; c = SkyCoord(&quot;1h12m43.2s +1d12m43s&quot;, Galactic)  # Units from string</span>
<span class="sd">      &gt;&gt;&gt; c = SkyCoord(&quot;galactic&quot;, l=&quot;1h12m43.2s&quot;, b=&quot;+1d12m43s&quot;)</span>

<span class="sd">      &gt;&gt;&gt; ra = Longitude([1, 2, 3], unit=u.deg)  # Could also use Angle</span>
<span class="sd">      &gt;&gt;&gt; dec = np.array([4.5, 5.2, 6.3]) * u.deg  # Astropy Quantity</span>
<span class="sd">      &gt;&gt;&gt; c = SkyCoord(ra, dec, frame=&#39;icrs&#39;)</span>
<span class="sd">      &gt;&gt;&gt; c = SkyCoord(ICRS, ra=ra, dec=dec, obstime=&#39;2001-01-02T12:34:56&#39;)</span>

<span class="sd">      &gt;&gt;&gt; c = FK4(1 * u.deg, 2 * u.deg)  # Uses defaults for obstime, equinox</span>
<span class="sd">      &gt;&gt;&gt; c = SkyCoord(c, obstime=&#39;J2010.11&#39;, equinox=&#39;B1965&#39;)  # Override defaults</span>

<span class="sd">      &gt;&gt;&gt; c = SkyCoord(w=0, u=1, v=2, unit=&#39;kpc&#39;, frame=&#39;galactic&#39;, representation=&#39;cartesian&#39;)</span>

<span class="sd">      &gt;&gt;&gt; c = SkyCoord([ICRS(ra=1*u.deg, dec=2*u.deg), ICRS(ra=3*u.deg, dec=4*u.deg)])</span>

<span class="sd">    As shown, the frame can be a `~astropy.coordinates.BaseCoordinateFrame`</span>
<span class="sd">    class or the corresponding string alias.  The frame classes that are built in</span>
<span class="sd">    to astropy are `ICRS`, `FK5`, `FK4`, `FK4NoETerms`, and `Galactic`.</span>
<span class="sd">    The string aliases are simply lower-case versions of the class name, and</span>
<span class="sd">    allow for creating a `SkyCoord` object and transforming frames without</span>
<span class="sd">    explicitly importing the frame classes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    frame : `~astropy.coordinates.BaseCoordinateFrame` class or string, optional</span>
<span class="sd">        Type of coordinate frame this `SkyCoord` should represent. Defaults to</span>
<span class="sd">        to ICRS if not given or given as None.</span>
<span class="sd">    unit : `~astropy.units.Unit`, string, or tuple of :class:`~astropy.units.Unit` or str, optional</span>
<span class="sd">        Units for supplied ``LON`` and ``LAT`` values, respectively.  If</span>
<span class="sd">        only one unit is supplied then it applies to both ``LON`` and</span>
<span class="sd">        ``LAT``.</span>
<span class="sd">    obstime : valid `~astropy.time.Time` initializer, optional</span>
<span class="sd">        Time of observation</span>
<span class="sd">    equinox : valid `~astropy.time.Time` initializer, optional</span>
<span class="sd">        Coordinate frame equinox</span>
<span class="sd">    representation : str or Representation class</span>
<span class="sd">        Specifies the representation, e.g. &#39;spherical&#39;, &#39;cartesian&#39;, or</span>
<span class="sd">        &#39;cylindrical&#39;.  This affects the positional args and other keyword args</span>
<span class="sd">        which must correspond to the given representation.</span>
<span class="sd">    **keyword_args</span>
<span class="sd">        Other keyword arguments as applicable for user-defined coordinate frames.</span>
<span class="sd">        Common options include:</span>

<span class="sd">        ra, dec : valid `~astropy.coordinates.Angle` initializer, optional</span>
<span class="sd">            RA and Dec for frames where ``ra`` and ``dec`` are keys in the</span>
<span class="sd">            frame&#39;s ``representation_component_names``, including `ICRS`,</span>
<span class="sd">            `FK5`, `FK4`, and `FK4NoETerms`.</span>
<span class="sd">        l, b : valid `~astropy.coordinates.Angle` initializer, optional</span>
<span class="sd">            Galactic ``l`` and ``b`` for for frames where ``l`` and ``b`` are</span>
<span class="sd">            keys in the frame&#39;s ``representation_component_names``, including</span>
<span class="sd">            the `Galactic` frame.</span>
<span class="sd">        x, y, z : float or `~astropy.units.Quantity`, optional</span>
<span class="sd">            Cartesian coordinates values</span>
<span class="sd">        w, u, v : float or `~astropy.units.Quantity`, optional</span>
<span class="sd">            Cartesian coordinates values for the Galactic frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># Declare that SkyCoord can be used as a Table column by defining the</span>
    <span class="c"># info property.</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">SkyCoordInfo</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c"># Parse the args and kwargs to assemble a sanitized and validated</span>
        <span class="c"># kwargs dict for initializing attributes for this object and for</span>
        <span class="c"># creating the internal self._sky_coord_frame object</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>  <span class="c"># Make it mutable</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_inputs</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="c"># Set internal versions of object state attributes</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">FRAME_ATTR_NAMES_SET</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">attr</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span>

        <span class="n">frame</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;frame&#39;</span><span class="p">]</span>
        <span class="n">coord_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s">&#39;representation&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">coord_kwargs</span><span class="p">[</span><span class="s">&#39;representation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_repr_cls</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;representation&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">attr</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation_component_names</span>
                                      <span class="ow">or</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">get_frame_attr_names</span><span class="p">()):</span>
                <span class="n">coord_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="c"># Finally make the internal coordinate object.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">coord_kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span><span class="o">.</span><span class="n">has_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Cannot create a SkyCoord without data&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">representation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">representation</span>

    <span class="nd">@representation.setter</span>
    <span class="k">def</span> <span class="nf">representation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">representation</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c"># Py 2.x</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">__nonzero__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c"># Py 3.x</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">__bool__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="n">self_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c"># First turn `self` into a mockup of the thing we want - we can copy</span>
            <span class="c"># this to get all the right attributes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span> <span class="o">=</span> <span class="n">self_frame</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">representation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">representation</span><span class="p">)</span>

            <span class="c"># Copy other &#39;info&#39; attr only if it has actually been defined.</span>
            <span class="c"># See PR #3898 for further explanation and justification, along</span>
            <span class="c"># with Quantity.__array_finalize__</span>
            <span class="k">if</span> <span class="s">&#39;info&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>

            <span class="k">return</span> <span class="n">out</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c"># now put back the right frame in self</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span> <span class="o">=</span> <span class="n">self_frame</span>

    <span class="k">def</span> <span class="nf">_parse_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assemble a validated and sanitized keyword args dict for instantiating a</span>
<span class="sd">        SkyCoord and coordinate object from the provided `args`, and `kwargs`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valid_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c"># Put the SkyCoord attributes like frame, equinox, obstime, location</span>
        <span class="c"># into valid_kwargs dict.  `Frame` could come from args or kwargs, so</span>
        <span class="c"># set valid_kwargs[&#39;frame&#39;] accordingly.  The others must be specified</span>
        <span class="c"># by keyword args or else get a None default.  Pop them off of kwargs</span>
        <span class="c"># in the process.</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">valid_kwargs</span><span class="p">[</span><span class="s">&#39;frame&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_frame</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;representation&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">valid_kwargs</span><span class="p">[</span><span class="s">&#39;representation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_repr_cls</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;representation&#39;</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">FRAME_ATTR_NAMES_SET</span><span class="p">():</span>
            <span class="n">valid_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="c"># Get units</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">_get_units</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="c"># Grab any frame-specific attr names like `ra` or `l` or `distance` from kwargs</span>
        <span class="c"># and migrate to valid_kwargs.</span>
        <span class="n">valid_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">_get_representation_attrs</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>

        <span class="c"># Error if anything is still left in kwargs</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Unrecognized keyword argument(s) {0}&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;&#39;{0}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)))</span>

        <span class="c"># Finally deal with the unnamed args.  This figures out what the arg[0] is</span>
        <span class="c"># and returns a dict with appropriate key/values for initializing frame class.</span>
        <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c"># One arg which must be a coordinate.  In this case</span>
                <span class="c"># coord_kwargs will contain keys like &#39;ra&#39;, &#39;dec&#39;, &#39;distance&#39;</span>
                <span class="c"># along with any frame attributes like equinox or obstime which</span>
                <span class="c"># were explicitly specified in the coordinate object (i.e. non-default).</span>
                <span class="n">coord_kwargs</span> <span class="o">=</span> <span class="n">_parse_coordinate_arg</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">frame</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

                <span class="c"># Copy other &#39;info&#39; attr only if it has actually been defined.</span>
                <span class="k">if</span> <span class="s">&#39;info&#39;</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;__dict__&#39;</span><span class="p">,</span> <span class="p">()):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">info</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">frame_attr_names</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation_component_names</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="n">repr_attr_names</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation_component_names</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="n">coord_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">arg</span><span class="p">,</span> <span class="n">frame_attr_name</span><span class="p">,</span> <span class="n">repr_attr_name</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">frame_attr_names</span><span class="p">,</span>
                                                                      <span class="n">repr_attr_names</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
                    <span class="n">attr_class</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation</span><span class="o">.</span><span class="n">attr_classes</span><span class="p">[</span><span class="n">repr_attr_name</span><span class="p">]</span>
                    <span class="n">coord_kwargs</span><span class="p">[</span><span class="n">frame_attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr_class</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Must supply no more than three positional arguments, got {}&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)))</span>

            <span class="c"># Copy the coord_kwargs into the final valid_kwargs dict.  For each</span>
            <span class="c"># of the coord_kwargs ensure that there is no conflict with a value</span>
            <span class="c"># specified by the user in the original kwargs.</span>
            <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">coord_value</span> <span class="ow">in</span> <span class="n">coord_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">attr</span> <span class="ow">in</span> <span class="n">valid_kwargs</span>
                        <span class="ow">and</span> <span class="n">valid_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
                        <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">valid_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">!=</span> <span class="n">coord_value</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Coordinate attribute &#39;{0}&#39;={1!r} conflicts with &quot;</span>
                                     <span class="s">&quot;keyword argument &#39;{0}&#39;={2!r}&quot;</span>
                                     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">coord_value</span><span class="p">,</span> <span class="n">valid_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]))</span>
                <span class="n">valid_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">coord_value</span>

        <span class="k">return</span> <span class="n">valid_kwargs</span>

<div class="viewcode-block" id="SkyCoord.transform_to"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.transform_to">[docs]</a>    <span class="k">def</span> <span class="nf">transform_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transform this coordinate to a new frame.</span>

<span class="sd">        The frame attributes (e.g. equinox or obstime) for the returned object</span>
<span class="sd">        depend on the corresponding attributes of SkyCoord object and the</span>
<span class="sd">        supplied ``frame``, with the following precedence:</span>

<span class="sd">        1. Non-default value in the supplied frame</span>
<span class="sd">        2. Non-default value in the SkyCoord instance</span>
<span class="sd">        3. Default value in the supplied frame</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frame : str or `BaseCoordinateFrame` class / instance or `SkyCoord` instance</span>
<span class="sd">            The frame to transform this coordinate into.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        coord : `SkyCoord`</span>
<span class="sd">            A new object with this coordinate represented in the `frame` frame.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If there is no possible transformation route.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">astropy.coordinates.errors</span> <span class="kn">import</span> <span class="n">ConvertError</span>

        <span class="n">frame_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c"># Frame name (string) or frame class?  Coerce into an instance.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">_get_frame_class</span><span class="p">(</span><span class="n">frame</span><span class="p">)()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">):</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">frame</span>  <span class="c"># Change to underlying coord frame instance</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">):</span>
            <span class="n">new_frame_cls</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">__class__</span>

            <span class="c"># Set the keyword args for making a new frame instance for the</span>
            <span class="c"># transform.  Frame attributes track whether they were explicitly</span>
            <span class="c"># set by user or are just reflecting default values.  Precedence:</span>
            <span class="c"># 1. Non-default value in the supplied frame instance</span>
            <span class="c"># 2. Non-default value in the self instance</span>
            <span class="c"># 3. Default value in the supplied frame instance</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">FRAME_ATTR_NAMES_SET</span><span class="p">():</span>
                <span class="n">self_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="n">frame_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">frame_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">frame</span><span class="o">.</span><span class="n">is_frame_attr_default</span><span class="p">(</span><span class="n">attr</span><span class="p">):</span>
                    <span class="n">frame_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame_val</span>
                <span class="k">elif</span> <span class="n">self_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_frame_attr_default</span><span class="p">(</span><span class="n">attr</span><span class="p">):</span>
                    <span class="n">frame_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">self_val</span>
                <span class="k">elif</span> <span class="n">frame_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">frame_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame_val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Transform `frame` must be a frame name, class, or instance&#39;</span><span class="p">)</span>

        <span class="c"># Get the composite transform to the new frame</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">frame_transform_graph</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">new_frame_cls</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">trans</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConvertError</span><span class="p">(</span><span class="s">&#39;Cannot transform from {0} to {1}&#39;</span>
                               <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">new_frame_cls</span><span class="p">))</span>

        <span class="c"># Make a generic frame which will accept all the frame kwargs that</span>
        <span class="c"># are provided and allow for transforming through intermediate frames</span>
        <span class="c"># which may require one or more of those kwargs.</span>
        <span class="n">generic_frame</span> <span class="o">=</span> <span class="n">GenericFrame</span><span class="p">(</span><span class="n">frame_kwargs</span><span class="p">)</span>

        <span class="c"># Do the transformation, returning a coordinate frame of the desired</span>
        <span class="c"># final type (not generic).</span>
        <span class="n">new_coord</span> <span class="o">=</span> <span class="n">trans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">generic_frame</span><span class="p">)</span>

        <span class="c"># Finally make the new SkyCoord object from the `new_coord` and</span>
        <span class="c"># remaining frame_kwargs that are not frame_attributes in `new_coord`.</span>
        <span class="c"># We could remove overlaps here, but the init code is set up to accept</span>
        <span class="c"># overlaps as long as the values are identical (which they must be).</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">new_coord</span><span class="p">,</span> <span class="o">**</span><span class="n">frame_kwargs</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides getattr to return coordinates that this can be transformed</span>
<span class="sd">        to, based on the alias attr in the master transform graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s">&#39;_sky_coord_frame&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">attr</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span>  <span class="c"># Should this be a deepcopy of self?</span>

            <span class="c"># Anything in the set of all possible frame_attr_names is handled</span>
            <span class="c"># here. If the attr is relevant for the current frame then delegate</span>
            <span class="c"># to self.frame otherwise get it from self._&lt;attr&gt;.</span>
            <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">FRAME_ATTR_NAMES_SET</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">get_frame_attr_names</span><span class="p">():</span>
                    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">attr</span><span class="p">)</span>

            <span class="c"># Some attributes might not fall in the above category but still</span>
            <span class="c"># are available through self._sky_coord_frame.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

            <span class="c"># Try to interpret as a new frame for transforming.</span>
            <span class="n">frame_cls</span> <span class="o">=</span> <span class="n">frame_transform_graph</span><span class="o">.</span><span class="n">lookup_name</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">frame_cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">is_transformable_to</span><span class="p">(</span><span class="n">frame_cls</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

        <span class="c"># Fail</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;{0}&#39; object has no attribute &#39;{1}&#39;&quot;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="c"># This is to make anything available through __getattr__ immutable</span>
        <span class="k">if</span> <span class="s">&#39;_sky_coord_frame&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">attr</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;{0}&#39; is immutable&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">))</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">attr</span> <span class="ow">in</span> <span class="n">FRAME_ATTR_NAMES_SET</span><span class="p">()</span> <span class="ow">or</span>
                <span class="p">(</span><span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span>
                 <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span><span class="p">,</span> <span class="n">attr</span><span class="p">))):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sky_coord_frame</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

            <span class="n">frame_cls</span> <span class="o">=</span> <span class="n">frame_transform_graph</span><span class="o">.</span><span class="n">lookup_name</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">frame_cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">is_transformable_to</span><span class="p">(</span><span class="n">frame_cls</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;{0}&#39; is immutable&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">))</span>

        <span class="c"># Otherwise, do the standard Python attribute setting</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

    <span class="nd">@override__dir__</span>
    <span class="k">def</span> <span class="nf">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override the builtin `dir` behavior to include:</span>
<span class="sd">        - Transforms available by aliases</span>
<span class="sd">        - Attribute / methods of the underlying self.frame object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># determine the aliases that this can be transformed to.</span>
        <span class="n">dir_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">frame_transform_graph</span><span class="o">.</span><span class="n">get_names</span><span class="p">():</span>
            <span class="n">frame_cls</span> <span class="o">=</span> <span class="n">frame_transform_graph</span><span class="o">.</span><span class="n">lookup_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">is_transformable_to</span><span class="p">(</span><span class="n">frame_cls</span><span class="p">):</span>
                <span class="n">dir_values</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="c"># Add public attributes of self.frame</span>
        <span class="n">dir_values</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">attr</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)))</span>

        <span class="c"># Add all possible frame attributes</span>
        <span class="n">dir_values</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">FRAME_ATTR_NAMES_SET</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">dir_values</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">clsnm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>
        <span class="n">coonm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>
        <span class="n">frameattrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">_frame_attrs_repr</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">frameattrs</span><span class="p">:</span>
            <span class="n">frameattrs</span> <span class="o">=</span> <span class="s">&#39;: &#39;</span> <span class="o">+</span> <span class="n">frameattrs</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">_data_repr</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s">&#39;: &#39;</span> <span class="o">+</span> <span class="n">data</span>

        <span class="k">return</span> <span class="s">&#39;&lt;{clsnm} ({coonm}{frameattrs}){data}&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="nb">locals</span><span class="p">())</span>

<div class="viewcode-block" id="SkyCoord.to_string"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">&#39;decimal&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A string representation of the coordinates.</span>

<span class="sd">        The default styles definitions are::</span>

<span class="sd">          &#39;decimal&#39;: &#39;lat&#39;: {&#39;decimal&#39;: True, &#39;unit&#39;: &quot;deg&quot;}</span>
<span class="sd">                     &#39;lon&#39;: {&#39;decimal&#39;: True, &#39;unit&#39;: &quot;deg&quot;}</span>
<span class="sd">          &#39;dms&#39;: &#39;lat&#39;: {&#39;unit&#39;: &quot;deg&quot;}</span>
<span class="sd">                 &#39;lon&#39;: {&#39;unit&#39;: &quot;deg&quot;}</span>
<span class="sd">          &#39;hmsdms&#39;: &#39;lat&#39;: {&#39;alwayssign&#39;: True, &#39;pad&#39;: True, &#39;unit&#39;: &quot;deg&quot;}</span>
<span class="sd">                    &#39;lon&#39;: {&#39;pad&#39;: True, &#39;unit&#39;: &quot;hour&quot;}</span>

<span class="sd">        See :meth:`~astropy.coordinates.Angle.to_string` for details and</span>
<span class="sd">        keyword arguments (the two angles forming the coordinates are are</span>
<span class="sd">        both :class:`~astropy.coordinates.Angle` instances). Keyword</span>
<span class="sd">        arguments have precedence over the style defaults and are passed</span>
<span class="sd">        to :meth:`~astropy.coordinates.Angle.to_string`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : {&#39;hmsdms&#39;, &#39;dms&#39;, &#39;decimal&#39;}</span>
<span class="sd">            The formatting specification to use. These encode the three most</span>
<span class="sd">            common ways to represent coordinates. The default is `decimal`.</span>
<span class="sd">        kwargs</span>
<span class="sd">            Keyword args passed to :meth:`~astropy.coordinates.Angle.to_string`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sph_coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">represent_as</span><span class="p">(</span><span class="n">SphericalRepresentation</span><span class="p">)</span>

        <span class="n">styles</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;hmsdms&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;lonargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;unit&#39;</span><span class="p">:</span> <span class="n">u</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="s">&#39;pad&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">},</span>
                             <span class="s">&#39;latargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;unit&#39;</span><span class="p">:</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s">&#39;pad&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;alwayssign&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}},</span>
                  <span class="s">&#39;dms&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;lonargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;unit&#39;</span><span class="p">:</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">},</span>
                          <span class="s">&#39;latargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;unit&#39;</span><span class="p">:</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">}},</span>
                  <span class="s">&#39;decimal&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;lonargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;unit&#39;</span><span class="p">:</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s">&#39;decimal&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">},</span>
                              <span class="s">&#39;latargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;unit&#39;</span><span class="p">:</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="s">&#39;decimal&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}}</span>
                  <span class="p">}</span>

        <span class="n">lonargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">latargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">styles</span><span class="p">:</span>
            <span class="n">lonargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">styles</span><span class="p">[</span><span class="n">style</span><span class="p">][</span><span class="s">&#39;lonargs&#39;</span><span class="p">])</span>
            <span class="n">latargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">styles</span><span class="p">[</span><span class="n">style</span><span class="p">][</span><span class="s">&#39;latargs&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Invalid style.  Valid options are: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">styles</span><span class="p">)))</span>

        <span class="n">lonargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">latargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">sph_coord</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
            <span class="n">coord_string</span> <span class="o">=</span> <span class="p">(</span><span class="n">sph_coord</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="o">**</span><span class="n">lonargs</span><span class="p">)</span>
                            <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span>
                            <span class="n">sph_coord</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="o">**</span><span class="n">latargs</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coord_string</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">lonangle</span><span class="p">,</span> <span class="n">latangle</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sph_coord</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">sph_coord</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
                <span class="n">coord_string</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">lonangle</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="o">**</span><span class="n">lonargs</span><span class="p">)</span>
                                 <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span>
                                 <span class="n">latangle</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="o">**</span><span class="n">latargs</span><span class="p">))]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sph_coord</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">coord_string</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_string</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sph_coord</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">coord_string</span>
</div>
<div class="viewcode-block" id="SkyCoord.is_equivalent_frame"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.is_equivalent_frame">[docs]</a>    <span class="k">def</span> <span class="nf">is_equivalent_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if this object&#39;s frame as the same as that of the ``other``</span>
<span class="sd">        object.</span>

<span class="sd">        To be the same frame, two objects must be the same frame class and have</span>
<span class="sd">        the same frame attributes. For two `SkyCoord` objects, *all* of the</span>
<span class="sd">        frame attributes have to match, not just those relevant for the object&#39;s</span>
<span class="sd">        frame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : SkyCoord or BaseCoordinateFrame</span>
<span class="sd">            The other object to check.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        isequiv : bool</span>
<span class="sd">            True if the frames are the same, False if not.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            If ``other`` isn&#39;t a `SkyCoord` or a `BaseCoordinateFrame` or subclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">is_equivalent_frame</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>

            <span class="k">for</span> <span class="n">fattrnm</span> <span class="ow">in</span> <span class="n">FRAME_ATTR_NAMES_SET</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fattrnm</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fattrnm</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">False</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#not a BaseCoordinateFrame nor a SkyCoord object</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Tried to do is_equivalent_frame on something that &quot;</span>
                            <span class="s">&quot;isn&#39;t frame-like&quot;</span><span class="p">)</span>

    <span class="c"># High-level convenience methods</span></div>
<div class="viewcode-block" id="SkyCoord.separation"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.separation">[docs]</a>    <span class="k">def</span> <span class="nf">separation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes on-sky separation between this coordinate and another.</span>

<span class="sd">        For more on how to use this (and related) functionality, see the</span>
<span class="sd">        examples in :doc:`/coordinates/matchsep`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : `~astropy.coordinates.SkyCoord` or `~astropy.coordinates.BaseCoordinateFrame`</span>
<span class="sd">            The coordinate to get the separation to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sep : `~astropy.coordinates.Angle`</span>
<span class="sd">            The on-sky separation between this and the ``other`` coordinate.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The separation is calculated using the Vincenty formula, which</span>
<span class="sd">        is stable at all locations, including poles and antipodes [1]_.</span>

<span class="sd">        .. [1] http://en.wikipedia.org/wiki/Great-circle_distance</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">Angle</span>
        <span class="kn">from</span> <span class="nn">.angle_utilities</span> <span class="kn">import</span> <span class="n">angular_separation</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">):</span>
            <span class="n">self_in_other_system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">has_data</span><span class="p">:</span>
            <span class="c"># it&#39;s a frame</span>
            <span class="n">self_in_other_system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Can only get separation to another SkyCoord or a &#39;</span>
                            <span class="s">&#39;coordinate frame with data&#39;</span><span class="p">)</span>

        <span class="n">lon1</span> <span class="o">=</span> <span class="n">self_in_other_system</span><span class="o">.</span><span class="n">spherical</span><span class="o">.</span><span class="n">lon</span>
        <span class="n">lat1</span> <span class="o">=</span> <span class="n">self_in_other_system</span><span class="o">.</span><span class="n">spherical</span><span class="o">.</span><span class="n">lat</span>
        <span class="n">lon2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">spherical</span><span class="o">.</span><span class="n">lon</span>
        <span class="n">lat2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">spherical</span><span class="o">.</span><span class="n">lat</span>

        <span class="c"># Get the separation as a Quantity, convert to Angle in degrees</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="n">angular_separation</span><span class="p">(</span><span class="n">lon1</span><span class="p">,</span> <span class="n">lat1</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span> <span class="n">lat2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Angle</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SkyCoord.separation_3d"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.separation_3d">[docs]</a>    <span class="k">def</span> <span class="nf">separation_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes three dimensional separation between this coordinate</span>
<span class="sd">        and another.</span>

<span class="sd">        For more on how to use this (and related) functionality, see the</span>
<span class="sd">        examples in :doc:`/coordinates/matchsep`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : `~astropy.coordinates.SkyCoord` or `~astropy.coordinates.BaseCoordinateFrame`</span>
<span class="sd">            The coordinate to get the separation to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sep : `~astropy.coordinates.Distance`</span>
<span class="sd">            The real-space distance between these two coordinates.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If this or the other coordinate do not have distances.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">):</span>
            <span class="n">self_in_other_system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">has_data</span><span class="p">:</span>
            <span class="c"># it&#39;s a frame</span>
            <span class="n">self_in_other_system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Can only get separation to another SkyCoord or a &#39;</span>
                            <span class="s">&#39;coordinate frame with data&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">UnitSphericalRepresentation</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;This object does not have a distance; cannot &#39;</span>
                             <span class="s">&#39;compute 3d separation.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">UnitSphericalRepresentation</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;The other object does not have a distance; &#39;</span>
                             <span class="s">&#39;cannot compute 3d separation.&#39;</span><span class="p">)</span>

        <span class="n">dx</span> <span class="o">=</span> <span class="n">self_in_other_system</span><span class="o">.</span><span class="n">cartesian</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">cartesian</span><span class="o">.</span><span class="n">x</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">self_in_other_system</span><span class="o">.</span><span class="n">cartesian</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">cartesian</span><span class="o">.</span><span class="n">y</span>
        <span class="n">dz</span> <span class="o">=</span> <span class="n">self_in_other_system</span><span class="o">.</span><span class="n">cartesian</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">cartesian</span><span class="o">.</span><span class="n">z</span>

        <span class="n">distval</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="o">.</span><span class="n">value</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">.</span><span class="n">value</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dz</span><span class="o">.</span><span class="n">value</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="k">return</span> <span class="n">Distance</span><span class="p">(</span><span class="n">distval</span><span class="p">,</span> <span class="n">dx</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SkyCoord.match_to_catalog_sky"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.match_to_catalog_sky">[docs]</a>    <span class="k">def</span> <span class="nf">match_to_catalog_sky</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalogcoord</span><span class="p">,</span> <span class="n">nthneighbor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds the nearest on-sky matches of this coordinate in a set of</span>
<span class="sd">        catalog coordinates.</span>

<span class="sd">        For more on how to use this (and related) functionality, see the</span>
<span class="sd">        examples in :doc:`/coordinates/matchsep`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        catalogcoord : `~astropy.coordinates.SkyCoord` or `~astropy.coordinates.BaseCoordinateFrame`</span>
<span class="sd">            The base catalog in which to search for matches. Typically this</span>
<span class="sd">            will be a coordinate object that is an array (i.e.,</span>
<span class="sd">            ``catalogcoord.isscalar == False``)</span>
<span class="sd">        nthneighbor : int, optional</span>
<span class="sd">            Which closest neighbor to search for.  Typically ``1`` is</span>
<span class="sd">            desired here, as that is correct for matching one set of</span>
<span class="sd">            coordinates to another. The next likely use case is ``2``,</span>
<span class="sd">            for matching a coordinate catalog against *itself* (``1``</span>
<span class="sd">            is inappropriate because each point will find itself as the</span>
<span class="sd">            closest match).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        idx : integer array</span>
<span class="sd">            Indices into ``catalogcoord`` to get the matched points for</span>
<span class="sd">            each of this object&#39;s coordinates. Shape matches this</span>
<span class="sd">            object.</span>
<span class="sd">        sep2d : `~astropy.coordinates.Angle`</span>
<span class="sd">            The on-sky separation between the closest match for each</span>
<span class="sd">            element in this object in ``catalogcoord``. Shape matches</span>
<span class="sd">            this object.</span>
<span class="sd">        dist3d : `~astropy.units.Quantity`</span>
<span class="sd">            The 3D distance between the closest match for each element</span>
<span class="sd">            in this object in ``catalogcoord``. Shape matches this</span>
<span class="sd">            object.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method requires `SciPy &lt;http://www.scipy.org&gt;`_ to be</span>
<span class="sd">        installed or it will fail.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        astropy.coordinates.match_coordinates_sky</span>
<span class="sd">        SkyCoord.match_to_catalog_3d</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.matching</span> <span class="kn">import</span> <span class="n">match_coordinates_sky</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">catalogcoord</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyCoord</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">))</span>
                <span class="ow">and</span> <span class="n">catalogcoord</span><span class="o">.</span><span class="n">has_data</span><span class="p">):</span>
            <span class="n">self_in_catalog_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">catalogcoord</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Can only get separation to another SkyCoord or a &#39;</span>
                            <span class="s">&#39;coordinate frame with data&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">self_in_catalog_frame</span><span class="p">,</span> <span class="n">catalogcoord</span><span class="p">,</span>
                                    <span class="n">nthneighbor</span><span class="o">=</span><span class="n">nthneighbor</span><span class="p">,</span>
                                    <span class="n">storekdtree</span><span class="o">=</span><span class="s">&#39;_kdtree_sky&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
</div>
<div class="viewcode-block" id="SkyCoord.match_to_catalog_3d"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.match_to_catalog_3d">[docs]</a>    <span class="k">def</span> <span class="nf">match_to_catalog_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalogcoord</span><span class="p">,</span> <span class="n">nthneighbor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds the nearest 3-dimensional matches of this coordinate to a set</span>
<span class="sd">        of catalog coordinates.</span>

<span class="sd">        This finds the 3-dimensional closest neighbor, which is only different</span>
<span class="sd">        from the on-sky distance if ``distance`` is set in this object or the</span>
<span class="sd">        ``catalogcoord`` object.</span>

<span class="sd">        For more on how to use this (and related) functionality, see the</span>
<span class="sd">        examples in :doc:`/coordinates/matchsep`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        catalogcoord : `~astropy.coordinates.SkyCoord` or `~astropy.coordinates.BaseCoordinateFrame`</span>
<span class="sd">            The base catalog in which to search for matches. Typically this</span>
<span class="sd">            will be a coordinate object that is an array (i.e.,</span>
<span class="sd">            ``catalogcoord.isscalar == False``)</span>
<span class="sd">        nthneighbor : int, optional</span>
<span class="sd">            Which closest neighbor to search for.  Typically ``1`` is</span>
<span class="sd">            desired here, as that is correct for matching one set of</span>
<span class="sd">            coordinates to another.  The next likely use case is</span>
<span class="sd">            ``2``, for matching a coordinate catalog against *itself*</span>
<span class="sd">            (``1`` is inappropriate because each point will find</span>
<span class="sd">            itself as the closest match).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        idx : integer array</span>
<span class="sd">            Indices into ``catalogcoord`` to get the matched points for</span>
<span class="sd">            each of this object&#39;s coordinates. Shape matches this</span>
<span class="sd">            object.</span>
<span class="sd">        sep2d : `~astropy.coordinates.Angle`</span>
<span class="sd">            The on-sky separation between the closest match for each</span>
<span class="sd">            element in this object in ``catalogcoord``. Shape matches</span>
<span class="sd">            this object.</span>
<span class="sd">        dist3d : `~astropy.units.Quantity`</span>
<span class="sd">            The 3D distance between the closest match for each element</span>
<span class="sd">            in this object in ``catalogcoord``. Shape matches this</span>
<span class="sd">            object.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method requires `SciPy &lt;http://www.scipy.org&gt;`_ to be</span>
<span class="sd">        installed or it will fail.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        astropy.coordinates.match_coordinates_3d</span>
<span class="sd">        SkyCoord.match_to_catalog_sky</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.matching</span> <span class="kn">import</span> <span class="n">match_coordinates_3d</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">catalogcoord</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyCoord</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">))</span>
                <span class="ow">and</span> <span class="n">catalogcoord</span><span class="o">.</span><span class="n">has_data</span><span class="p">):</span>
            <span class="n">self_in_catalog_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">catalogcoord</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Can only get separation to another SkyCoord or a &#39;</span>
                            <span class="s">&#39;coordinate frame with data&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">match_coordinates_3d</span><span class="p">(</span><span class="n">self_in_catalog_frame</span><span class="p">,</span> <span class="n">catalogcoord</span><span class="p">,</span>
                                   <span class="n">nthneighbor</span><span class="o">=</span><span class="n">nthneighbor</span><span class="p">,</span>
                                   <span class="n">storekdtree</span><span class="o">=</span><span class="s">&#39;_kdtree_3d&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res</span>
</div>
<div class="viewcode-block" id="SkyCoord.search_around_sky"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.search_around_sky">[docs]</a>    <span class="k">def</span> <span class="nf">search_around_sky</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searcharoundcoords</span><span class="p">,</span> <span class="n">seplimit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Searches for all coordinates in this object around a supplied set of</span>
<span class="sd">        points within a given on-sky separation.</span>

<span class="sd">        This is intended for use on `~astropy.coordinates.SkyCoord` objects</span>
<span class="sd">        with coordinate arrays, rather than a scalar coordinate.  For a scalar</span>
<span class="sd">        coordinate, it is better to use</span>
<span class="sd">        `~astropy.coordinates.SkyCoord.separation`.</span>

<span class="sd">        For more on how to use this (and related) functionality, see the</span>
<span class="sd">        examples in :doc:`/coordinates/matchsep`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        searcharoundcoords : `~astropy.coordinates.SkyCoord` or `~astropy.coordinates.BaseCoordinateFrame`</span>
<span class="sd">            The coordinates to search around to try to find matching points in</span>
<span class="sd">            this `SkyCoord`. This should be an object with array coordinates,</span>
<span class="sd">            not a scalar coordinate object.</span>
<span class="sd">        seplimit : `~astropy.units.Quantity` with angle units</span>
<span class="sd">            The on-sky separation to search within.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        idxsearcharound : integer array</span>
<span class="sd">            Indices into ``self`` that matches to the corresponding element of</span>
<span class="sd">            ``idxself``. Shape matches ``idxself``.</span>
<span class="sd">        idxself : integer array</span>
<span class="sd">            Indices into ``searcharoundcoords`` that matches to the</span>
<span class="sd">            corresponding element of ``idxsearcharound``. Shape matches</span>
<span class="sd">            ``idxsearcharound``.</span>
<span class="sd">        sep2d : `~astropy.coordinates.Angle`</span>
<span class="sd">            The on-sky separation between the coordinates. Shape matches</span>
<span class="sd">            ``idxsearcharound`` and ``idxself``.</span>
<span class="sd">        dist3d : `~astropy.units.Quantity`</span>
<span class="sd">            The 3D distance between the coordinates. Shape matches</span>
<span class="sd">            ``idxsearcharound`` and ``idxself``.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method requires `SciPy &lt;http://www.scipy.org&gt;`_ (&gt;=0.12.0) to be</span>
<span class="sd">        installed or it will fail.</span>

<span class="sd">        In the current implementation, the return values are always sorted in</span>
<span class="sd">        the same order as the ``searcharoundcoords`` (so ``idxsearcharound`` is</span>
<span class="sd">        in ascending order).  This is considered an implementation detail,</span>
<span class="sd">        though, so it could change in a future release.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        astropy.coordinates.search_around_sky</span>
<span class="sd">        SkyCoord.search_around_3d</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.matching</span> <span class="kn">import</span> <span class="n">search_around_sky</span>

        <span class="k">return</span> <span class="n">search_around_sky</span><span class="p">(</span><span class="n">searcharoundcoords</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">seplimit</span><span class="p">,</span>
                                 <span class="n">storekdtree</span><span class="o">=</span><span class="s">&#39;_kdtree_sky&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SkyCoord.search_around_3d"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.search_around_3d">[docs]</a>    <span class="k">def</span> <span class="nf">search_around_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searcharoundcoords</span><span class="p">,</span> <span class="n">distlimit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Searches for all coordinates in this object around a supplied set of</span>
<span class="sd">        points within a given 3D radius.</span>

<span class="sd">        This is intended for use on `~astropy.coordinates.SkyCoord` objects</span>
<span class="sd">        with coordinate arrays, rather than a scalar coordinate.  For a scalar</span>
<span class="sd">        coordinate, it is better to use</span>
<span class="sd">        `~astropy.coordinates.SkyCoord.separation_3d`.</span>

<span class="sd">        For more on how to use this (and related) functionality, see the</span>
<span class="sd">        examples in :doc:`/coordinates/matchsep`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        searcharoundcoords : `~astropy.coordinates.SkyCoord` or `~astropy.coordinates.BaseCoordinateFrame`</span>
<span class="sd">            The coordinates to search around to try to find matching points in</span>
<span class="sd">            this `SkyCoord`. This should be an object with array coordinates,</span>
<span class="sd">            not a scalar coordinate object.</span>
<span class="sd">        distlimit : `~astropy.units.Quantity` with distance units</span>
<span class="sd">            The physical radius to search within.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        idxsearcharound : integer array</span>
<span class="sd">            Indices into ``self`` that matches to the corresponding element of</span>
<span class="sd">            ``idxself``. Shape matches ``idxself``.</span>
<span class="sd">        idxself : integer array</span>
<span class="sd">            Indices into ``searcharoundcoords`` that matches to the</span>
<span class="sd">            corresponding element of ``idxsearcharound``. Shape matches</span>
<span class="sd">            ``idxsearcharound``.</span>
<span class="sd">        sep2d : `~astropy.coordinates.Angle`</span>
<span class="sd">            The on-sky separation between the coordinates. Shape matches</span>
<span class="sd">            ``idxsearcharound`` and ``idxself``.</span>
<span class="sd">        dist3d : `~astropy.units.Quantity`</span>
<span class="sd">            The 3D distance between the coordinates. Shape matches</span>
<span class="sd">            ``idxsearcharound`` and ``idxself``.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method requires `SciPy &lt;http://www.scipy.org&gt;`_ (&gt;=0.12.0) to be</span>
<span class="sd">        installed or it will fail.</span>

<span class="sd">        In the current implementation, the return values are always sorted in</span>
<span class="sd">        the same order as the ``searcharoundcoords`` (so ``idxsearcharound`` is</span>
<span class="sd">        in ascending order).  This is considered an implementation detail,</span>
<span class="sd">        though, so it could change in a future release.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        astropy.coordinates.search_around_3d</span>
<span class="sd">        SkyCoord.search_around_sky</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.matching</span> <span class="kn">import</span> <span class="n">search_around_3d</span>

        <span class="k">return</span> <span class="n">search_around_3d</span><span class="p">(</span><span class="n">searcharoundcoords</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">distlimit</span><span class="p">,</span>
                                <span class="n">storekdtree</span><span class="o">=</span><span class="s">&#39;_kdtree_3d&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SkyCoord.position_angle"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.position_angle">[docs]</a>    <span class="k">def</span> <span class="nf">position_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the on-sky position angle (East of North) between this</span>
<span class="sd">        `SkyCoord` and another.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : `SkyCoord`</span>
<span class="sd">            The other coordinate to compute the position angle to.  It is</span>
<span class="sd">            treated as the &quot;head&quot; of the vector of the position angle.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pa : `~astropy.coordinates.Angle`</span>
<span class="sd">            The (positive) position angle of the vector pointing from ``self``</span>
<span class="sd">            to ``other``.  If either ``self`` or ``other`` contain arrays, this</span>
<span class="sd">            will be an array following the appropriate `numpy` broadcasting</span>
<span class="sd">            rules.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; c1 = SkyCoord(0*u.deg, 0*u.deg)</span>
<span class="sd">        &gt;&gt;&gt; c2 = SkyCoord(1*u.deg, 0*u.deg)</span>
<span class="sd">        &gt;&gt;&gt; c1.position_angle(c2).degree</span>
<span class="sd">        90.0</span>
<span class="sd">        &gt;&gt;&gt; c3 = SkyCoord(1*u.deg, 1*u.deg)</span>
<span class="sd">        &gt;&gt;&gt; c1.position_angle(c3).degree  # doctest: +FLOAT_CMP</span>
<span class="sd">        44.995636455344844</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">angle_utilities</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="n">other_in_self_frame</span> <span class="o">=</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">other_in_self_frame</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>

        <span class="n">slat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">represent_as</span><span class="p">(</span><span class="n">UnitSphericalRepresentation</span><span class="p">)</span><span class="o">.</span><span class="n">lat</span>
        <span class="n">slon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">represent_as</span><span class="p">(</span><span class="n">UnitSphericalRepresentation</span><span class="p">)</span><span class="o">.</span><span class="n">lon</span>
        <span class="n">olat</span> <span class="o">=</span> <span class="n">other_in_self_frame</span><span class="o">.</span><span class="n">represent_as</span><span class="p">(</span><span class="n">UnitSphericalRepresentation</span><span class="p">)</span><span class="o">.</span><span class="n">lat</span>
        <span class="n">olon</span> <span class="o">=</span> <span class="n">other_in_self_frame</span><span class="o">.</span><span class="n">represent_as</span><span class="p">(</span><span class="n">UnitSphericalRepresentation</span><span class="p">)</span><span class="o">.</span><span class="n">lon</span>

        <span class="k">return</span> <span class="n">angle_utilities</span><span class="o">.</span><span class="n">position_angle</span><span class="p">(</span><span class="n">slon</span><span class="p">,</span> <span class="n">slat</span><span class="p">,</span> <span class="n">olon</span><span class="p">,</span> <span class="n">olat</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SkyCoord.get_constellation"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.get_constellation">[docs]</a>    <span class="k">def</span> <span class="nf">get_constellation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">short_name</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">constellation_list</span><span class="o">=</span><span class="s">&#39;iau&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines the constellation(s) of the coordinates this `SkyCoord`</span>
<span class="sd">        contains.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        short_name : bool</span>
<span class="sd">            If True, the returned names are the IAU-sanctioned abbreviated</span>
<span class="sd">            names.  Otherwise, full names for the constellations are used.</span>
<span class="sd">        constellation_list : str</span>
<span class="sd">            The set of constellations to use.  Currently only ``&#39;iau&#39;`` is</span>
<span class="sd">            supported, meaning the 88 &quot;modern&quot; constellations endorsed by the IAU.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        constellation : str or string array</span>
<span class="sd">            If this is a scalar coordinate, returns the name of the</span>
<span class="sd">            constellation.  If it is an array `SkyCoord`, it returns an array of</span>
<span class="sd">            names.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        To determine which constellation a point on the sky is in, this first</span>
<span class="sd">        precesses to B1875, and then uses the Delporte boundaries of the 88</span>
<span class="sd">        modern constellations, as tabulated by</span>
<span class="sd">        `Roman 1987 &lt;http://cdsarc.u-strasbg.fr/viz-bin/Cat?VI/42&gt;`_.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        astropy.coordinates.get_constellation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.funcs</span> <span class="kn">import</span> <span class="n">get_constellation</span>

        <span class="k">return</span> <span class="n">get_constellation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">short_name</span><span class="p">,</span> <span class="n">constellation_list</span><span class="p">)</span>

    <span class="c"># WCS pixel to/from sky conversions</span></div>
<div class="viewcode-block" id="SkyCoord.to_pixel"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.to_pixel">[docs]</a>    <span class="k">def</span> <span class="nf">to_pixel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wcs</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert this coordinate to pixel coordinates using a `~astropy.wcs.WCS`</span>
<span class="sd">        object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wcs : `~astropy.wcs.WCS`</span>
<span class="sd">            The WCS to use for convert</span>
<span class="sd">        origin : int</span>
<span class="sd">            Whether to return 0 or 1-based pixel coordinates.</span>
<span class="sd">        mode : &#39;all&#39; or &#39;wcs&#39;</span>
<span class="sd">            Whether to do the transformation including distortions (``&#39;all&#39;``) or</span>
<span class="sd">            only including only the core WCS transformation (``&#39;wcs&#39;``).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xp, yp : `numpy.ndarray`</span>
<span class="sd">            The pixel coordinates</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        astropy.wcs.utils.skycoord_to_pixel : the implementation of this method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wcs</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="SkyCoord.from_pixel"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.from_pixel">[docs]</a>    <span class="k">def</span> <span class="nf">from_pixel</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">wcs</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new `SkyCoord` from pixel coordinates using an</span>
<span class="sd">        `~astropy.wcs.WCS` object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xp, yp : float or `numpy.ndarray`</span>
<span class="sd">            The coordinates to convert.</span>
<span class="sd">        wcs : `~astropy.wcs.WCS`</span>
<span class="sd">            The WCS to use for convert</span>
<span class="sd">        origin : int</span>
<span class="sd">            Whether to return 0 or 1-based pixel coordinates.</span>
<span class="sd">        mode : &#39;all&#39; or &#39;wcs&#39;</span>
<span class="sd">            Whether to do the transformation including distortions (``&#39;all&#39;``) or</span>
<span class="sd">            only including only the core WCS transformation (``&#39;wcs&#39;``).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        coord : an instance of this class</span>
<span class="sd">            A new object with sky coordinates corresponding to the input ``xp``</span>
<span class="sd">            and ``yp``.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        to_pixel : to do the inverse operation</span>
<span class="sd">        astropy.wcs.utils.pixel_to_skycoord : the implementation of this method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pixel_to_skycoord</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">wcs</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">cls</span><span class="o">=</span><span class="n">cls</span><span class="p">)</span>

    <span class="c"># Table interactions</span></div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="SkyCoord.guess_from_table"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.guess_from_table">[docs]</a>    <span class="k">def</span> <span class="nf">guess_from_table</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="o">**</span><span class="n">coord_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A convenience method to create and return a new `SkyCoord` from the data</span>
<span class="sd">        in an astropy Table.</span>

<span class="sd">        This method matches table columns that start with the case-insensitive</span>
<span class="sd">        names of the the components of the requested frames, if they are also</span>
<span class="sd">        followed by a non-alphanumeric character. It will also match columns</span>
<span class="sd">        that *end* with the component name if a non-alphanumeric character is</span>
<span class="sd">        *before* it.</span>

<span class="sd">        For example, the first rule means columns with names like</span>
<span class="sd">        ``&#39;RA[J2000]&#39;`` or ``&#39;ra&#39;`` will be interpreted as ``ra`` attributes for</span>
<span class="sd">        `~astropy.coordinates.ICRS` frames, but ``&#39;RAJ2000&#39;`` or ``&#39;radius&#39;``</span>
<span class="sd">        are *not*. Similarly, the second rule applied to the</span>
<span class="sd">        `~astropy.coordinates.Galactic` frame means that a column named</span>
<span class="sd">        ``&#39;gal_l&#39;`` will be used as the the ``l`` component, but ``gall`` or</span>
<span class="sd">        ``&#39;fill&#39;`` will not.</span>

<span class="sd">        The definition of alphanumeric here is based on Unicode&#39;s definition</span>
<span class="sd">        of alphanumeric, except without ``_`` (which is normally considered</span>
<span class="sd">        alphanumeric).  So for ASCII, this means the non-alphanumeric characters</span>
<span class="sd">        are ``&lt;space&gt;_!&quot;#$%&amp;&#39;()*+,-./:;&lt;=&gt;?@[\]^`{|}~``).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : astropy.Table</span>
<span class="sd">            The table to load data from.</span>
<span class="sd">        coord_kwargs</span>
<span class="sd">            Any additional keyword arguments are passed directly to this class&#39;s</span>
<span class="sd">            constructor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        newsc : same as this class</span>
<span class="sd">            The new `SkyCoord` (or subclass) object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inital_frame</span> <span class="o">=</span> <span class="n">coord_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;frame&#39;</span><span class="p">)</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">_get_frame</span><span class="p">([],</span> <span class="n">coord_kwargs</span><span class="p">)</span>
        <span class="n">coord_kwargs</span><span class="p">[</span><span class="s">&#39;frame&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inital_frame</span>

        <span class="n">comp_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation_component_names</span><span class="p">:</span>
            <span class="c"># this matches things like &#39;ra[...]&#39;&#39; but *not* &#39;rad&#39;.</span>
            <span class="c"># note that the &quot;_&quot; must be in there explicitly, because</span>
            <span class="c"># &quot;alphanumeric&quot; usually includes underscores.</span>
            <span class="n">starts_with_comp</span> <span class="o">=</span> <span class="n">comp_name</span> <span class="o">+</span> <span class="s">r&#39;(\W|\b|_)&#39;</span>
            <span class="c"># this part matches stuff like &#39;center_ra&#39;, but *not*</span>
            <span class="c"># &#39;aura&#39;</span>
            <span class="n">ends_with_comp</span> <span class="o">=</span> <span class="s">r&#39;.*(\W|\b|_)&#39;</span> <span class="o">+</span> <span class="n">comp_name</span> <span class="o">+</span> <span class="s">r&#39;\b&#39;</span>
            <span class="c">#the final regex ORs together the two patterns</span>
            <span class="n">rex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;(&#39;</span> <span class="o">+</span><span class="n">starts_with_comp</span> <span class="o">+</span> <span class="s">&#39;)|(&#39;</span> <span class="o">+</span> <span class="n">ends_with_comp</span> <span class="o">+</span> <span class="s">&#39;)&#39;</span><span class="p">,</span>
                             <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">colnames</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">col_name</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="n">comp_kwargs</span><span class="p">:</span>
                        <span class="n">oldname</span> <span class="o">=</span> <span class="n">comp_kwargs</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;Found at least two matches for  component &quot;{0}&quot;&#39;</span>
                               <span class="s">&#39;: &quot;{1}&quot; and &quot;{2}&quot;. Cannot continue with this &#39;</span>
                               <span class="s">&#39;ambiguity.&#39;</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">comp_name</span><span class="p">,</span> <span class="n">oldname</span><span class="p">,</span> <span class="n">col_name</span><span class="p">))</span>
                    <span class="n">comp_kwargs</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">comp_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">coord_kwargs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Found column &quot;{0}&quot; in table, but it was &#39;</span>
                                 <span class="s">&#39;already provided as &quot;{1}&quot; keyword to &#39;</span>
                                 <span class="s">&#39;guess_from_table function.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coord_kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="o">**</span><span class="n">coord_kwargs</span><span class="p">)</span>

    <span class="c"># Name resolve</span></div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="SkyCoord.from_name"><a class="viewcode-back" href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.from_name">[docs]</a>    <span class="k">def</span> <span class="nf">from_name</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s">&#39;icrs&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a name, query the CDS name resolver to attempt to retrieve</span>
<span class="sd">        coordinate information for that object. The search database, sesame</span>
<span class="sd">        url, and  query timeout can be set through configuration items in</span>
<span class="sd">        ``astropy.coordinates.name_resolve`` -- see docstring for</span>
<span class="sd">        `~astropy.coordinates.get_icrs_coordinates` for more</span>
<span class="sd">        information.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the object to get coordinates for, e.g. ``&#39;M42&#39;``.</span>
<span class="sd">        frame : str or `BaseCoordinateFrame` class or instance</span>
<span class="sd">            The frame to transform the object to.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        coord : SkyCoord</span>
<span class="sd">            Instance of the SkyCoord class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">.name_resolve</span> <span class="kn">import</span> <span class="n">get_icrs_coordinates</span>

        <span class="n">icrs_coord</span> <span class="o">=</span> <span class="n">get_icrs_coordinates</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">icrs_sky_coord</span> <span class="o">=</span> <span class="n">cls</span><span class="p">(</span><span class="n">icrs_coord</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;icrs&#39;</span><span class="p">,</span> <span class="n">icrs_coord</span><span class="o">.</span><span class="n">__class__</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">icrs_sky_coord</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">icrs_sky_coord</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>


<span class="c"># &lt;----------------Private utility functions below here-------------------------&gt;</span>

</div></div>
<span class="k">def</span> <span class="nf">_get_frame_class</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a frame class from the input `frame`, which could be a frame name</span>
<span class="sd">    string, or frame class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">inspect</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
        <span class="n">frame_names</span> <span class="o">=</span> <span class="n">frame_transform_graph</span><span class="o">.</span><span class="n">get_names</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">frame_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Coordinate frame {0} not in allowed values {1}&#39;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">frame_names</span><span class="p">)))</span>
        <span class="n">frame_cls</span> <span class="o">=</span> <span class="n">frame_transform_graph</span><span class="o">.</span><span class="n">lookup_name</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">):</span>
        <span class="n">frame_cls</span> <span class="o">=</span> <span class="n">frame</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Coordinate frame must be a frame name or frame class&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">frame_cls</span>


<span class="k">def</span> <span class="nf">_get_frame</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the coordinate frame from input SkyCoord args and kwargs.  This</span>
<span class="sd">    modifies args and/or kwargs in-place to remove the item that provided</span>
<span class="sd">    `frame`.  It also infers the frame if an input coordinate was provided and</span>
<span class="sd">    checks for conflicts.</span>

<span class="sd">    This allows for frame to be specified as a string like &#39;icrs&#39; or a frame</span>
<span class="sd">    class like ICRS, but not an instance ICRS() since the latter could have</span>
<span class="sd">    non-default representation attributes which would require a three-way merge.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;frame&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

        <span class="c"># We do not allow frames to be passed as positional arguments if data</span>
        <span class="c"># is passed separately from frame.</span>

        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyCoord</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;{0} instance cannot be passed as a positional &quot;</span>
                                 <span class="s">&quot;argument for the frame, pass it using the &quot;</span>
                                 <span class="s">&quot;frame= keyword instead.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>

    <span class="c"># If the frame is an instance or SkyCoord, we split up the attributes and</span>
    <span class="c"># make it into a class.</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">):</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">frame</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">get_frame_attr_names</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;cannot specify frame attribute &#39;{0}&#39; directly in SkyCoord since a frame instance was passed in&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">__class__</span>

    <span class="k">if</span> <span class="n">frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># Frame was provided as kwarg so validate and coerce into corresponding frame.</span>
        <span class="n">frame_cls</span> <span class="o">=</span> <span class="n">_get_frame_class</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">frame_specified_explicitly</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># Look for the frame in args</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">frame_cls</span> <span class="o">=</span> <span class="n">_get_frame_class</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="n">frame_specified_explicitly</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Passing a frame as a positional argument is now &quot;</span>
                              <span class="s">&quot;deprecated, use the frame= keyword argument &quot;</span>
                              <span class="s">&quot;instead.&quot;</span><span class="p">,</span> <span class="n">AstropyDeprecationWarning</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Not in args nor kwargs - default to icrs</span>
            <span class="n">frame_cls</span> <span class="o">=</span> <span class="n">ICRS</span>
            <span class="n">frame_specified_explicitly</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c"># Check that the new frame doesn&#39;t conflict with existing coordinate frame</span>
    <span class="c"># if a coordinate is supplied in the args list.  If the frame still had not</span>
    <span class="c"># been set by this point and a coordinate was supplied, then use that frame.</span>
    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">coord_frame_cls</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">):</span>
            <span class="n">coord_frame_cls</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">__class__</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">):</span>
            <span class="n">coord_frame_cls</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">__class__</span>

        <span class="k">if</span> <span class="n">coord_frame_cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">frame_specified_explicitly</span><span class="p">:</span>
                <span class="n">frame_cls</span> <span class="o">=</span> <span class="n">coord_frame_cls</span>
            <span class="k">elif</span> <span class="n">frame_cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">coord_frame_cls</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Cannot override frame=&#39;{0}&#39; of input coordinate with &quot;</span>
                                 <span class="s">&quot;new frame=&#39;{1}&#39;.  Instead transform the coordinate.&quot;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coord_frame_cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">frame_cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>

    <span class="k">if</span> <span class="s">&#39;representation&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame_cls</span><span class="p">(</span><span class="n">representation</span><span class="o">=</span><span class="n">_get_repr_cls</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;representation&#39;</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame_cls</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">frame</span>


<span class="k">def</span> <span class="nf">_get_units</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the longitude unit and latitude unit from kwargs.  Possible enhancement</span>
<span class="sd">    is to allow input from args as well.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s">&#39;unit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;unit&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">units</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)]</span>
            <span class="c"># Allow for input like unit=&#39;deg&#39; or unit=&#39;m&#39;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="p">(</span><span class="n">Unit</span><span class="p">,</span> <span class="n">IrreducibleUnit</span><span class="p">)):</span>
            <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="n">units</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">units</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Unit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="bp">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">units</span><span class="p">]</span>
            <span class="n">units</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Unit keyword must have one to three unit values as &#39;</span>
                             <span class="s">&#39;tuple or comma-separated string&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">units</span>


<span class="k">def</span> <span class="nf">_parse_coordinate_arg</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">init_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single unnamed arg supplied.  This must be:</span>
<span class="sd">    - Coordinate frame with data</span>
<span class="sd">    - Representation</span>
<span class="sd">    - SkyCoord</span>
<span class="sd">    - List or tuple of:</span>
<span class="sd">      - String which splits into two values</span>
<span class="sd">      - Iterable with two values</span>
<span class="sd">      - SkyCoord, frame, or representation objects.</span>

<span class="sd">    Returns a dict mapping coordinate attribute names to values (or lists of</span>
<span class="sd">    values)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_scalar</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c"># Differentiate between scalar and list input</span>
    <span class="n">valid_kwargs</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c"># Returned dict of lon, lat, and distance (optional)</span>

    <span class="n">frame_attr_names</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation_component_names</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">repr_attr_names</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation_component_names</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="n">repr_attr_classes</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation</span><span class="o">.</span><span class="n">attr_classes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="n">n_attr_names</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">repr_attr_names</span><span class="p">)</span>

    <span class="c"># Turn a single string into a list of strings for convenience</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
        <span class="n">is_scalar</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">coords</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyCoord</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">)):</span>
        <span class="c"># Note that during parsing of `frame` it is checked that any coordinate</span>
        <span class="c"># args have the same frame as explicitly supplied, so don&#39;t worry here.</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">coords</span><span class="o">.</span><span class="n">has_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Cannot initialize from a frame without coordinate data&#39;</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">represent_as</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">representation</span><span class="p">)</span>

        <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># List of values corresponding to representation attrs</span>
        <span class="k">for</span> <span class="n">repr_attr_name</span> <span class="ow">in</span> <span class="n">repr_attr_names</span><span class="p">:</span>
            <span class="c"># If coords did not have an explicit distance then don&#39;t include in initializers.</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">UnitSphericalRepresentation</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="n">repr_attr_name</span> <span class="o">==</span> <span class="s">&#39;distance&#39;</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c"># Get the value from `data` in the eventual representation</span>
            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">repr_attr_name</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">FRAME_ATTR_NAMES_SET</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">use_value</span> <span class="o">=</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">)</span>
                         <span class="ow">or</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">coords</span><span class="o">.</span><span class="n">_attr_names_with_defaults</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">use_value</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">valid_kwargs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">BaseRepresentation</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">represent_as</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">representation</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">repr_attr_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">repr_attr_name</span> <span class="ow">in</span> <span class="n">repr_attr_names</span><span class="p">]</span>

    <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">coords</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="ow">in</span> <span class="s">&#39;if&#39;</span>
          <span class="ow">and</span> <span class="n">coords</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">):</span>
        <span class="c"># 2-d array of coordinate values.  Handle specially for efficiency.</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  <span class="c"># Iterates over repr attrs</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="c"># Handles list-like input.</span>

        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">is_ra_dec_representation</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;ra&#39;</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation_component_names</span> <span class="ow">and</span>
                                    <span class="s">&#39;dec&#39;</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation_component_names</span><span class="p">)</span>
        <span class="n">coord_types</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkyCoord</span><span class="p">,</span> <span class="n">BaseCoordinateFrame</span><span class="p">,</span> <span class="n">BaseRepresentation</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">coord_types</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">):</span>
            <span class="c"># this parsing path is used when there are coordinate-like objects</span>
            <span class="c"># in the list - instead of creating lists of values, we create</span>
            <span class="c"># SkyCoords from the list elements and then combine them.</span>
            <span class="n">scs</span> <span class="o">=</span> <span class="p">[</span><span class="n">SkyCoord</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="o">**</span><span class="n">init_kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]</span>

            <span class="c"># now check that they&#39;re all self-consistent in their frames and</span>
            <span class="c"># check if they are all UnitSphericalRepresentation internally</span>
            <span class="n">allunitsphrepr</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">for</span> <span class="n">sc</span> <span class="ow">in</span> <span class="n">scs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">sc</span><span class="o">.</span><span class="n">is_equivalent_frame</span><span class="p">(</span><span class="n">scs</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;List of inputs don&#39;t have equivalent &quot;</span>
                                     <span class="s">&quot;frames: {0} != {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">scs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">allunitsphrepr</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">UnitSphericalRepresentation</span><span class="p">):</span>
                    <span class="n">allunitsphrepr</span> <span class="o">=</span> <span class="bp">False</span>

            <span class="c"># get the frame attributes from the first one, because from above we</span>
            <span class="c"># know it matches all the others</span>
            <span class="k">for</span> <span class="n">fattrnm</span> <span class="ow">in</span> <span class="n">FRAME_ATTR_NAMES_SET</span><span class="p">():</span>
                <span class="n">valid_kwargs</span><span class="p">[</span><span class="n">fattrnm</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">scs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fattrnm</span><span class="p">)</span>

            <span class="c"># Now combine the values, to be used below</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">data_attr_name</span><span class="p">,</span> <span class="n">repr_attr_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">frame_attr_names</span><span class="p">,</span> <span class="n">repr_attr_names</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">allunitsphrepr</span> <span class="ow">and</span> <span class="n">repr_attr_name</span> <span class="o">==</span> <span class="s">&#39;distance&#39;</span><span class="p">:</span>
                    <span class="c">#if they are *all* UnitSpherical, don&#39;t give a distance</span>
                    <span class="k">continue</span>
                <span class="n">data_vals</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">sc</span> <span class="ow">in</span> <span class="n">scs</span><span class="p">:</span>
                    <span class="n">data_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">data_attr_name</span><span class="p">)</span>
                    <span class="n">data_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_val</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="k">if</span> <span class="n">sc</span><span class="o">.</span><span class="n">isscalar</span> <span class="k">else</span> <span class="n">data_val</span><span class="p">)</span>
                <span class="n">concat_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">data_vals</span><span class="p">)</span>
                <span class="c"># Hack because np.concatenate doesn&#39;t fully work with Quantity</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">concat_vals</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
                    <span class="n">concat_vals</span><span class="o">.</span><span class="n">_unit</span> <span class="o">=</span> <span class="n">data_val</span><span class="o">.</span><span class="n">unit</span>
                <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">concat_vals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#none of the elements are &quot;frame-like&quot;</span>
            <span class="c">#turn into a list of lists like [[v1_0, v2_0, v3_0], ... [v1_N, v2_N, v3_N]]</span>
            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
                    <span class="n">coord1</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                        <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coord1</span><span class="p">[:</span><span class="mi">3</span><span class="p">]),</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coord1</span><span class="p">[</span><span class="mi">3</span><span class="p">:]))</span>
                    <span class="k">elif</span> <span class="n">is_ra_dec_representation</span><span class="p">:</span>
                        <span class="n">coord</span> <span class="o">=</span> <span class="n">_parse_ra_dec</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">coord</span> <span class="o">=</span> <span class="n">coord1</span>
                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>  <span class="c"># Assumes coord is a sequence at this point</span>

            <span class="c"># Do some basic validation of the list elements: all have a length and all</span>
            <span class="c"># lengths the same</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">n_coords</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;One or more elements of input sequence does not have a length&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_coords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Input coordinate values must have same number of elements, found {0}&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_coords</span><span class="p">))</span>
            <span class="n">n_coords</span> <span class="o">=</span> <span class="n">n_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c"># Must have no more coord inputs than representation attributes</span>
            <span class="k">if</span> <span class="n">n_coords</span> <span class="o">&gt;</span> <span class="n">n_attr_names</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Input coordinates have {0} values but &#39;</span>
                                 <span class="s">&#39;representation {1} only accepts {2}&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_coords</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span> <span class="n">n_attr_names</span><span class="p">))</span>

            <span class="c"># Now transpose vals to get [(v1_0 .. v1_N), (v2_0 .. v2_N), (v3_0 .. v3_N)]</span>
            <span class="c"># (ok since we know it is exactly rectangular).  (Note: can&#39;t just use zip(*values)</span>
            <span class="c"># because Longitude et al distinguishes list from tuple so [a1, a2, ..] is needed</span>
            <span class="c"># while (a1, a2, ..) doesn&#39;t work.</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">)]</span>

            <span class="k">if</span> <span class="n">is_scalar</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Cannot parse coordinates from first argument&#39;</span><span class="p">)</span>

    <span class="c"># Finally we have a list of values from which to create the keyword args</span>
    <span class="c"># for the frame initialization.  Validate by running through the appropriate</span>
    <span class="c"># class initializer and supply units (which might be None).</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">frame_attr_name</span><span class="p">,</span> <span class="n">repr_attr_class</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">frame_attr_names</span><span class="p">,</span> <span class="n">repr_attr_classes</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
            <span class="n">valid_kwargs</span><span class="p">[</span><span class="n">frame_attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">repr_attr_class</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Cannot parse first argument data &quot;{0}&quot; for attribute &#39;</span>
                         <span class="s">&#39;{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">frame_attr_name</span><span class="p">),</span> <span class="n">err</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">valid_kwargs</span>


<span class="k">def</span> <span class="nf">_get_representation_attrs</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find instances of the &quot;representation attributes&quot; for specifying data</span>
<span class="sd">    for this frame.  Pop them off of kwargs, run through the appropriate class</span>
<span class="sd">    constructor (to validate and apply unit), and put into the output</span>
<span class="sd">    valid_kwargs.  &quot;Representation attributes&quot; are the frame-specific aliases</span>
<span class="sd">    for the underlying data values in the representation, e.g. &quot;ra&quot; for &quot;lon&quot;</span>
<span class="sd">    for many equatorial spherical representations, or &quot;w&quot; for &quot;x&quot; in the</span>
<span class="sd">    cartesian representation of Galactic.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frame_attr_names</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation_component_names</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">repr_attr_classes</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">representation</span><span class="o">.</span><span class="n">attr_classes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="n">valid_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">frame_attr_name</span><span class="p">,</span> <span class="n">repr_attr_class</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">frame_attr_names</span><span class="p">,</span> <span class="n">repr_attr_classes</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">frame_attr_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">valid_kwargs</span><span class="p">[</span><span class="n">frame_attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">repr_attr_class</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">valid_kwargs</span>


<span class="k">def</span> <span class="nf">_parse_ra_dec</span><span class="p">(</span><span class="n">coord_str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse RA and Dec values from a coordinate string. Currently the</span>
<span class="sd">    following formats are supported:</span>

<span class="sd">     * space separated 6-value format</span>
<span class="sd">     * space separated &lt;6-value format, this requires a plus or minus sign</span>
<span class="sd">       separation between RA and Dec</span>
<span class="sd">     * sign separated format</span>
<span class="sd">     * JHHMMSS.ss+DDMMSS.ss format, with up to two optional decimal digits</span>
<span class="sd">     * JDDDMMSS.ss+DDMMSS.ss format, with up to two optional decimal digits</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coord_str : str</span>
<span class="sd">        Coordinate string to parse.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coord : str or list of str</span>
<span class="sd">        Parsed coordinate values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord_str</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
        <span class="n">coord1</span> <span class="o">=</span> <span class="n">coord_str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># This exception should never be raised from SkyCoord</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;coord_str must be a single str&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coord1</span><span class="p">[:</span><span class="mi">3</span><span class="p">]),</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coord1</span><span class="p">[</span><span class="mi">3</span><span class="p">:]))</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="n">PLUS_MINUS_RE</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">coord_str</span><span class="p">)</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">match_j</span> <span class="o">=</span> <span class="n">J_PREFIXED_RA_DEC_RE</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">coord_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match_j</span><span class="p">:</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="n">match_j</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;{0} {1} {2}&#39;</span><span class="o">.</span>
                         <span class="n">format</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">:]),</span>
                         <span class="s">&#39;{0} {1} {2}&#39;</span><span class="o">.</span>
                         <span class="n">format</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">5</span><span class="p">:]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;{0} {1} {2}&#39;</span><span class="o">.</span>
                         <span class="n">format</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">:]),</span>
                         <span class="s">&#39;{0} {1} {2}&#39;</span><span class="o">.</span>
                         <span class="n">format</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">5</span><span class="p">:]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="n">PLUS_MINUS_RE</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">coord_str</span><span class="p">)</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="n">coord1</span>

    <span class="k">return</span> <span class="n">coord</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1. &nbsp;
    Last built 12 May 2016. <br/>
  </p>
</footer>
  </body>
</html>