<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>astropy.cosmology.core &mdash; Astropy v1.2.dev14996</title>
    
    <link rel="stylesheet" href="../../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.2.dev14996',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev14996" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../../../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">Astropy v1.2.dev14996</a>
	 &raquo;
      </li>
      <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for astropy.cosmology.core</h1><div class="highlight"><pre>
<span class="c"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">..extern</span> <span class="kn">import</span> <span class="n">six</span>
<span class="kn">from</span> <span class="nn">..extern.six.moves</span> <span class="kn">import</span> <span class="nb">map</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">floor</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">scalar_inv_efuncs</span>

<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">isiterable</span><span class="p">,</span> <span class="n">deprecated</span>
<span class="kn">from</span> <span class="nn">..utils.compat.funcsigs</span> <span class="kn">import</span> <span class="n">signature</span>
<span class="kn">from</span> <span class="nn">..utils.state</span> <span class="kn">import</span> <span class="n">ScienceState</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">parameters</span>

<span class="c"># Originally authored by Andrew Becker (becker@astro.washington.edu),</span>
<span class="c"># and modified by Neil Crighton (neilcrighton@gmail.com) and Roban</span>
<span class="c"># Kramer (robanhk@gmail.com).</span>

<span class="c"># Many of these adapted from Hogg 1999, astro-ph/9905116</span>
<span class="c"># and Linder 2003, PRL 90, 91301</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;FLRW&quot;</span><span class="p">,</span> <span class="s">&quot;LambdaCDM&quot;</span><span class="p">,</span> <span class="s">&quot;FlatLambdaCDM&quot;</span><span class="p">,</span> <span class="s">&quot;wCDM&quot;</span><span class="p">,</span> <span class="s">&quot;FlatwCDM&quot;</span><span class="p">,</span>
           <span class="s">&quot;Flatw0waCDM&quot;</span><span class="p">,</span> <span class="s">&quot;w0waCDM&quot;</span><span class="p">,</span> <span class="s">&quot;wpwaCDM&quot;</span><span class="p">,</span> <span class="s">&quot;w0wzCDM&quot;</span><span class="p">,</span> <span class="s">&quot;WMAP5&quot;</span><span class="p">,</span> <span class="s">&quot;WMAP7&quot;</span><span class="p">,</span>
           <span class="s">&quot;WMAP9&quot;</span><span class="p">,</span> <span class="s">&quot;Planck13&quot;</span><span class="p">,</span> <span class="s">&quot;Planck15&quot;</span><span class="p">,</span> <span class="s">&quot;default_cosmology&quot;</span><span class="p">]</span>

<span class="n">__doctest_requires__</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;*&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;scipy.integrate&#39;</span><span class="p">]}</span>

<span class="c"># Notes about speeding up integrals:</span>
<span class="c"># ---------------------------------</span>
<span class="c">#  The supplied cosmology classes use a few tricks to speed</span>
<span class="c">#  up distance and time integrals.  It is not necessary for</span>
<span class="c">#  anyone subclassing FLRW to use these tricks -- but if they</span>
<span class="c">#  do, such calculations may be a lot faster.</span>
<span class="c"># The first, more basic, idea is that, in many cases, it&#39;s a big deal to</span>
<span class="c">#  provide explicit formulae for inv_efunc rather than simply</span>
<span class="c">#  setting up de_energy_scale -- assuming there is a nice expression.</span>
<span class="c">#  As noted above, almost all of the provided classes do this, and</span>
<span class="c">#  that template can pretty much be followed directly with the appropriate</span>
<span class="c">#  formula changes.</span>
<span class="c"># The second, and more advanced, option is to also explicitly</span>
<span class="c">#  provide a scalar only version of inv_efunc.  This results in a fairly</span>
<span class="c">#  large speedup (&gt;10x in most cases) in the distance and age integrals,</span>
<span class="c">#  even if only done in python,  because testing whether the inputs are</span>
<span class="c">#  iterable or pure scalars turns out to be rather expensive. To take</span>
<span class="c">#  advantage of this, the key thing is to explicitly set the</span>
<span class="c">#  instance variables self._inv_efunc_scalar and self._inv_efunc_scalar_args</span>
<span class="c">#  in the constructor for the subclass, where the latter are all the</span>
<span class="c">#  arguments except z to _inv_efunc_scalar.</span>
<span class="c">#</span>
<span class="c">#  The provided classes do use this optimization, and in fact go</span>
<span class="c">#  even further and provide optimizations for no radiation, and for radiation</span>
<span class="c">#  with massless neutrinos coded in cython.  Consult the subclasses for</span>
<span class="c">#  details, and scalar_inv_efuncs for the details.</span>
<span class="c">#</span>
<span class="c">#  However, the important point is that it is -not- necessary to do this.</span>

<span class="c"># Some conversion constants -- useful to compute them once here</span>
<span class="c">#  and reuse in the initialization rather than have every object do them</span>
<span class="c"># Note that the call to cgs is actually extremely expensive,</span>
<span class="c">#  so we actually skip using the units package directly, and</span>
<span class="c">#  hardwire the conversion from mks to cgs. This assumes that constants</span>
<span class="c">#  will always return mks by default -- if this is made faster for simple</span>
<span class="c">#  cases like this, it should be changed back.</span>
<span class="c"># Note that the unit tests should catch it if this happens</span>
<span class="n">H0units_to_invs</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">km</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="n">sec_to_Gyr</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span>
<span class="c"># const in critical density in cgs units (g cm^-3)</span>
<span class="n">critdens_const</span> <span class="o">=</span> <span class="mf">3.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8.</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">G</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">arcsec_in_radians</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3600.</span> <span class="o">*</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">arcmin_in_radians</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mf">60.</span> <span class="o">*</span> <span class="mi">180</span><span class="p">)</span>
<span class="c"># Radiation parameter over c^2 in cgs (g cm^-3 K^-4)</span>
<span class="n">a_B_c2</span> <span class="o">=</span> <span class="mf">4e-3</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">const</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="o">**</span> <span class="mi">3</span>
<span class="c"># Boltzmann constant in eV / K</span>
<span class="n">kB_evK</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">k_B</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">eV</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CosmologyError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">Cosmology</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Placeholder for when a more general Cosmology class is</span>
<span class="sd">    implemented. &quot;&quot;&quot;</span>


<span class="nd">@six.add_metaclass</span><span class="p">(</span><span class="n">ABCMeta</span><span class="p">)</span>
<div class="viewcode-block" id="FLRW"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW">[docs]</a><span class="k">class</span> <span class="nc">FLRW</span><span class="p">(</span><span class="n">Cosmology</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A class describing an isotropic and homogeneous</span>
<span class="sd">    (Friedmann-Lemaitre-Robertson-Walker) cosmology.</span>

<span class="sd">    This is an abstract base class -- you can&#39;t instantiate</span>
<span class="sd">    examples of this class, but must work with one of its</span>
<span class="sd">    subclasses such as `LambdaCDM` or `wCDM`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    H0 : float or scalar `~astropy.units.Quantity`</span>
<span class="sd">        Hubble constant at z = 0.  If a float, must be in [km/sec/Mpc]</span>

<span class="sd">    Om0 : float</span>
<span class="sd">        Omega matter: density of non-relativistic matter in units of the</span>
<span class="sd">        critical density at z=0.  Note that this does not include</span>
<span class="sd">        massive neutrinos.</span>

<span class="sd">    Ode0 : float</span>
<span class="sd">        Omega dark energy: density of dark energy in units of the critical</span>
<span class="sd">        density at z=0.</span>

<span class="sd">    Tcmb0 : float or scalar `~astropy.units.Quantity`, optional</span>
<span class="sd">        Temperature of the CMB z=0. If a float, must be in [K].</span>
<span class="sd">        Default: 2.725 [K]. Setting this to zero will turn off both photons</span>
<span class="sd">        and neutrinos (even massive ones).</span>

<span class="sd">    Neff : float, optional</span>
<span class="sd">        Effective number of Neutrino species. Default 3.04.</span>

<span class="sd">    m_nu : `~astropy.units.Quantity`, optional</span>
<span class="sd">        Mass of each neutrino species. If this is a scalar Quantity, then all</span>
<span class="sd">        neutrino species are assumed to have that mass. Otherwise, the mass of</span>
<span class="sd">        each species. The actual number of neutrino species (and hence the</span>
<span class="sd">        number of elements of m_nu if it is not scalar) must be the floor of</span>
<span class="sd">        Neff. Typically this means you should provide three neutrino masses</span>
<span class="sd">        unless you are considering something like a sterile neutrino.</span>

<span class="sd">    Ob0 : float or None, optional</span>
<span class="sd">        Omega baryons: density of baryonic matter in units of the critical</span>
<span class="sd">        density at z=0.  If this is set to None (the default), any</span>
<span class="sd">        computation that requires its value will raise an exception.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        Name for this cosmological object.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Class instances are static -- you can&#39;t change the values</span>
<span class="sd">    of the parameters.  That is, all of the attributes above are</span>
<span class="sd">    read only.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span> <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span>
                 <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span> <span class="n">Ob0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="c"># all densities are in units of the critical density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Om0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Matter density can not be negative&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Ode0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Ob0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Ob0</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Baryonic density can not be negative&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Baryonic density can not be larger than &quot;</span>
                                 <span class="s">&quot;total matter density&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Odm0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Odm0</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Neff</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Effective number of neutrinos can &quot;</span>
                             <span class="s">&quot;not be negative&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c"># Tcmb may have units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">Tcmb0</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">isscalar</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Tcmb0 is a non-scalar quantity&quot;</span><span class="p">)</span>

        <span class="c"># Hubble parameter at z=0, km/s/Mpc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">H0</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">km</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="o">.</span><span class="n">isscalar</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;H0 is a non-scalar quantity&quot;</span><span class="p">)</span>

        <span class="c"># 100 km/s/Mpc * h = H0 (so h is dimensionless)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="mf">100.</span>
        <span class="c"># Hubble distance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span> <span class="o">=</span> <span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">)</span>
        <span class="c"># H0 in s^-1; don&#39;t use units for speed</span>
        <span class="n">H0_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">H0units_to_invs</span>
        <span class="c"># Hubble time; again, avoiding units package for speed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">sec_to_Gyr</span> <span class="o">/</span> <span class="n">H0_s</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span>

        <span class="c"># critical density at z=0 (grams per cubic cm)</span>
        <span class="n">cd0value</span> <span class="o">=</span> <span class="n">critdens_const</span> <span class="o">*</span> <span class="n">H0_s</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_critical_density0</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">cd0value</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>

        <span class="c"># Load up neutrino masses.  Note: in Py2.x, floor is floating</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nneutrinos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span><span class="p">))</span>

        <span class="c"># We are going to share Neff between the neutrinos equally.</span>
        <span class="c"># In detail this is not correct, but it is a standard assumption</span>
        <span class="c"># because properly calculating it is a) complicated b) depends</span>
        <span class="c"># on the details of the massive neutrinos (e.g., their weak</span>
        <span class="c"># interactions, which could be unusual if one is considering sterile</span>
        <span class="c"># neutrinos)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nneutrinos</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nneutrinos</span>

            <span class="c"># We can&#39;t use the u.Quantity constructor as we do above</span>
            <span class="c"># because it doesn&#39;t understand equivalencies</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m_nu</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;m_nu must be a Quantity&quot;</span><span class="p">)</span>

            <span class="n">m_nu</span> <span class="o">=</span> <span class="n">m_nu</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">,</span> <span class="n">equivalencies</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">mass_energy</span><span class="p">())</span>

            <span class="c"># Now, figure out if we have massive neutrinos to deal with,</span>
            <span class="c"># and, if so, get the right number of masses</span>
            <span class="c"># It is worth the effort to keep track of massless ones separately</span>
            <span class="c"># (since they are quite easy to deal with, and a common use case</span>
            <span class="c"># is to set only one neutrino to have mass)</span>
            <span class="k">if</span> <span class="n">m_nu</span><span class="o">.</span><span class="n">isscalar</span><span class="p">:</span>
                <span class="c"># Assume all neutrinos have the same mass</span>
                <span class="k">if</span> <span class="n">m_nu</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nneutrinos</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_nmassivenu</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_nmassivenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nneutrinos</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu_mass</span> <span class="o">=</span> <span class="p">(</span><span class="n">m_nu</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span>
                                            <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nneutrinos</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># Make sure we have the right number of masses</span>
                <span class="c"># -unless- they are massless, in which case we cheat a little</span>
                <span class="k">if</span> <span class="n">m_nu</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Invalid (negative) neutrino mass&quot;</span>
                                     <span class="s">&quot; encountered&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">m_nu</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nneutrinos</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_nmassivenu</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">m_nu</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nneutrinos</span><span class="p">:</span>
                        <span class="n">errstr</span> <span class="o">=</span> <span class="s">&quot;Unexpected number of neutrino masses&quot;</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errstr</span><span class="p">)</span>
                    <span class="c"># Segregate out the massless ones</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">m_nu</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_nmassivenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nneutrinos</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">m_nu</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu_mass</span> <span class="o">=</span> <span class="n">m_nu</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>

        <span class="c"># Compute photon density, Tcmb, neutrino parameters</span>
        <span class="c"># Tcmb0=0 removes both photons and neutrinos, is handled</span>
        <span class="c"># as a special case for efficiency</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># Compute photon density from Tcmb</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">=</span> <span class="n">a_B_c2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">/</span>\
                <span class="bp">self</span><span class="o">.</span><span class="n">_critical_density0</span><span class="o">.</span><span class="n">value</span>

            <span class="c"># Compute Neutrino temperature</span>
            <span class="c"># The constant in front is (4/11)^1/3 -- see any</span>
            <span class="c">#  cosmology book for an explanation -- for example,</span>
            <span class="c">#  Weinberg &#39;Cosmology&#39; p 154 eq (3.1.21)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Tnu0</span> <span class="o">=</span> <span class="mf">0.7137658555036082</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span>

            <span class="c"># Compute Neutrino Omega and total relativistic component</span>
            <span class="c"># for massive neutrinos.  We also store a list version,</span>
            <span class="c"># since that is more efficient to do integrals with (perhaps</span>
            <span class="c"># surprisingly!  But small python lists are more efficient</span>
            <span class="c"># than small numpy arrays).</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
                <span class="n">nu_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu_mass</span> <span class="o">/</span> <span class="p">(</span><span class="n">kB_evK</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tnu0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y</span> <span class="o">=</span> <span class="n">nu_y</span><span class="o">.</span><span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># This case is particularly simple, so do it directly</span>
                <span class="c"># The 0.2271... is 7/8 (4/11)^(4/3) -- the temperature</span>
                <span class="c"># bit ^4 (blackbody energy density) times 7/8 for</span>
                <span class="c"># FD vs. BE statistics.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span> <span class="o">=</span> <span class="mf">0.22710731766</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Tnu0</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c"># Compute curvature density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>

        <span class="c"># Subclasses should override this reference if they provide</span>
        <span class="c">#  more efficient scalar versions of inv_efunc.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">_namelead</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Helper function for constructing __repr__&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;{0}(&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;{0}(name=</span><span class="se">\&quot;</span><span class="s">{1}</span><span class="se">\&quot;</span><span class="s">, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retstr</span> <span class="o">=</span> <span class="s">&quot;{0}H0={1:.3g}, Om0={2:.3g}, Ode0={3:.3g}, &quot;</span>\
                 <span class="s">&quot;Tcmb0={4:.4g}, Neff={5:.3g}, m_nu={6}, &quot;</span>\
                 <span class="s">&quot;Ob0={7:s})&quot;</span>
        <span class="k">return</span> <span class="n">retstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_namelead</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nu</span><span class="p">,</span>
                             <span class="n">_float_or_none</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span><span class="p">))</span>

    <span class="c"># Set up a set of properties for H0, Om0, Ode0, Ok0, etc. for user access.</span>
    <span class="c"># Note that we don&#39;t let these be set (so, obj.Om0 = value fails)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">H0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the Hubble constant as an `~astropy.units.Quantity` at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Om0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega matter; matter density/critical density at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Ode0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega dark energy; dark energy density/critical density at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Ob0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega baryon; baryonic matter density/critical density at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Odm0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega dark matter; dark matter density/critical density at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Odm0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Ok0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega curvature; the effective curvature density/critical density</span>
<span class="sd">        at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Tcmb0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Temperature of the CMB as `~astropy.units.Quantity` at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Tnu0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Temperature of the neutrino background as `~astropy.units.Quantity` at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tnu0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Neff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Number of effective neutrino species&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_massive_nu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Does this cosmology have at least one massive neutrino species?&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tnu0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">m_nu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Mass of neutrino species&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tnu0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="c"># Only massless</span>
            <span class="k">return</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">),</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">,</span>
                              <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># Only massive</span>
            <span class="k">return</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_massivenu_mass</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">,</span>
                              <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="c"># A mix -- the most complicated case</span>
        <span class="n">numass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu_mass</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">numass</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dimensionless Hubble constant: h = H_0 / 100 [km/sec/Mpc]&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hubble_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Hubble time as `~astropy.units.Quantity`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hubble_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Hubble distance as `~astropy.units.Quantity`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">critical_density0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Critical density as `~astropy.units.Quantity` at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_critical_density0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Ogamma0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega gamma; the density/critical density of photons at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Onu0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Omega nu; the density/critical density of neutrinos at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>

<div class="viewcode-block" id="FLRW.clone"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns a copy of this object, potentially with some changes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        newcos : Subclass of FLRW</span>
<span class="sd">        A new instance of this class with the specified changes.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This assumes that the values of all constructor arguments</span>
<span class="sd">        are available as properties, which is true of all the provided</span>
<span class="sd">        subclasses but may not be true of user-provided ones.  You can&#39;t</span>
<span class="sd">        change the type of class, so this can&#39;t be used to change between</span>
<span class="sd">        flat and non-flat.  If no modifications are requested, then</span>
<span class="sd">        a reference to this object is returned.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        To make a copy of the Planck13 cosmology with a different Omega_m</span>
<span class="sd">        and a new name:</span>

<span class="sd">        &gt;&gt;&gt; from astropy.cosmology import Planck13</span>
<span class="sd">        &gt;&gt;&gt; newcos = Planck13.clone(name=&quot;Modified Planck 2013&quot;, Om0=0.35)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Quick return check, taking advantage of the</span>
        <span class="c"># immutability of cosmological objects</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c"># Get constructor arguments</span>
        <span class="n">arglist</span> <span class="o">=</span> <span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__init__</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="c"># Build the dictionary of values used to construct this</span>
        <span class="c">#  object.  This -assumes- every argument to __init__ has a</span>
        <span class="c">#  property.  This is true of all the classes we provide, but</span>
        <span class="c">#  maybe a user won&#39;t do that.  So at least try to have a useful</span>
        <span class="c">#  error message.</span>
        <span class="n">argdict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arglist</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
                <span class="n">argdict</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="c"># We didn&#39;t find a property -- complain usefully</span>
                <span class="n">errstr</span> <span class="o">=</span> <span class="s">&quot;Object did not have property corresponding &quot;</span>\
                         <span class="s">&quot;to constructor argument &#39;</span><span class="si">%s</span><span class="s">&#39;; perhaps it is a &quot;</span>\
                         <span class="s">&quot;user provided subclass that does not do so&quot;</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">errstr</span> <span class="o">%</span> <span class="n">arg</span><span class="p">)</span>

        <span class="c"># Now substitute in new arguments</span>
        <span class="k">for</span> <span class="n">newarg</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">newarg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">argdict</span><span class="p">:</span>
                <span class="n">errstr</span> <span class="o">=</span> <span class="s">&quot;User provided argument &#39;</span><span class="si">%s</span><span class="s">&#39; not found in &quot;</span>\
                         <span class="s">&quot;constructor for this object&quot;</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">errstr</span> <span class="o">%</span> <span class="n">newarg</span><span class="p">)</span>
            <span class="n">argdict</span><span class="p">[</span><span class="n">newarg</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">newarg</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">argdict</span><span class="p">)</span>
</div>
    <span class="nd">@abstractmethod</span>
<div class="viewcode-block" id="FLRW.w"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The dark energy equation of state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.</span>

<span class="sd">        This must be overridden by subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;w(z) is not implemented&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.Om"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.Om">[docs]</a>    <span class="k">def</span> <span class="nf">Om</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for non-relativistic matter</span>
<span class="sd">        at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Om : ndarray, or float if input scalar</span>
<span class="sd">          The density of non-relativistic matter relative to the critical</span>
<span class="sd">          density at each redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This does not include neutrinos, even if non-relativistic</span>
<span class="sd">        at the redshift of interest; see `Onu`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Ob"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.Ob">[docs]</a>    <span class="k">def</span> <span class="nf">Ob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for baryonic matter at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Ob : ndarray, or float if input scalar</span>
<span class="sd">          The density of baryonic matter relative to the critical density at</span>
<span class="sd">          each redshift.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">          If Ob0 is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Baryon density not set for this cosmology&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Odm"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.Odm">[docs]</a>    <span class="k">def</span> <span class="nf">Odm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for dark matter at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Odm : ndarray, or float if input scalar</span>
<span class="sd">          The density of non-relativistic dark matter relative to the critical</span>
<span class="sd">          density at each redshift.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">          If Ob0 is None.</span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This does not include neutrinos, even if non-relativistic</span>
<span class="sd">        at the redshift of interest.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Odm0</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Baryonic density not set for this cosmology, &quot;</span>
                             <span class="s">&quot;unclear meaning of dark matter density&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Odm0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Ok"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.Ok">[docs]</a>    <span class="k">def</span> <span class="nf">Ok</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the equivalent density parameter for curvature</span>
<span class="sd">        at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Ok : ndarray, or float if input scalar</span>
<span class="sd">          The equivalent density parameter for curvature at each redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="c"># Common enough case to be worth checking explicitly</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Ode"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.Ode">[docs]</a>    <span class="k">def</span> <span class="nf">Ode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for dark energy at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Ode : ndarray, or float if input scalar</span>
<span class="sd">          The density of non-relativistic matter relative to the critical</span>
<span class="sd">          density at each redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="c"># Common case worth checking</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_density_scale</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Ogamma"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.Ogamma">[docs]</a>    <span class="k">def</span> <span class="nf">Ogamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for photons at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Ogamma : ndarray, or float if input scalar</span>
<span class="sd">          The energy density of photons relative to the critical</span>
<span class="sd">          density at each redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.Onu"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.Onu">[docs]</a>    <span class="k">def</span> <span class="nf">Onu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the density parameter for massless neutrinos at</span>
<span class="sd">        redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Onu : ndarray, or float if input scalar</span>
<span class="sd">          The energy density of neutrinos relative to the critical</span>
<span class="sd">          density at each redshift.  Note that this includes their</span>
<span class="sd">          kinetic energy (if they have mass), so it is not equal to</span>
<span class="sd">          the commonly used :math:`\\sum \\frac{m_{\\nu}}{94 eV}`,</span>
<span class="sd">          which does not include kinetic energy.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ogamma</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.Tcmb"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.Tcmb">[docs]</a>    <span class="k">def</span> <span class="nf">Tcmb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the CMB temperature at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tcmb : `~astropy.units.Quantity`</span>
<span class="sd">          The temperature of the CMB in K.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.Tnu"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.Tnu">[docs]</a>    <span class="k">def</span> <span class="nf">Tnu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the neutrino temperature at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tnu : `~astropy.units.Quantity`</span>
<span class="sd">          The temperature of the cosmic neutrino background in K.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tnu0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.nu_relative_density"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.nu_relative_density">[docs]</a>    <span class="k">def</span> <span class="nf">nu_relative_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Neutrino density function relative to the energy density in</span>
<span class="sd">        photons.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array like</span>
<span class="sd">           Redshift</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">         f : ndarray, or float if z is scalar</span>
<span class="sd">           The neutrino density scaling factor relative to the density</span>
<span class="sd">           in photons at each redshift</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The density in neutrinos is given by</span>

<span class="sd">        .. math::</span>

<span class="sd">          \\rho_{\\nu} \\left(a\\right) = 0.2271 \\, N_{eff} \\,</span>
<span class="sd">          f\\left(m_{\\nu} a / T_{\\nu 0} \\right) \\,</span>
<span class="sd">          \\rho_{\\gamma} \\left( a \\right)</span>

<span class="sd">        where</span>

<span class="sd">        .. math::</span>

<span class="sd">          f \\left(y\\right) = \\frac{120}{7 \\pi^4}</span>
<span class="sd">          \\int_0^{\\infty} \\, dx \\frac{x^2 \\sqrt{x^2 + y^2}}</span>
<span class="sd">          {e^x + 1}</span>

<span class="sd">        assuming that all neutrino species have the same mass.</span>
<span class="sd">        If they have different masses, a similar term is calculated</span>
<span class="sd">        for each one. Note that f has the asymptotic behavior :math:`f(0) = 1`.</span>
<span class="sd">        This method returns :math:`0.2271 f` using an</span>
<span class="sd">        analytical fitting formula given in Komatsu et al. 2011, ApJS 192, 18.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Note that there is also a scalar-z-only cython implementation of</span>
        <span class="c"># this in scalar_inv_efuncs.pyx, so if you find a problem in this</span>
        <span class="c"># you need to update there too.</span>

        <span class="c"># See Komatsu et al. 2011, eq 26 and the surrounding discussion</span>
        <span class="c"># for an explanation of what we are doing here.</span>
        <span class="c"># However, this is modified to handle multiple neutrino masses</span>
        <span class="c"># by computing the above for each mass, then summing</span>
        <span class="n">prefac</span> <span class="o">=</span> <span class="mf">0.22710731766</span>  <span class="c"># 7/8 (4/11)^4/3 -- see any cosmo book</span>

        <span class="c"># The massive and massless contribution must be handled separately</span>
        <span class="c"># But check for common cases first</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">prefac</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">prefac</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span> <span class="o">*</span>\
                    <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>

        <span class="c"># These are purely fitting constants -- see the Komatsu paper</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mf">1.83</span>
        <span class="n">invp</span> <span class="o">=</span> <span class="mf">0.54644808743</span>  <span class="c"># 1.0 / p</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mf">0.3173</span>

        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">curr_nu_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">rel_mass_per</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">curr_nu_y</span><span class="p">)</span> <span class="o">**</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="n">invp</span>
        <span class="n">rel_mass</span> <span class="o">=</span> <span class="n">rel_mass_per</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span>

        <span class="k">return</span> <span class="n">prefac</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span> <span class="o">*</span> <span class="n">rel_mass</span>
</div>
    <span class="k">def</span> <span class="nf">_w_integrand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ln1pz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Internal convenience function for w(z) integral.&quot;&quot;&quot;</span>

        <span class="c"># See Linder 2003, PRL 90, 91301 eq (5)</span>
        <span class="c"># Assumes scalar input, since this should only be called</span>
        <span class="c"># inside an integral</span>

        <span class="n">z</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">ln1pz</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<div class="viewcode-block" id="FLRW.de_density_scale"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and is given by</span>

<span class="sd">        .. math::</span>

<span class="sd">            I = \\exp \\left( 3 \int_{a}^1 \\frac{ da^{\\prime} }{ a^{\\prime} }</span>
<span class="sd">            \\left[ 1 + w\\left( a^{\\prime} \\right) \\right] \\right)</span>

<span class="sd">        It will generally helpful for subclasses to overload this method if</span>
<span class="sd">        the integral can be done analytically for the particular dark</span>
<span class="sd">        energy equation of state that they implement.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># This allows for an arbitrary w(z) following eq (5) of</span>
        <span class="c"># Linder 2003, PRL 90, 91301.  The code here evaluates</span>
        <span class="c"># the integral numerically.  However, most popular</span>
        <span class="c"># forms of w(z) are designed to make this integral analytic,</span>
        <span class="c"># so it is probably a good idea for subclasses to overload this</span>
        <span class="c"># method if an analytic form is available.</span>
        <span class="c">#</span>
        <span class="c"># The integral we actually use (the one given in Linder)</span>
        <span class="c"># is rewritten in terms of z, so looks slightly different than the</span>
        <span class="c"># one in the documentation string, but it&#39;s the same thing.</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">ival</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_w_integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">redshift</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                             <span class="k">for</span> <span class="n">redshift</span> <span class="ow">in</span> <span class="n">z</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">ival</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ival</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_w_integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">z</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">ival</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>

<span class="sd">        It is not necessary to override this method, but if de_density_scale</span>
<span class="sd">        takes a particularly simple form, it may be advantageous to.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span>
                       <span class="n">Ode0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_density_scale</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="FLRW.inv_efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inverse of efunc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the inverse Hubble constant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Avoid the function overhead by repeating code</span>
        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span>
                <span class="n">Ode0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">de_density_scale</span><span class="p">(</span><span class="n">z</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_lookback_time_integrand_scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Integrand of the lookback time.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : float</span>
<span class="sd">          Input redshift.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : float</span>
<span class="sd">          The integrand for the lookback time</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        Eqn 30 from Hogg 1999.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="n">since</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&#39;lookback_time_integrand&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_tfunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Integrand of the lookback time.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : float or array-like</span>
<span class="sd">          Input redshift.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : float or array</span>
<span class="sd">          The integrand for the lookback time</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        Eqn 30 from Hogg 1999.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">zp1</span>

<div class="viewcode-block" id="FLRW.lookback_time_integrand"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.lookback_time_integrand">[docs]</a>    <span class="k">def</span> <span class="nf">lookback_time_integrand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Integrand of the lookback time.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : float or array-like</span>
<span class="sd">          Input redshift.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : float or array</span>
<span class="sd">          The integrand for the lookback time</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        Eqn 30 from Hogg 1999.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">zp1</span>
</div>
    <span class="k">def</span> <span class="nf">_abs_distance_integrand_scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Integrand of the absorption distance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : float</span>
<span class="sd">          Input redshift.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X : float</span>
<span class="sd">          The integrand for the absorption distance</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        See Hogg 1999 section 11.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="n">since</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&#39;abs_distance_integrand&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_xfunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Integrand of the absorption distance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : float or array</span>
<span class="sd">          Input redshift.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X : float or array</span>
<span class="sd">          The integrand for the absorption distance</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        See Hogg 1999 section 11.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>
        <span class="k">return</span> <span class="n">zp1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<div class="viewcode-block" id="FLRW.abs_distance_integrand"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.abs_distance_integrand">[docs]</a>    <span class="k">def</span> <span class="nf">abs_distance_integrand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Integrand of the absorption distance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : float or array</span>
<span class="sd">          Input redshift.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X : float or array</span>
<span class="sd">          The integrand for the absorption distance</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        See Hogg 1999 section 11.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>
        <span class="k">return</span> <span class="n">zp1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.H"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.H">[docs]</a>    <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Hubble parameter (km/s/Mpc) at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        H : `~astropy.units.Quantity`</span>
<span class="sd">          Hubble parameter at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">efunc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.scale_factor"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.scale_factor">[docs]</a>    <span class="k">def</span> <span class="nf">scale_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Scale factor at redshift ``z``.</span>

<span class="sd">        The scale factor is defined as :math:`a = 1 / (1 + z)`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        a : ndarray, or float if input scalar</span>
<span class="sd">          Scale factor at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.lookback_time"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.lookback_time">[docs]</a>    <span class="k">def</span> <span class="nf">lookback_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Lookback time in Gyr to redshift ``z``.</span>

<span class="sd">        The lookback time is the difference between the age of the</span>
<span class="sd">        Universe now and the age at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        t : `~astropy.units.Quantity`</span>
<span class="sd">          Lookback time in Gyr to each input redshift.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        z_at_value : Find the redshift corresponding to a lookback time.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">red</span><span class="p">:</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lookback_time_integrand_scalar</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">red</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span> <span class="o">*</span> <span class="n">vectorize_if_needed</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.lookback_distance"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.lookback_distance">[docs]</a>    <span class="k">def</span> <span class="nf">lookback_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The lookback distance is the light travel time distance to a given</span>
<span class="sd">        redshift. It is simply c * lookback_time.  It may be used to calculate</span>
<span class="sd">        the proper distance between two redshifts, e.g. for the mean free path</span>
<span class="sd">        to ionizing radiation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`</span>
<span class="sd">          Lookback distance in Mpc</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lookback_time</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.age"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.age">[docs]</a>    <span class="k">def</span> <span class="nf">age</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Age of the universe in Gyr at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        t : `~astropy.units.Quantity`</span>
<span class="sd">          The age of the universe in Gyr at each input redshift.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        z_at_value : Find the redshift corresponding to an age.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">red</span><span class="p">:</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lookback_time_integrand_scalar</span><span class="p">,</span>
                             <span class="n">red</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_time</span> <span class="o">*</span> <span class="n">vectorize_if_needed</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.critical_density"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.critical_density">[docs]</a>    <span class="k">def</span> <span class="nf">critical_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Critical density in grams per cubic cm at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        rho : `~astropy.units.Quantity`</span>
<span class="sd">          Critical density in g/cm^3 at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_critical_density0</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">efunc</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
</div>
<div class="viewcode-block" id="FLRW.comoving_distance"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.comoving_distance">[docs]</a>    <span class="k">def</span> <span class="nf">comoving_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Comoving line-of-sight distance in Mpc at a given</span>
<span class="sd">        redshift.</span>

<span class="sd">        The comoving distance along the line-of-sight between two</span>
<span class="sd">        objects remains constant with time for objects in the Hubble</span>
<span class="sd">        flow.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`</span>
<span class="sd">          Comoving distance in Mpc to each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comoving_distance_z1z2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_comoving_distance_z1z2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Comoving line-of-sight distance in Mpc between objects at</span>
<span class="sd">        redshifts z1 and z2.</span>

<span class="sd">        The comoving distance along the line-of-sight between two</span>
<span class="sd">        objects remains constant with time for objects in the Hubble</span>
<span class="sd">        flow.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z1, z2 : array-like, shape (N,)</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`</span>
<span class="sd">          Comoving distance in Mpc between each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">:</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span>
                             <span class="n">args</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span> <span class="o">*</span> <span class="n">vectorize_if_needed</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span>

<div class="viewcode-block" id="FLRW.comoving_transverse_distance"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.comoving_transverse_distance">[docs]</a>    <span class="k">def</span> <span class="nf">comoving_transverse_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Comoving transverse distance in Mpc at a given redshift.</span>

<span class="sd">        This value is the transverse comoving distance at redshift ``z``</span>
<span class="sd">        corresponding to an angular separation of 1 radian. This is</span>
<span class="sd">        the same as the comoving distance if omega_k is zero (as in</span>
<span class="sd">        the current concordance lambda CDM model).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`</span>
<span class="sd">          Comoving transverse distance in Mpc at each input redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This quantity also called the &#39;proper motion distance&#39; in some</span>
<span class="sd">        texts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comoving_transverse_distance_z1z2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_comoving_transverse_distance_z1z2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Comoving transverse distance in Mpc between two redshifts.</span>

<span class="sd">        This value is the transverse comoving distance at redshift</span>
<span class="sd">        ``z2`` as seen from redshift ``z1`` corresponding to an</span>
<span class="sd">        angular separation of 1 radian. This is the same as the</span>
<span class="sd">        comoving distance if omega_k is zero (as in the current</span>
<span class="sd">        concordance lambda CDM model).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z1, z2 : array-like, shape (N,)</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`</span>
<span class="sd">          Comoving transverse distance in Mpc between input redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This quantity is also called the &#39;proper motion distance&#39; in</span>
<span class="sd">        some texts.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="n">dc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comoving_distance_z1z2</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Ok0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dc</span>
        <span class="n">sqrtOk0</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Ok0</span><span class="p">))</span>
        <span class="n">dh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span>
        <span class="k">if</span> <span class="n">Ok0</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dh</span> <span class="o">/</span> <span class="n">sqrtOk0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">sqrtOk0</span> <span class="o">*</span> <span class="n">dc</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">dh</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dh</span> <span class="o">/</span> <span class="n">sqrtOk0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrtOk0</span> <span class="o">*</span> <span class="n">dc</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">dh</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="FLRW.angular_diameter_distance"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.angular_diameter_distance">[docs]</a>    <span class="k">def</span> <span class="nf">angular_diameter_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Angular diameter distance in Mpc at a given redshift.</span>

<span class="sd">        This gives the proper (sometimes called &#39;physical&#39;) transverse</span>
<span class="sd">        distance corresponding to an angle of 1 radian for an object</span>
<span class="sd">        at redshift ``z``.</span>

<span class="sd">        Weinberg, 1972, pp 421-424; Weedman, 1986, pp 65-67; Peebles,</span>
<span class="sd">        1993, pp 325-327.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`</span>
<span class="sd">          Angular diameter distance in Mpc at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.luminosity_distance"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.luminosity_distance">[docs]</a>    <span class="k">def</span> <span class="nf">luminosity_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Luminosity distance in Mpc at redshift ``z``.</span>

<span class="sd">        This is the distance to use when converting between the</span>
<span class="sd">        bolometric flux from an object at redshift ``z`` and its</span>
<span class="sd">        bolometric luminosity.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`</span>
<span class="sd">          Luminosity distance in Mpc at each input redshift.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        z_at_value : Find the redshift corresponding to a luminosity distance.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        Weinberg, 1972, pp 420-424; Weedman, 1986, pp 60-62.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.angular_diameter_distance_z1z2"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.angular_diameter_distance_z1z2">[docs]</a>    <span class="k">def</span> <span class="nf">angular_diameter_distance_z1z2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Angular diameter distance between objects at 2 redshifts.</span>
<span class="sd">        Useful for gravitational lensing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z1, z2 : array-like, shape (N,)</span>
<span class="sd">          Input redshifts. z2 must be large than z1.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`, shape (N,) or single if input scalar</span>
<span class="sd">          The angular diameter distance between each input redshift</span>
<span class="sd">          pair.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comoving_transverse_distance_z1z2</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.absorption_distance"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.absorption_distance">[docs]</a>    <span class="k">def</span> <span class="nf">absorption_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Absorption distance at redshift ``z``.</span>

<span class="sd">        This is used to calculate the number of objects with some</span>
<span class="sd">        cross section of absorption and number density intersecting a</span>
<span class="sd">        sightline per unit redshift path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : float or ndarray</span>
<span class="sd">          Absorption distance (dimensionless) at each input redshift.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        Hogg 1999 Section 11. (astro-ph/9905116)</span>
<span class="sd">        Bahcall, John N. and Peebles, P.J.E. 1969, ApJ, 156L, 7B</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">red</span><span class="p">:</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_abs_distance_integrand_scalar</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">red</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">vectorize_if_needed</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.distmod"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.distmod">[docs]</a>    <span class="k">def</span> <span class="nf">distmod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Distance modulus at redshift ``z``.</span>

<span class="sd">        The distance modulus is defined as the (apparent magnitude -</span>
<span class="sd">        absolute magnitude) for an object at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        distmod : `~astropy.units.Quantity`</span>
<span class="sd">          Distance modulus at each input redshift, in magnitudes</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        z_at_value : Find the redshift corresponding to a distance modulus.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Remember that the luminosity distance is in Mpc</span>
        <span class="c"># Abs is necessary because in certain obscure closed cosmologies</span>
        <span class="c">#  the distance modulus can be negative -- which is okay because</span>
        <span class="c">#  it enters as the square.</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">5.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">luminosity_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">))</span> <span class="o">+</span> <span class="mf">25.0</span>
        <span class="k">return</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">mag</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.comoving_volume"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.comoving_volume">[docs]</a>    <span class="k">def</span> <span class="nf">comoving_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Comoving volume in cubic Mpc at redshift ``z``.</span>

<span class="sd">        This is the volume of the universe encompassed by redshifts less</span>
<span class="sd">        than ``z``. For the case of omega_k = 0 it is a sphere of radius</span>
<span class="sd">        `comoving_distance` but it is less intuitive</span>
<span class="sd">        if omega_k is not 0.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        V : `~astropy.units.Quantity`</span>
<span class="sd">          Comoving volume in :math:`Mpc^3` at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="k">if</span> <span class="n">Ok0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">4.</span> <span class="o">/</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span>

        <span class="n">dh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span><span class="o">.</span><span class="n">value</span>  <span class="c"># .value for speed</span>
        <span class="n">dm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="mf">4.</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">dh</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span> <span class="o">**</span> <span class="mi">3</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">dm</span> <span class="o">/</span> <span class="n">dh</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Ok0</span> <span class="o">*</span> <span class="p">(</span><span class="n">dm</span> <span class="o">/</span> <span class="n">dh</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">term3</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Ok0</span><span class="p">))</span> <span class="o">*</span> <span class="n">dm</span> <span class="o">/</span> <span class="n">dh</span>

        <span class="k">if</span> <span class="n">Ok0</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">term1</span> <span class="o">*</span> <span class="p">(</span><span class="n">term2</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Ok0</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">(</span><span class="n">term3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">term1</span> <span class="o">*</span> <span class="p">(</span><span class="n">term2</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Ok0</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">term3</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="FLRW.differential_comoving_volume"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.differential_comoving_volume">[docs]</a>    <span class="k">def</span> <span class="nf">differential_comoving_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Differential comoving volume at redshift z.</span>

<span class="sd">        Useful for calculating the effective comoving volume.</span>
<span class="sd">        For example, allows for integration over a comoving volume</span>
<span class="sd">        that has a sensitivity function that changes with redshift.</span>
<span class="sd">        The total comoving volume is given by integrating</span>
<span class="sd">        differential_comoving_volume to redshift z</span>
<span class="sd">        and multiplying by a solid angle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dV : `~astropy.units.Quantity`</span>
<span class="sd">          Differential comoving volume per redshift per steradian at</span>
<span class="sd">          each input redshift.&quot;&quot;&quot;</span>
        <span class="n">dh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hubble_distance</span>
        <span class="n">da</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>
        <span class="k">return</span> <span class="n">dh</span> <span class="o">*</span> <span class="p">((</span><span class="n">zp1</span> <span class="o">*</span> <span class="n">da</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">efunc</span><span class="p">(</span><span class="n">z</span><span class="p">),</span>
                                                          <span class="n">u</span><span class="o">.</span><span class="n">steradian</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.kpc_comoving_per_arcmin"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.kpc_comoving_per_arcmin">[docs]</a>    <span class="k">def</span> <span class="nf">kpc_comoving_per_arcmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Separation in transverse comoving kpc corresponding to an</span>
<span class="sd">        arcminute at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`</span>
<span class="sd">          The distance in comoving kpc corresponding to an arcmin at each</span>
<span class="sd">          input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span><span class="p">)</span> <span class="o">*</span>
                <span class="n">arcmin_in_radians</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.kpc_proper_per_arcmin"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.kpc_proper_per_arcmin">[docs]</a>    <span class="k">def</span> <span class="nf">kpc_proper_per_arcmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Separation in transverse proper kpc corresponding to an</span>
<span class="sd">        arcminute at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d : `~astropy.units.Quantity`</span>
<span class="sd">          The distance in proper kpc corresponding to an arcmin at each</span>
<span class="sd">          input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span><span class="p">)</span> <span class="o">*</span>
                <span class="n">arcmin_in_radians</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.arcsec_per_kpc_comoving"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.arcsec_per_kpc_comoving">[docs]</a>    <span class="k">def</span> <span class="nf">arcsec_per_kpc_comoving</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Angular separation in arcsec corresponding to a comoving kpc</span>
<span class="sd">        at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : `~astropy.units.Quantity`</span>
<span class="sd">          The angular separation in arcsec corresponding to a comoving kpc</span>
<span class="sd">          at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comoving_transverse_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span><span class="p">)</span> <span class="o">*</span>
                           <span class="n">arcsec_in_radians</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FLRW.arcsec_per_kpc_proper"><a class="viewcode-back" href="../../../api/astropy.cosmology.FLRW.html#astropy.cosmology.FLRW.arcsec_per_kpc_proper">[docs]</a>    <span class="k">def</span> <span class="nf">arcsec_per_kpc_proper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Angular separation in arcsec corresponding to a proper kpc at</span>
<span class="sd">        redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.  Must be 1D or scalar.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : `~astropy.units.Quantity`</span>
<span class="sd">          The angular separation in arcsec corresponding to a proper kpc</span>
<span class="sd">          at each input redshift.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span><span class="p">)</span> <span class="o">*</span>
                           <span class="n">arcsec_in_radians</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="LambdaCDM"><a class="viewcode-back" href="../../../api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM">[docs]</a><span class="k">class</span> <span class="nc">LambdaCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a cosmological constant and curvature.</span>

<span class="sd">    This has no additional attributes beyond those of FLRW.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    H0 : float or `~astropy.units.Quantity`</span>
<span class="sd">        Hubble constant at z = 0.  If a float, must be in [km/sec/Mpc]</span>

<span class="sd">    Om0 : float</span>
<span class="sd">        Omega matter: density of non-relativistic matter in units of the</span>
<span class="sd">        critical density at z=0.</span>

<span class="sd">    Ode0 : float</span>
<span class="sd">        Omega dark energy: density of the cosmological constant in units of</span>
<span class="sd">        the critical density at z=0.</span>

<span class="sd">    Tcmb0 : float or scalar `~astropy.units.Quantity`, optional</span>
<span class="sd">        Temperature of the CMB z=0. If a float, must be in [K].</span>
<span class="sd">        Default: 2.725 [K]. Setting this to zero will turn off both photons</span>
<span class="sd">        and neutrinos (even massive ones).</span>

<span class="sd">    Neff : float, optional</span>
<span class="sd">        Effective number of Neutrino species. Default 3.04.</span>

<span class="sd">    m_nu : `~astropy.units.Quantity`, optional</span>
<span class="sd">        Mass of each neutrino species. If this is a scalar Quantity, then all</span>
<span class="sd">        neutrino species are assumed to have that mass. Otherwise, the mass of</span>
<span class="sd">        each species. The actual number of neutrino species (and hence the</span>
<span class="sd">        number of elements of m_nu if it is not scalar) must be the floor of</span>
<span class="sd">        Neff. Typically this means you should provide three neutrino masses</span>
<span class="sd">        unless you are considering something like a sterile neutrino.</span>

<span class="sd">    Ob0 : float or None, optional</span>
<span class="sd">        Omega baryons: density of baryonic matter in units of the critical</span>
<span class="sd">        density at z=0.  If this is set to None (the default), any</span>
<span class="sd">        computation that requires its value will raise an exception.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        Name for this cosmological object.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astropy.cosmology import LambdaCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = LambdaCDM(H0=70, Om0=0.3, Ode0=0.7)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; z = 0.5</span>
<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span> <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span>
                 <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span> <span class="n">Ob0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">m_nu</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                      <span class="n">Ob0</span><span class="o">=</span><span class="n">Ob0</span><span class="p">)</span>

        <span class="c"># Please see &quot;Notes about speeding up integrals&quot; for discussion</span>
        <span class="c"># about what is being done here.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">lcdm_inv_efunc_norel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">lcdm_inv_efunc_nomnu</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">lcdm_inv_efunc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y_list</span><span class="p">)</span>

<div class="viewcode-block" id="LambdaCDM.w"><a class="viewcode-back" href="../../../api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is</span>
<span class="sd">        :math:`w(z) = -1`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LambdaCDM.de_density_scale"><a class="viewcode-back" href="../../../api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by :math:`I = 1`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="mf">1.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LambdaCDM.efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="c"># We override this because it takes a particularly simple</span>
        <span class="c"># form for a cosmological constant</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ode0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LambdaCDM.inv_efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.LambdaCDM.html#astropy.cosmology.LambdaCDM.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot; Function used to calculate :math:`\frac{1}{H_z}`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The inverse redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H_z = H_0 /</span>
<span class="sd">        E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ode0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="FlatLambdaCDM"><a class="viewcode-back" href="../../../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM">[docs]</a><span class="k">class</span> <span class="nc">FlatLambdaCDM</span><span class="p">(</span><span class="n">LambdaCDM</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a cosmological constant and no curvature.</span>

<span class="sd">    This has no additional attributes beyond those of FLRW.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    H0 : float or `~astropy.units.Quantity`</span>
<span class="sd">        Hubble constant at z = 0.  If a float, must be in [km/sec/Mpc]</span>

<span class="sd">    Om0 : float</span>
<span class="sd">        Omega matter: density of non-relativistic matter in units of the</span>
<span class="sd">        critical density at z=0.</span>

<span class="sd">    Tcmb0 : float or scalar `~astropy.units.Quantity`, optional</span>
<span class="sd">        Temperature of the CMB z=0. If a float, must be in [K].</span>
<span class="sd">        Default: 2.725 [K]. Setting this to zero will turn off both photons</span>
<span class="sd">        and neutrinos (even massive ones).</span>

<span class="sd">    Neff : float, optional</span>
<span class="sd">        Effective number of Neutrino species. Default 3.04.</span>

<span class="sd">    m_nu : `~astropy.units.Quantity`, optional</span>
<span class="sd">        Mass of each neutrino species. If this is a scalar Quantity, then all</span>
<span class="sd">        neutrino species are assumed to have that mass. Otherwise, the mass of</span>
<span class="sd">        each species. The actual number of neutrino species (and hence the</span>
<span class="sd">        number of elements of m_nu if it is not scalar) must be the floor of</span>
<span class="sd">        Neff. Typically this means you should provide three neutrino masses</span>
<span class="sd">        unless you are considering something like a sterile neutrino.</span>

<span class="sd">    Ob0 : float or None, optional</span>
<span class="sd">        Omega baryons: density of baryonic matter in units of the critical</span>
<span class="sd">        density at z=0.  If this is set to None (the default), any</span>
<span class="sd">        computation that requires its value will raise an exception.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        Name for this cosmological object.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astropy.cosmology import FlatLambdaCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = FlatLambdaCDM(H0=70, Om0=0.3)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; z = 0.5</span>
<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span> <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span>
                 <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span> <span class="n">Ob0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">LambdaCDM</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">m_nu</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                           <span class="n">Ob0</span><span class="o">=</span><span class="n">Ob0</span><span class="p">)</span>
        <span class="c"># Do some twiddling after the fact to get flatness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c"># Please see &quot;Notes about speeding up integrals&quot; for discussion</span>
        <span class="c"># about what is being done here.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">flcdm_inv_efunc_norel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">flcdm_inv_efunc_nomnu</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">flcdm_inv_efunc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y_list</span><span class="p">)</span>

<div class="viewcode-block" id="FlatLambdaCDM.efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="c"># We override this because it takes a particularly simple</span>
        <span class="c"># form for a cosmological constant</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ode0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FlatLambdaCDM.inv_efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.FlatLambdaCDM.html#astropy.cosmology.FlatLambdaCDM.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot;Function used to calculate :math:`\frac{1}{H_z}`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The inverse redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H_z = H_0 / E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Ode0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retstr</span> <span class="o">=</span> <span class="s">&quot;{0}H0={1:.3g}, Om0={2:.3g}, Tcmb0={3:.4g}, &quot;</span>\
                 <span class="s">&quot;Neff={4:.3g}, m_nu={5}, Ob0={6:s})&quot;</span>
        <span class="k">return</span> <span class="n">retstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_namelead</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nu</span><span class="p">,</span>
                             <span class="n">_float_or_none</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="wCDM"><a class="viewcode-back" href="../../../api/astropy.cosmology.wCDM.html#astropy.cosmology.wCDM">[docs]</a><span class="k">class</span> <span class="nc">wCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a constant dark energy equation of state</span>
<span class="sd">    and curvature.</span>

<span class="sd">    This has one additional attribute beyond those of FLRW.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    H0 : float or `~astropy.units.Quantity`</span>
<span class="sd">        Hubble constant at z = 0. If a float, must be in [km/sec/Mpc]</span>

<span class="sd">    Om0 : float</span>
<span class="sd">        Omega matter: density of non-relativistic matter in units of the</span>
<span class="sd">        critical density at z=0.</span>

<span class="sd">    Ode0 : float</span>
<span class="sd">        Omega dark energy: density of dark energy in units of the critical</span>
<span class="sd">        density at z=0.</span>

<span class="sd">    w0 : float, optional</span>
<span class="sd">        Dark energy equation of state at all redshifts. This is</span>
<span class="sd">        pressure/density for dark energy in units where c=1. A cosmological</span>
<span class="sd">        constant has w0=-1.0.</span>

<span class="sd">    Tcmb0 : float or scalar `~astropy.units.Quantity`, optional</span>
<span class="sd">        Temperature of the CMB z=0. If a float, must be in [K].</span>
<span class="sd">        Default: 2.725 [K]. Setting this to zero will turn off both photons</span>
<span class="sd">        and neutrinos (even massive ones).</span>

<span class="sd">    Neff : float, optional</span>
<span class="sd">        Effective number of Neutrino species. Default 3.04.</span>

<span class="sd">    m_nu : `~astropy.units.Quantity`, optional</span>
<span class="sd">        Mass of each neutrino species. If this is a scalar Quantity, then all</span>
<span class="sd">        neutrino species are assumed to have that mass. Otherwise, the mass of</span>
<span class="sd">        each species. The actual number of neutrino species (and hence the</span>
<span class="sd">        number of elements of m_nu if it is not scalar) must be the floor of</span>
<span class="sd">        Neff. Typically this means you should provide three neutrino masses</span>
<span class="sd">        unless you are considering something like a sterile neutrino.</span>

<span class="sd">    Ob0 : float or None, optional</span>
<span class="sd">        Omega baryons: density of baryonic matter in units of the critical</span>
<span class="sd">        density at z=0.  If this is set to None (the default), any</span>
<span class="sd">        computation that requires its value will raise an exception.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        Name for this cosmological object.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astropy.cosmology import wCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = wCDM(H0=70, Om0=0.3, Ode0=0.7, w0=-0.9)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; z = 0.5</span>
<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span> <span class="n">Ob0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">m_nu</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                      <span class="n">Ob0</span><span class="o">=</span><span class="n">Ob0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>

        <span class="c"># Please see &quot;Notes about speeding up integrals&quot; for discussion</span>
        <span class="c"># about what is being done here.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">wcdm_inv_efunc_norel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">wcdm_inv_efunc_nomnu</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">wcdm_inv_efunc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">w0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dark energy equation of state&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>

<div class="viewcode-block" id="wCDM.w"><a class="viewcode-back" href="../../../api/astropy.cosmology.wCDM.html#astropy.cosmology.wCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is</span>
<span class="sd">        :math:`w(z) = w_0`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="wCDM.de_density_scale"><a class="viewcode-back" href="../../../api/astropy.cosmology.wCDM.html#astropy.cosmology.wCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by</span>
<span class="sd">        :math:`I = \\left(1 + z\\right)^{3\\left(1 + w_0\\right)}`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="wCDM.efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.wCDM.html#astropy.cosmology.wCDM.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span>
                       <span class="n">Ode0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">w0</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="wCDM.inv_efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.wCDM.html#astropy.cosmology.wCDM.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot; Function used to calculate :math:`\frac{1}{H_z}`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The inverse redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H_z = H_0 / E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Ok0</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Ok0</span><span class="p">)</span> <span class="o">+</span>
                <span class="n">Ode0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">w0</span><span class="p">)))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retstr</span> <span class="o">=</span> <span class="s">&quot;{0}H0={1:.3g}, Om0={2:.3g}, Ode0={3:.3g}, w0={4:.3g}, &quot;</span>\
                 <span class="s">&quot;Tcmb0={5:.4g}, Neff={6:.3g}, m_nu={7}, Ob0={8:s})&quot;</span>
        <span class="k">return</span> <span class="n">retstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_namelead</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">m_nu</span><span class="p">,</span> <span class="n">_float_or_none</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="FlatwCDM"><a class="viewcode-back" href="../../../api/astropy.cosmology.FlatwCDM.html#astropy.cosmology.FlatwCDM">[docs]</a><span class="k">class</span> <span class="nc">FlatwCDM</span><span class="p">(</span><span class="n">wCDM</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a constant dark energy equation of state</span>
<span class="sd">    and no spatial curvature.</span>

<span class="sd">    This has one additional attribute beyond those of FLRW.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    H0 : float or `~astropy.units.Quantity`</span>
<span class="sd">        Hubble constant at z = 0. If a float, must be in [km/sec/Mpc]</span>

<span class="sd">    Om0 : float</span>
<span class="sd">        Omega matter: density of non-relativistic matter in units of the</span>
<span class="sd">        critical density at z=0.</span>

<span class="sd">    w0 : float, optional</span>
<span class="sd">        Dark energy equation of state at all redshifts. This is</span>
<span class="sd">        pressure/density for dark energy in units where c=1. A cosmological</span>
<span class="sd">        constant has w0=-1.0.</span>

<span class="sd">    Tcmb0 : float or scalar `~astropy.units.Quantity`, optional</span>
<span class="sd">        Temperature of the CMB z=0. If a float, must be in [K].</span>
<span class="sd">        Default: 2.725 [K]. Setting this to zero will turn off both photons</span>
<span class="sd">        and neutrinos (even massive ones).</span>

<span class="sd">    Neff : float, optional</span>
<span class="sd">        Effective number of Neutrino species. Default 3.04.</span>

<span class="sd">    m_nu : `~astropy.units.Quantity`, optional</span>
<span class="sd">        Mass of each neutrino species. If this is a scalar Quantity, then all</span>
<span class="sd">        neutrino species are assumed to have that mass. Otherwise, the mass of</span>
<span class="sd">        each species. The actual number of neutrino species (and hence the</span>
<span class="sd">        number of elements of m_nu if it is not scalar) must be the floor of</span>
<span class="sd">        Neff. Typically this means you should provide three neutrino masses</span>
<span class="sd">        unless you are considering something like a sterile neutrino.</span>

<span class="sd">    Ob0 : float or None, optional</span>
<span class="sd">        Omega baryons: density of baryonic matter in units of the critical</span>
<span class="sd">        density at z=0.  If this is set to None (the default), any</span>
<span class="sd">        computation that requires its value will raise an exception.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        Name for this cosmological object.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astropy.cosmology import FlatwCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = FlatwCDM(H0=70, Om0=0.3, w0=-0.9)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; z = 0.5</span>
<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span> <span class="n">Ob0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">wCDM</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">m_nu</span><span class="p">,</span>
                      <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">Ob0</span><span class="o">=</span><span class="n">Ob0</span><span class="p">)</span>
        <span class="c"># Do some twiddling after the fact to get flatness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c"># Please see &quot;Notes about speeding up integrals&quot; for discussion</span>
        <span class="c"># about what is being done here.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">fwcdm_inv_efunc_norel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">fwcdm_inv_efunc_nomnu</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">fwcdm_inv_efunc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">)</span>

<div class="viewcode-block" id="FlatwCDM.efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.FlatwCDM.html#astropy.cosmology.FlatwCDM.efunc">[docs]</a>    <span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function used to calculate H(z), the Hubble parameter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H(z) = H_0 E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">+</span>
                       <span class="n">Ode0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">w0</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="FlatwCDM.inv_efunc"><a class="viewcode-back" href="../../../api/astropy.cosmology.FlatwCDM.html#astropy.cosmology.FlatwCDM.inv_efunc">[docs]</a>    <span class="k">def</span> <span class="nf">inv_efunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot; Function used to calculate :math:`\frac{1}{H_z}`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        E : ndarray, or float if input scalar</span>
<span class="sd">          The inverse redshift scaling of the Hubble constant.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The return value, E, is defined such that :math:`H_z = H_0 / E`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_relative_density</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">zp1</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">Or</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">+</span> <span class="n">Om0</span><span class="p">)</span> <span class="o">+</span>
                <span class="n">Ode0</span> <span class="o">*</span> <span class="n">zp1</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">w0</span><span class="p">)))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retstr</span> <span class="o">=</span> <span class="s">&quot;{0}H0={1:.3g}, Om0={2:.3g}, w0={3:.3g}, Tcmb0={4:.4g}, &quot;</span>\
                 <span class="s">&quot;Neff={5:.3g}, m_nu={6}, Ob0={7:s})&quot;</span>
        <span class="k">return</span> <span class="n">retstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_namelead</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nu</span><span class="p">,</span>
                             <span class="n">_float_or_none</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="w0waCDM"><a class="viewcode-back" href="../../../api/astropy.cosmology.w0waCDM.html#astropy.cosmology.w0waCDM">[docs]</a><span class="k">class</span> <span class="nc">w0waCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a CPL dark energy equation of state and curvature.</span>

<span class="sd">    The equation for the dark energy equation of state uses the</span>
<span class="sd">    CPL form as described in Chevallier &amp; Polarski Int. J. Mod. Phys.</span>
<span class="sd">    D10, 213 (2001) and Linder PRL 90, 91301 (2003):</span>
<span class="sd">    :math:`w(z) = w_0 + w_a (1-a) = w_0 + w_a z / (1+z)`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    H0 : float or `~astropy.units.Quantity`</span>
<span class="sd">        Hubble constant at z = 0. If a float, must be in [km/sec/Mpc]</span>

<span class="sd">    Om0 : float</span>
<span class="sd">        Omega matter: density of non-relativistic matter in units of the</span>
<span class="sd">        critical density at z=0.</span>

<span class="sd">    Ode0 : float</span>
<span class="sd">        Omega dark energy: density of dark energy in units of the critical</span>
<span class="sd">        density at z=0.</span>

<span class="sd">    w0 : float, optional</span>
<span class="sd">        Dark energy equation of state at z=0 (a=1). This is pressure/density</span>
<span class="sd">        for dark energy in units where c=1.</span>

<span class="sd">    wa : float, optional</span>
<span class="sd">        Negative derivative of the dark energy equation of state with respect</span>
<span class="sd">        to the scale factor. A cosmological constant has w0=-1.0 and wa=0.0.</span>

<span class="sd">    Tcmb0 : float or scalar `~astropy.units.Quantity`, optional</span>
<span class="sd">        Temperature of the CMB z=0. If a float, must be in [K].</span>
<span class="sd">        Default: 2.725 [K]. Setting this to zero will turn off both photons</span>
<span class="sd">        and neutrinos (even massive ones).</span>

<span class="sd">    Neff : float, optional</span>
<span class="sd">        Effective number of Neutrino species. Default 3.04.</span>

<span class="sd">    m_nu : `~astropy.units.Quantity`, optional</span>
<span class="sd">        Mass of each neutrino species. If this is a scalar Quantity, then all</span>
<span class="sd">        neutrino species are assumed to have that mass. Otherwise, the mass of</span>
<span class="sd">        each species. The actual number of neutrino species (and hence the</span>
<span class="sd">        number of elements of m_nu if it is not scalar) must be the floor of</span>
<span class="sd">        Neff. Typically this means you should provide three neutrino masses</span>
<span class="sd">        unless you are considering something like a sterile neutrino.</span>

<span class="sd">    Ob0 : float or None, optional</span>
<span class="sd">        Omega baryons: density of baryonic matter in units of the critical</span>
<span class="sd">        density at z=0.  If this is set to None (the default), any</span>
<span class="sd">        computation that requires its value will raise an exception.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        Name for this cosmological object.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astropy.cosmology import w0waCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = w0waCDM(H0=70, Om0=0.3, Ode0=0.7, w0=-0.9, wa=0.2)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; z = 0.5</span>
<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wa</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span> <span class="n">Ob0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">m_nu</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                      <span class="n">Ob0</span><span class="o">=</span><span class="n">Ob0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wa</span><span class="p">)</span>

        <span class="c"># Please see &quot;Notes about speeding up integrals&quot; for discussion</span>
        <span class="c"># about what is being done here.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">w0wacdm_inv_efunc_norel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">w0wacdm_inv_efunc_nomnu</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">w0wacdm_inv_efunc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">w0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dark energy equation of state at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Negative derivative of dark energy equation of state w.r.t. a&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span>

<div class="viewcode-block" id="w0waCDM.w"><a class="viewcode-back" href="../../../api/astropy.cosmology.w0waCDM.html#astropy.cosmology.w0waCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is</span>
<span class="sd">        :math:`w(z) = w_0 + w_a (1 - a) = w_0 + w_a \\frac{z}{1+z}`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">*</span> <span class="n">z</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="w0waCDM.de_density_scale"><a class="viewcode-back" href="../../../api/astropy.cosmology.w0waCDM.html#astropy.cosmology.w0waCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by</span>

<span class="sd">        .. math::</span>

<span class="sd">          I = \\left(1 + z\\right)^{3 \\left(1 + w_0 + w_a\\right)}</span>
<span class="sd">          \exp \\left(-3 w_a \\frac{z}{1+z}\\right)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">z</span>
        <span class="k">return</span> <span class="n">zp1</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">))</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">*</span> <span class="n">z</span> <span class="o">/</span> <span class="n">zp1</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retstr</span> <span class="o">=</span> <span class="s">&quot;{0}H0={1:.3g}, Om0={2:.3g}, &quot;</span>\
                 <span class="s">&quot;Ode0={3:.3g}, w0={4:.3g}, wa={5:.3g}, Tcmb0={6:.4g}, &quot;</span>\
                 <span class="s">&quot;Neff={7:.3g}, m_nu={8}, Ob0={9:s})&quot;</span>
        <span class="k">return</span> <span class="n">retstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_namelead</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nu</span><span class="p">,</span>
                             <span class="n">_float_or_none</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="Flatw0waCDM"><a class="viewcode-back" href="../../../api/astropy.cosmology.Flatw0waCDM.html#astropy.cosmology.Flatw0waCDM">[docs]</a><span class="k">class</span> <span class="nc">Flatw0waCDM</span><span class="p">(</span><span class="n">w0waCDM</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a CPL dark energy equation of state and no</span>
<span class="sd">    curvature.</span>

<span class="sd">    The equation for the dark energy equation of state uses the</span>
<span class="sd">    CPL form as described in Chevallier &amp; Polarski Int. J. Mod. Phys.</span>
<span class="sd">    D10, 213 (2001) and Linder PRL 90, 91301 (2003):</span>
<span class="sd">    :math:`w(z) = w_0 + w_a (1-a) = w_0 + w_a z / (1+z)`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    H0 : float or `~astropy.units.Quantity`</span>
<span class="sd">        Hubble constant at z = 0. If a float, must be in [km/sec/Mpc]</span>

<span class="sd">    Om0 : float</span>
<span class="sd">        Omega matter: density of non-relativistic matter in units of the</span>
<span class="sd">        critical density at z=0.</span>

<span class="sd">    w0 : float, optional</span>
<span class="sd">        Dark energy equation of state at z=0 (a=1). This is pressure/density</span>
<span class="sd">        for dark energy in units where c=1.</span>

<span class="sd">    wa : float, optional</span>
<span class="sd">        Negative derivative of the dark energy equation of state with respect</span>
<span class="sd">        to the scale factor. A cosmological constant has w0=-1.0 and wa=0.0.</span>

<span class="sd">    Tcmb0 : float or scalar `~astropy.units.Quantity`, optional</span>
<span class="sd">        Temperature of the CMB z=0. If a float, must be in [K].</span>
<span class="sd">        Default: 2.725 [K]. Setting this to zero will turn off both photons</span>
<span class="sd">        and neutrinos (even massive ones).</span>

<span class="sd">    Neff : float, optional</span>
<span class="sd">        Effective number of Neutrino species. Default 3.04.</span>

<span class="sd">    m_nu : `~astropy.units.Quantity`, optional</span>
<span class="sd">        Mass of each neutrino species. If this is a scalar Quantity, then all</span>
<span class="sd">        neutrino species are assumed to have that mass. Otherwise, the mass of</span>
<span class="sd">        each species. The actual number of neutrino species (and hence the</span>
<span class="sd">        number of elements of m_nu if it is not scalar) must be the floor of</span>
<span class="sd">        Neff. Typically this means you should provide three neutrino masses</span>
<span class="sd">        unless you are considering something like a sterile neutrino.</span>

<span class="sd">    Ob0 : float or None, optional</span>
<span class="sd">        Omega baryons: density of baryonic matter in units of the critical</span>
<span class="sd">        density at z=0.  If this is set to None (the default), any</span>
<span class="sd">        computation that requires its value will raise an exception.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        Name for this cosmological object.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astropy.cosmology import Flatw0waCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = Flatw0waCDM(H0=70, Om0=0.3, w0=-0.9, wa=0.2)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; z = 0.5</span>
<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wa</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span> <span class="n">Ob0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">w0waCDM</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">wa</span><span class="o">=</span><span class="n">wa</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="n">Tcmb0</span><span class="p">,</span>
                         <span class="n">Neff</span><span class="o">=</span><span class="n">Neff</span><span class="p">,</span> <span class="n">m_nu</span><span class="o">=</span><span class="n">m_nu</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">Ob0</span><span class="o">=</span><span class="n">Ob0</span><span class="p">)</span>
        <span class="c"># Do some twiddling after the fact to get flatness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c"># Please see &quot;Notes about speeding up integrals&quot; for discussion</span>
        <span class="c"># about what is being done here.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">fw0wacdm_inv_efunc_norel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">fw0wacdm_inv_efunc_nomnu</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">fw0wacdm_inv_efunc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retstr</span> <span class="o">=</span> <span class="s">&quot;{0}H0={1:.3g}, Om0={2:.3g}, &quot;</span>\
                 <span class="s">&quot;w0={3:.3g}, Tcmb0={4:.4g}, Neff={5:.3g}, m_nu={6}, &quot;</span>\
                 <span class="s">&quot;Ob0={7:s})&quot;</span>
        <span class="k">return</span> <span class="n">retstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_namelead</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nu</span><span class="p">,</span>
                             <span class="n">_float_or_none</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="wpwaCDM"><a class="viewcode-back" href="../../../api/astropy.cosmology.wpwaCDM.html#astropy.cosmology.wpwaCDM">[docs]</a><span class="k">class</span> <span class="nc">wpwaCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a CPL dark energy equation of state, a pivot</span>
<span class="sd">    redshift, and curvature.</span>

<span class="sd">    The equation for the dark energy equation of state uses the</span>
<span class="sd">    CPL form as described in Chevallier &amp; Polarski Int. J. Mod. Phys.</span>
<span class="sd">    D10, 213 (2001) and Linder PRL 90, 91301 (2003), but modified</span>
<span class="sd">    to have a pivot redshift as in the findings of the Dark Energy</span>
<span class="sd">    Task Force (Albrecht et al. arXiv:0901.0721 (2009)):</span>
<span class="sd">    :math:`w(a) = w_p + w_a (a_p - a) = w_p + w_a( 1/(1+zp) - 1/(1+z) )`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    H0 : float or `~astropy.units.Quantity`</span>
<span class="sd">        Hubble constant at z = 0. If a float, must be in [km/sec/Mpc]</span>

<span class="sd">    Om0 : float</span>
<span class="sd">        Omega matter: density of non-relativistic matter in units of the</span>
<span class="sd">        critical density at z=0.</span>

<span class="sd">    Ode0 : float</span>
<span class="sd">        Omega dark energy: density of dark energy in units of the critical</span>
<span class="sd">        density at z=0.</span>

<span class="sd">    wp : float, optional</span>
<span class="sd">        Dark energy equation of state at the pivot redshift zp. This is</span>
<span class="sd">        pressure/density for dark energy in units where c=1.</span>

<span class="sd">    wa : float, optional</span>
<span class="sd">        Negative derivative of the dark energy equation of state with respect</span>
<span class="sd">        to the scale factor. A cosmological constant has wp=-1.0 and wa=0.0.</span>

<span class="sd">    zp : float, optional</span>
<span class="sd">        Pivot redshift -- the redshift where w(z) = wp</span>

<span class="sd">    Tcmb0 : float or scalar `~astropy.units.Quantity`, optional</span>
<span class="sd">        Temperature of the CMB z=0. If a float, must be in [K].</span>
<span class="sd">        Default: 2.725 [K]. Setting this to zero will turn off both photons</span>
<span class="sd">        and neutrinos (even massive ones).</span>

<span class="sd">    Neff : float, optional</span>
<span class="sd">        Effective number of Neutrino species. Default 3.04.</span>

<span class="sd">    m_nu : `~astropy.units.Quantity`, optional</span>
<span class="sd">        Mass of each neutrino species. If this is a scalar Quantity, then all</span>
<span class="sd">        neutrino species are assumed to have that mass. Otherwise, the mass of</span>
<span class="sd">        each species. The actual number of neutrino species (and hence the</span>
<span class="sd">        number of elements of m_nu if it is not scalar) must be the floor of</span>
<span class="sd">        Neff. Typically this means you should provide three neutrino masses</span>
<span class="sd">        unless you are considering something like a sterile neutrino.</span>

<span class="sd">    Ob0 : float or None, optional</span>
<span class="sd">        Omega baryons: density of baryonic matter in units of the critical</span>
<span class="sd">        density at z=0.  If this is set to None (the default), any</span>
<span class="sd">        computation that requires its value will raise an exception.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        Name for this cosmological object.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astropy.cosmology import wpwaCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = wpwaCDM(H0=70, Om0=0.3, Ode0=0.7, wp=-0.9, wa=0.2, zp=0.4)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; z = 0.5</span>
<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">wp</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wa</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">zp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span> <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span>
                 <span class="n">Ob0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">m_nu</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                      <span class="n">Ob0</span><span class="o">=</span><span class="n">Ob0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wa</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zp</span><span class="p">)</span>

        <span class="c"># Please see &quot;Notes about speeding up integrals&quot; for discussion</span>
        <span class="c"># about what is being done here.</span>
        <span class="n">apiv</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">wpwacdm_inv_efunc_norel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span><span class="p">,</span> <span class="n">apiv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">wpwacdm_inv_efunc_nomnu</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span><span class="p">,</span> <span class="n">apiv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">wpwacdm_inv_efunc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span><span class="p">,</span>
                                           <span class="n">apiv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dark energy equation of state at the pivot redshift zp&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Negative derivative of dark energy equation of state w.r.t. a&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">zp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The pivot redshift, where w(z) = wp&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span>

<div class="viewcode-block" id="wpwaCDM.w"><a class="viewcode-back" href="../../../api/astropy.cosmology.wpwaCDM.html#astropy.cosmology.wpwaCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is</span>
<span class="sd">        :math:`w(z) = w_p + w_a (a_p - a)` where :math:`a = 1/1+z`</span>
<span class="sd">        and :math:`a_p = 1 / 1 + z_p`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="n">apiv</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">*</span> <span class="p">(</span><span class="n">apiv</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="wpwaCDM.de_density_scale"><a class="viewcode-back" href="../../../api/astropy.cosmology.wpwaCDM.html#astropy.cosmology.wpwaCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by</span>

<span class="sd">        .. math::</span>

<span class="sd">          a_p = \\frac{1}{1 + z_p}</span>

<span class="sd">          I = \\left(1 + z\\right)^{3 \\left(1 + w_p + a_p w_a\\right)}</span>
<span class="sd">          \exp \\left(-3 w_a \\frac{z}{1+z}\\right)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>
        <span class="n">apiv</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">zp1</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span> <span class="o">+</span> <span class="n">apiv</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">))</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span> <span class="o">*</span> <span class="n">z</span> <span class="o">/</span> <span class="n">zp1</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retstr</span> <span class="o">=</span> <span class="s">&quot;{0}H0={1:.3g}, Om0={2:.3g}, Ode0={3:.3g}, wp={4:.3g}, &quot;</span>\
                 <span class="s">&quot;wa={5:.3g}, zp={6:.3g}, Tcmb0={7:.4g}, Neff={8:.3g}, &quot;</span>\
                 <span class="s">&quot;m_nu={9}, Ob0={10:s})&quot;</span>
        <span class="k">return</span> <span class="n">retstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_namelead</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zp</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nu</span><span class="p">,</span>
                             <span class="n">_float_or_none</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="w0wzCDM"><a class="viewcode-back" href="../../../api/astropy.cosmology.w0wzCDM.html#astropy.cosmology.w0wzCDM">[docs]</a><span class="k">class</span> <span class="nc">w0wzCDM</span><span class="p">(</span><span class="n">FLRW</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FLRW cosmology with a variable dark energy equation of state</span>
<span class="sd">    and curvature.</span>

<span class="sd">    The equation for the dark energy equation of state uses the</span>
<span class="sd">    simple form: :math:`w(z) = w_0 + w_z z`.</span>

<span class="sd">    This form is not recommended for z &gt; 1.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    H0 : float or `~astropy.units.Quantity`</span>
<span class="sd">        Hubble constant at z = 0. If a float, must be in [km/sec/Mpc]</span>

<span class="sd">    Om0 : float</span>
<span class="sd">        Omega matter: density of non-relativistic matter in units of the</span>
<span class="sd">        critical density at z=0.</span>

<span class="sd">    Ode0 : float</span>
<span class="sd">        Omega dark energy: density of dark energy in units of the critical</span>
<span class="sd">        density at z=0.</span>

<span class="sd">    w0 : float, optional</span>
<span class="sd">        Dark energy equation of state at z=0. This is pressure/density for</span>
<span class="sd">        dark energy in units where c=1.</span>

<span class="sd">    wz : float, optional</span>
<span class="sd">        Derivative of the dark energy equation of state with respect to z.</span>
<span class="sd">        A cosmological constant has w0=-1.0 and wz=0.0.</span>

<span class="sd">    Tcmb0 : float or scalar `~astropy.units.Quantity`, optional</span>
<span class="sd">        Temperature of the CMB z=0. If a float, must be in [K].</span>
<span class="sd">        Default: 2.725 [K]. Setting this to zero will turn off both photons</span>
<span class="sd">        and neutrinos (even massive ones).</span>

<span class="sd">    Neff : float, optional</span>
<span class="sd">        Effective number of Neutrino species. Default 3.04.</span>

<span class="sd">    m_nu : `~astropy.units.Quantity`, optional</span>
<span class="sd">        Mass of each neutrino species. If this is a scalar Quantity, then all</span>
<span class="sd">        neutrino species are assumed to have that mass. Otherwise, the mass of</span>
<span class="sd">        each species. The actual number of neutrino species (and hence the</span>
<span class="sd">        number of elements of m_nu if it is not scalar) must be the floor of</span>
<span class="sd">        Neff. Typically this means you should provide three neutrino masses</span>
<span class="sd">        unless you are considering something like a sterile neutrino.</span>

<span class="sd">    Ob0 : float or None, optional</span>
<span class="sd">        Omega baryons: density of baryonic matter in units of the critical</span>
<span class="sd">        density at z=0.  If this is set to None (the default), any</span>
<span class="sd">        computation that requires its value will raise an exception.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        Name for this cosmological object.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from astropy.cosmology import w0wzCDM</span>
<span class="sd">    &gt;&gt;&gt; cosmo = w0wzCDM(H0=70, Om0=0.3, Ode0=0.7, w0=-0.9, wz=0.2)</span>

<span class="sd">    The comoving distance in Mpc at redshift z:</span>

<span class="sd">    &gt;&gt;&gt; z = 0.5</span>
<span class="sd">    &gt;&gt;&gt; dc = cosmo.comoving_distance(z)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">w0</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wz</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="mf">2.725</span><span class="p">,</span>
                 <span class="n">Neff</span><span class="o">=</span><span class="mf">3.04</span><span class="p">,</span> <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span> <span class="n">Ob0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">FLRW</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">Om0</span><span class="p">,</span> <span class="n">Ode0</span><span class="p">,</span> <span class="n">Tcmb0</span><span class="p">,</span> <span class="n">Neff</span><span class="p">,</span> <span class="n">m_nu</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                      <span class="n">Ob0</span><span class="o">=</span><span class="n">Ob0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wz</span><span class="p">)</span>

        <span class="c"># Please see &quot;Notes about speeding up integrals&quot; for discussion</span>
        <span class="c"># about what is being done here.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">w0wzcdm_inv_efunc_norel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massivenu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">w0wzcdm_inv_efunc_nomnu</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Onu0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar</span> <span class="o">=</span> <span class="n">scalar_inv_efuncs</span><span class="o">.</span><span class="n">w0wzcdm_inv_efunc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inv_efunc_scalar_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ok0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_Ogamma0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neff_per_nu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nmasslessnu</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_nu_y_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">w0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dark energy equation of state at z=0&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Derivative of the dark energy equation of state w.r.t. z&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span>

<div class="viewcode-block" id="w0wzCDM.w"><a class="viewcode-back" href="../../../api/astropy.cosmology.w0wzCDM.html#astropy.cosmology.w0wzCDM.w">[docs]</a>    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns dark energy equation of state at redshift ``z``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        w : ndarray, or float if input scalar</span>
<span class="sd">          The dark energy equation of state</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>
<span class="sd">        The dark energy equation of state is defined as</span>
<span class="sd">        :math:`w(z) = P(z)/\\rho(z)`, where :math:`P(z)` is the</span>
<span class="sd">        pressure at redshift z and :math:`\\rho(z)` is the density</span>
<span class="sd">        at redshift z, both in units where c=1.  Here this is given by</span>
<span class="sd">        :math:`w(z) = w_0 + w_z z`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span> <span class="o">*</span> <span class="n">z</span>
</div>
<div class="viewcode-block" id="w0wzCDM.de_density_scale"><a class="viewcode-back" href="../../../api/astropy.cosmology.w0wzCDM.html#astropy.cosmology.w0wzCDM.de_density_scale">[docs]</a>    <span class="k">def</span> <span class="nf">de_density_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Evaluates the redshift dependence of the dark energy density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : array-like</span>
<span class="sd">          Input redshifts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        I : ndarray, or float if input scalar</span>
<span class="sd">          The scaling of the energy density of dark energy with redshift.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The scaling factor, I, is defined by :math:`\\rho(z) = \\rho_0 I`,</span>
<span class="sd">        and in this case is given by</span>

<span class="sd">        .. math::</span>

<span class="sd">          I = \\left(1 + z\\right)^{3 \\left(1 + w_0 - w_z\\right)}</span>
<span class="sd">          \exp \\left(-3 w_z z\\right)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">zp1</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">z</span>
        <span class="k">return</span> <span class="n">zp1</span> <span class="o">**</span> <span class="p">(</span><span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span><span class="p">))</span> <span class="o">*</span>\
            <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retstr</span> <span class="o">=</span> <span class="s">&quot;{0}H0={1:.3g}, Om0={2:.3g}, &quot;</span>\
                 <span class="s">&quot;Ode0={3:.3g}, w0={4:.3g}, wz={5:.3g} Tcmb0={6:.4g}, &quot;</span>\
                 <span class="s">&quot;Neff={7:.3g}, m_nu={8}, Ob0={9:s})&quot;</span>
        <span class="k">return</span> <span class="n">retstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_namelead</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_H0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Om0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Ode0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_w0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tcmb0</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_Neff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_nu</span><span class="p">,</span> <span class="n">_float_or_none</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ob0</span><span class="p">))</span>

</div>
<span class="k">def</span> <span class="nf">_float_or_none</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Helper function to format a variable that can be a float or None&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">fmtstr</span> <span class="o">=</span> <span class="s">&quot;{0:.{digits}g}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="n">digits</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fmtstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">vectorize_if_needed</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Helper function to vectorize functions on array inputs&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">isiterable</span><span class="p">,</span> <span class="n">x</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>


<span class="c"># Pre-defined cosmologies. This loops over the parameter sets in the</span>
<span class="c"># parameters module and creates a LambdaCDM or FlatLambdaCDM instance</span>
<span class="c"># with the same name as the parameter set in the current module&#39;s namespace.</span>
<span class="c"># Note this assumes all the cosmologies in parameters are LambdaCDM,</span>
<span class="c"># which is true at least as of this writing.</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">available</span><span class="p">:</span>
    <span class="n">par</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;flat&#39;</span><span class="p">]:</span>
        <span class="n">cosmo</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;H0&#39;</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;Om0&#39;</span><span class="p">],</span> <span class="n">Tcmb0</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Tcmb0&#39;</span><span class="p">],</span>
                              <span class="n">Neff</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Neff&#39;</span><span class="p">],</span>
                              <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;m_nu&#39;</span><span class="p">],</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span>
                              <span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                              <span class="n">Ob0</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Ob0&#39;</span><span class="p">])</span>
        <span class="n">docstr</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> instance of FlatLambdaCDM cosmology</span><span class="se">\n\n</span><span class="s">(from </span><span class="si">%s</span><span class="s">)&quot;</span>
        <span class="n">cosmo</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="n">docstr</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;reference&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cosmo</span> <span class="o">=</span> <span class="n">LambdaCDM</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;H0&#39;</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;Om0&#39;</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;Ode0&#39;</span><span class="p">],</span>
                          <span class="n">Tcmb0</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Tcmb0&#39;</span><span class="p">],</span> <span class="n">Neff</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Neff&#39;</span><span class="p">],</span>
                          <span class="n">m_nu</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;m_nu&#39;</span><span class="p">],</span> <span class="n">u</span><span class="o">.</span><span class="n">eV</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                          <span class="n">Ob0</span><span class="o">=</span><span class="n">par</span><span class="p">[</span><span class="s">&#39;Ob0&#39;</span><span class="p">])</span>
        <span class="n">docstr</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> instance of LambdaCDM cosmology</span><span class="se">\n\n</span><span class="s">(from </span><span class="si">%s</span><span class="s">)&quot;</span>
        <span class="n">cosmo</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="n">docstr</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">par</span><span class="p">[</span><span class="s">&#39;reference&#39;</span><span class="p">])</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">],</span> <span class="n">key</span><span class="p">,</span> <span class="n">cosmo</span><span class="p">)</span>

<span class="c"># don&#39;t leave these variables floating around in the namespace</span>
<span class="k">del</span> <span class="n">key</span><span class="p">,</span> <span class="n">par</span><span class="p">,</span> <span class="n">cosmo</span>

<span class="c">#########################################################################</span>
<span class="c"># The science state below contains the current cosmology.</span>
<span class="c">#########################################################################</span>


<div class="viewcode-block" id="default_cosmology"><a class="viewcode-back" href="../../../api/astropy.cosmology.default_cosmology.html#astropy.cosmology.default_cosmology">[docs]</a><span class="k">class</span> <span class="nc">default_cosmology</span><span class="p">(</span><span class="n">ScienceState</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The default cosmology to use.  To change it::</span>

<span class="sd">        &gt;&gt;&gt; from astropy.cosmology import default_cosmology, WMAP7</span>
<span class="sd">        &gt;&gt;&gt; with default_cosmology.set(WMAP7):</span>
<span class="sd">        ...     # WMAP7 cosmology in effect</span>

<span class="sd">    Or, you may use a string::</span>

<span class="sd">        &gt;&gt;&gt; with default_cosmology.set(&#39;WMAP7&#39;):</span>
<span class="sd">        ...     # WMAP7 cosmology in effect</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_value</span> <span class="o">=</span> <span class="s">&#39;WMAP9&#39;</span>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="default_cosmology.get_cosmology_from_string"><a class="viewcode-back" href="../../../api/astropy.cosmology.default_cosmology.html#astropy.cosmology.default_cosmology.get_cosmology_from_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_cosmology_from_string</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return a cosmology instance from a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s">&#39;no_default&#39;</span><span class="p">:</span>
            <span class="n">cosmo</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cosmo</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">],</span> <span class="n">arg</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;Unknown cosmology &#39;</span><span class="si">%s</span><span class="s">&#39;. Valid cosmologies:</span><span class="se">\n</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">arg</span><span class="p">,</span> <span class="n">parameters</span><span class="o">.</span><span class="n">available</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cosmo</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="default_cosmology.validate"><a class="viewcode-back" href="../../../api/astropy.cosmology.default_cosmology.html#astropy.cosmology.default_cosmology.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s">&#39;WMAP9&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">get_cosmology_from_string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Cosmology</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;default_cosmology must be a string or Cosmology instance.&quot;</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1. &nbsp;
    Last built 12 May 2016. <br/>
  </p>
</footer>
  </body>
</html>