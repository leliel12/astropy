<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>astropy.io.ascii.core &mdash; Astropy v1.2.dev15003</title>
    
    <link rel="stylesheet" href="../../../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.2.dev15003',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v1.2.dev15003" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../../../../_static/copybutton.js"></script>


  </head>
  <body role="document">
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../index.html">Astropy v1.2.dev15003</a>
	 &raquo;
      </li>
      <li><a href="../../../index.html" accesskey="U">Module code</a> &raquo;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for astropy.io.ascii.core</h1><div class="highlight"><pre>
<span class="c"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>
<span class="sd">&quot;&quot;&quot; An extensible ASCII table reader and writer.</span>

<span class="sd">core.py:</span>
<span class="sd">  Core base classes and functions for reading and writing tables.</span>

<span class="sd">:Copyright: Smithsonian Astrophysical Observatory (2010)</span>
<span class="sd">:Author: Tom Aldcroft (aldcroft@head.cfa.harvard.edu)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="kn">from</span> <span class="nn">...extern</span> <span class="kn">import</span> <span class="n">six</span>
<span class="kn">from</span> <span class="nn">...extern.six.moves</span> <span class="kn">import</span> <span class="nb">zip</span>
<span class="kn">from</span> <span class="nn">...extern.six.moves</span> <span class="kn">import</span> <span class="n">cStringIO</span> <span class="k">as</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">...utils.exceptions</span> <span class="kn">import</span> <span class="n">AstropyWarning</span>

<span class="kn">from</span> <span class="nn">...table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">...utils.compat</span> <span class="kn">import</span> <span class="n">ignored</span>
<span class="kn">from</span> <span class="nn">...utils.data</span> <span class="kn">import</span> <span class="n">get_readable_fileobj</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="c"># Global dictionary mapping format arg to the corresponding Reader class</span>
<span class="n">FORMAT_CLASSES</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c"># Similar dictionary for fast readers</span>
<span class="n">FAST_CLASSES</span> <span class="o">=</span> <span class="p">{}</span>


<span class="k">class</span> <span class="nc">CsvWriter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Internal class to replace the csv writer ``writerow`` and ``writerows``</span>
<span class="sd">    functions so that in the case of ``delimiter=&#39; &#39;`` and</span>
<span class="sd">    ``quoting=csv.QUOTE_MINIMAL``, the output field value is quoted for empty</span>
<span class="sd">    fields (when value == &#39;&#39;).</span>

<span class="sd">    This changes the API slightly in that the writerow() and writerows()</span>
<span class="sd">    methods return the output written string instead of the length of</span>
<span class="sd">    that string.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; from astropy.io.ascii.core import CsvWriter</span>
<span class="sd">    &gt;&gt;&gt; writer = CsvWriter(delimiter=&#39; &#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(writer.writerow([&#39;hello&#39;, &#39;&#39;, &#39;world&#39;]))</span>
<span class="sd">    hello &quot;&quot; world</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Random 16-character string that gets injected instead of any</span>
    <span class="c"># empty fields and is then replaced post-write with doubled-quotechar.</span>
    <span class="c"># Created with:</span>
    <span class="c"># &#39;&#39;.join(random.choice(string.printable[:90]) for _ in range(16))</span>
    <span class="n">replace_sentinel</span> <span class="o">=</span> <span class="s">&#39;2b=48Av%0-V3p&gt;bX&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvfile</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span> <span class="o">=</span> <span class="n">csvfile</span>

        <span class="c"># Temporary StringIO for catching the real csv.writer() object output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_out</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_out</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">dialect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">dialect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quotechar2</span> <span class="o">=</span> <span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quote_empty</span> <span class="o">=</span> <span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">quoting</span> <span class="o">==</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">==</span> <span class="s">&#39; &#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">writerow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Similar to csv.writer.writerow but with the custom quoting behavior.</span>
<span class="sd">        Returns the written string instead of the length of that string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">has_empty</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c"># If QUOTE_MINIMAL and space-delimited then replace empty fields with</span>
        <span class="c"># the sentinel value.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quote_empty</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">has_empty</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_sentinel</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writerow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">has_empty</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">writerows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Similar to csv.writer.writerows but with the custom quoting behavior.</span>
<span class="sd">        Returns the written string instead of the length of that string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">has_empty</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c"># If QUOTE_MINIMAL and space-delimited then replace empty fields with</span>
        <span class="c"># the sentinel value.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quote_empty</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">values_list</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                        <span class="n">has_empty</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_sentinel</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writerow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">,</span> <span class="n">values_list</span><span class="p">,</span> <span class="n">has_empty</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_writerow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">writerow_func</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">has_empty</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call ``writerow_func`` (either writerow or writerows) with ``values``.</span>
<span class="sd">        If it has empty fields that have been replaced then change those</span>
<span class="sd">        sentinel strings back to quoted empty strings, e.g. ``&quot;&quot;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Clear the temporary StringIO buffer that self.writer writes into and</span>
        <span class="c"># then call the real csv.writer().writerow or writerows with values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_out</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_out</span><span class="o">.</span><span class="n">truncate</span><span class="p">()</span>
        <span class="n">writerow_func</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

        <span class="n">row_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_out</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quote_empty</span> <span class="ow">and</span> <span class="n">has_empty</span><span class="p">:</span>
            <span class="n">row_string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replace_sentinel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quotechar2</span><span class="p">,</span> <span class="n">row_string</span><span class="p">)</span>

        <span class="c"># self.csvfile is defined then write the output.  In practice the pure</span>
        <span class="c"># Python writer calls with csvfile=None, while the fast writer calls with</span>
        <span class="c"># a file-like object.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row_string</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">row_string</span>


<span class="k">class</span> <span class="nc">MaskedConstant</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A trivial extension of numpy.ma.masked</span>

<span class="sd">    We want to be able to put the generic term ``masked`` into a dictionary.</span>
<span class="sd">    In python 2.7 we can just use ``numpy.ma.masked``, but in python 3.1 and 3.2 that</span>
<span class="sd">    is not hashable, see https://github.com/numpy/numpy/issues/4660</span>
<span class="sd">    So, we need to extend it here with a hash value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;All instances of this class shall have the same hash.&#39;&#39;&#39;</span>
        <span class="c"># Any large number will do.</span>
        <span class="k">return</span> <span class="mi">1234567890</span>

<span class="n">masked</span> <span class="o">=</span> <span class="n">MaskedConstant</span><span class="p">()</span>

<div class="viewcode-block" id="InconsistentTableError"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.InconsistentTableError.html#astropy.io.ascii.InconsistentTableError">[docs]</a><span class="k">class</span> <span class="nc">InconsistentTableError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Indicates that an input table is inconsistent in some way.</span>

<span class="sd">    The default behavior of ``BaseReader`` is to throw an instance of</span>
<span class="sd">    this class if a data row doesn&#39;t match the header.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</div>
<span class="k">class</span> <span class="nc">OptionalTableImportError</span><span class="p">(</span><span class="ne">ImportError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Indicates that a dependency for table reading is not present.</span>

<span class="sd">    An instance of this class is raised whenever an optional reader</span>
<span class="sd">    with certain required dependencies cannot operate because of</span>
<span class="sd">    an ImportError.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ParameterError"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.ParameterError.html#astropy.io.ascii.ParameterError">[docs]</a><span class="k">class</span> <span class="nc">ParameterError</span><span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Indicates that a reader cannot handle a passed parameter.</span>

<span class="sd">    The C-based fast readers in ``io.ascii`` raise an instance of</span>
<span class="sd">    this error class upon encountering a parameter that the</span>
<span class="sd">    C engine cannot handle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</div>
<span class="k">class</span> <span class="nc">FastOptionsError</span><span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Indicates that one of the specified options for fast</span>
<span class="sd">    reading is invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="NoType"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.NoType.html#astropy.io.ascii.NoType">[docs]</a><span class="k">class</span> <span class="nc">NoType</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Superclass for ``StrType`` and ``NumType`` classes.</span>

<span class="sd">    This class is the default type of ``Column`` and provides a base</span>
<span class="sd">    class for other data types.</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="StrType"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.StrType.html#astropy.io.ascii.StrType">[docs]</a><span class="k">class</span> <span class="nc">StrType</span><span class="p">(</span><span class="n">NoType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Indicates that a column consists of text data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="NumType"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.NumType.html#astropy.io.ascii.NumType">[docs]</a><span class="k">class</span> <span class="nc">NumType</span><span class="p">(</span><span class="n">NoType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Indicates that a column consists of numerical data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="FloatType"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.FloatType.html#astropy.io.ascii.FloatType">[docs]</a><span class="k">class</span> <span class="nc">FloatType</span><span class="p">(</span><span class="n">NumType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Describes floating-point data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<span class="k">class</span> <span class="nc">BoolType</span><span class="p">(</span><span class="n">NoType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Describes boolean data.</span>
<span class="sd">    &quot;&quot;&quot;</span>


<div class="viewcode-block" id="IntType"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.IntType.html#astropy.io.ascii.IntType">[docs]</a><span class="k">class</span> <span class="nc">IntType</span><span class="p">(</span><span class="n">NumType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Describes integer data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="AllType"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.AllType.html#astropy.io.ascii.AllType">[docs]</a><span class="k">class</span> <span class="nc">AllType</span><span class="p">(</span><span class="n">StrType</span><span class="p">,</span> <span class="n">FloatType</span><span class="p">,</span> <span class="n">IntType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subclass of all other data types.</span>

<span class="sd">    This type is returned by ``convert_numpy`` if the given numpy</span>
<span class="sd">    type does not match ``StrType``, ``FloatType``, or ``IntType``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="Column"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.Column.html#astropy.io.ascii.Column">[docs]</a><span class="k">class</span> <span class="nc">Column</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Table column.</span>

<span class="sd">    The key attributes of a Column object are:</span>

<span class="sd">    * **name** : column name</span>
<span class="sd">    * **type** : column type (NoType, StrType, NumType, FloatType, IntType)</span>
<span class="sd">    * **dtype** : numpy dtype (optional, overrides **type** if set)</span>
<span class="sd">    * **str_vals** : list of column values as strings</span>
<span class="sd">    * **data** : list of converted column values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">NoType</span>  <span class="c"># Generic type (Int, Float, Str etc)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c"># Numpy dtype if available</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_vals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span> <span class="o">=</span> <span class="p">{}</span>

</div>
<div class="viewcode-block" id="BaseInputter"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseInputter.html#astropy.io.ascii.BaseInputter">[docs]</a><span class="k">class</span> <span class="nc">BaseInputter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the lines from the table input and return a list of lines.</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="BaseInputter.get_lines"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseInputter.html#astropy.io.ascii.BaseInputter.get_lines">[docs]</a>    <span class="k">def</span> <span class="nf">get_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the lines from the ``table`` input. The input table can be one of:</span>

<span class="sd">        * File name</span>
<span class="sd">        * String (newline separated) with all header and data lines (must have at least 2 lines)</span>
<span class="sd">        * File-like object with read() method</span>
<span class="sd">        * List of strings</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str, file_like, list</span>
<span class="sd">            Can be either a file name, string (newline separated) with all header and data</span>
<span class="sd">            lines (must have at least 2 lines), a file-like object with a ``read()`` method,</span>
<span class="sd">            or a list of strings.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lines : list</span>
<span class="sd">            List of lines</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s">&#39;read&#39;</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table</span> <span class="o">+</span> <span class="s">&#39;&#39;</span> <span class="ow">and</span> <span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table</span> <span class="o">+</span> <span class="s">&#39;&#39;</span><span class="p">)):</span>
                <span class="k">with</span> <span class="n">get_readable_fileobj</span><span class="p">(</span><span class="n">table</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_obj</span><span class="p">:</span>
                    <span class="n">table</span> <span class="o">=</span> <span class="n">file_obj</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c"># See if table supports indexing, slicing, and iteration</span>
                <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
                <span class="nb">iter</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">table</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s">&#39;Input &quot;table&quot; must be a string (filename or data) or an iterable&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseInputter.process_lines"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseInputter.html#astropy.io.ascii.BaseInputter.process_lines">[docs]</a>    <span class="k">def</span> <span class="nf">process_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Process lines for subsequent use.  In the default case do nothing.</span>
<span class="sd">        This routine is not generally intended for removing comment lines or</span>
<span class="sd">        stripping whitespace.  These are done (if needed) in the header and</span>
<span class="sd">        data line processing.</span>

<span class="sd">        Override this method if something more has to be done to convert raw</span>
<span class="sd">        input lines to the table rows.  For example the</span>
<span class="sd">        ContinuationLinesInputter derived class accounts for continuation</span>
<span class="sd">        characters if a row is split into lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">lines</span>

</div></div>
<div class="viewcode-block" id="BaseSplitter"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseSplitter.html#astropy.io.ascii.BaseSplitter">[docs]</a><span class="k">class</span> <span class="nc">BaseSplitter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base splitter that uses python&#39;s split method to do the work.</span>

<span class="sd">    This does not handle quoted values.  A key feature is the formulation of</span>
<span class="sd">    __call__ as a generator that returns a list of the split line values at</span>
<span class="sd">    each iteration.</span>

<span class="sd">    There are two methods that are intended to be overridden, first</span>
<span class="sd">    ``process_line()`` to do pre-processing on each input line before splitting</span>
<span class="sd">    and ``process_val()`` to do post-processing on each split string value.  By</span>
<span class="sd">    default these apply the string ``strip()`` function.  These can be set to</span>
<span class="sd">    another function via the instance attribute or be disabled entirely, for</span>
<span class="sd">    example::</span>

<span class="sd">      reader.header.splitter.process_val = lambda x: x.lstrip()</span>
<span class="sd">      reader.data.splitter.process_val = None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">delimiter</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="sd">&quot;&quot;&quot; one-character string used to separate fields &quot;&quot;&quot;</span>

<div class="viewcode-block" id="BaseSplitter.process_line"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseSplitter.html#astropy.io.ascii.BaseSplitter.process_line">[docs]</a>    <span class="k">def</span> <span class="nf">process_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove whitespace at the beginning or end of line.  This is especially useful for</span>
<span class="sd">        whitespace-delimited files to prevent spurious columns at the beginning or end.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="BaseSplitter.process_val"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseSplitter.html#astropy.io.ascii.BaseSplitter.process_val">[docs]</a>    <span class="k">def</span> <span class="nf">process_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove whitespace at the beginning or end of value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="BaseSplitter.__call__"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseSplitter.html#astropy.io.ascii.BaseSplitter.__call__">[docs]</a>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_line</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_line</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_val</span><span class="p">:</span>
                <span class="k">yield</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">process_val</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">vals</span>
</div>
<div class="viewcode-block" id="BaseSplitter.join"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseSplitter.html#astropy.io.ascii.BaseSplitter.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span>
        <span class="k">return</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="DefaultSplitter"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.DefaultSplitter.html#astropy.io.ascii.DefaultSplitter">[docs]</a><span class="k">class</span> <span class="nc">DefaultSplitter</span><span class="p">(</span><span class="n">BaseSplitter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Default class to split strings into columns using python csv.  The class</span>
<span class="sd">    attributes are taken from the csv Dialect class.</span>

<span class="sd">    Typical usage::</span>

<span class="sd">      # lines = ..</span>
<span class="sd">      splitter = ascii.DefaultSplitter()</span>
<span class="sd">      for col_vals in splitter(lines):</span>
<span class="sd">          for col_val in col_vals:</span>
<span class="sd">               ...</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>
    <span class="sd">&quot;&quot;&quot; one-character string used to separate fields. &quot;&quot;&quot;</span>
    <span class="n">quotechar</span> <span class="o">=</span> <span class="s">&#39;&quot;&#39;</span>
    <span class="sd">&quot;&quot;&quot; control how instances of *quotechar* in a field are quoted &quot;&quot;&quot;</span>
    <span class="n">doublequote</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="sd">&quot;&quot;&quot; character to remove special meaning from following character &quot;&quot;&quot;</span>
    <span class="n">escapechar</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="sd">&quot;&quot;&quot; one-character stringto quote fields containing special characters &quot;&quot;&quot;</span>
    <span class="n">quoting</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span>
    <span class="sd">&quot;&quot;&quot; control when quotes are recognised by the reader &quot;&quot;&quot;</span>
    <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="sd">&quot;&quot;&quot; ignore whitespace immediately following the delimiter &quot;&quot;&quot;</span>
    <span class="n">csv_writer</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">csv_writer_out</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>


<div class="viewcode-block" id="DefaultSplitter.process_line"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.DefaultSplitter.html#astropy.io.ascii.DefaultSplitter.process_line">[docs]</a>    <span class="k">def</span> <span class="nf">process_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove whitespace at the beginning or end of line.  This is especially useful for</span>
<span class="sd">        whitespace-delimited files to prevent spurious columns at the beginning or end.</span>
<span class="sd">        If splitting on whitespace then replace unquoted tabs with space first&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">==</span> <span class="s">&#39;\s&#39;</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">_replace_tab_with_space</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">escapechar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="DefaultSplitter.__call__"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.DefaultSplitter.html#astropy.io.ascii.DefaultSplitter.__call__">[docs]</a>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an iterator over the table ``lines``, where each iterator output</span>
<span class="sd">        is a list of the split line values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lines : list</span>
<span class="sd">            List of table lines</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lines : iterator</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_line</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">process_line</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>

        <span class="c"># In Python 2.x the inputs to csv cannot be unicode.  In Python 3 these</span>
        <span class="c"># lines do nothing.</span>
        <span class="n">escapechar</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">escapechar</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">escapechar</span><span class="p">)</span>
        <span class="n">quotechar</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span><span class="p">)</span>
        <span class="n">delimiter</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">delimiter</span> <span class="o">==</span> <span class="s">&#39;\s&#39;</span><span class="p">:</span>
            <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>

        <span class="n">csv_reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span>
                                <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
                                <span class="n">doublequote</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">doublequote</span><span class="p">,</span>
                                <span class="n">escapechar</span><span class="o">=</span><span class="n">escapechar</span><span class="p">,</span>
                                <span class="n">quotechar</span><span class="o">=</span><span class="n">quotechar</span><span class="p">,</span>
                                <span class="n">quoting</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quoting</span><span class="p">,</span>
                                <span class="n">skipinitialspace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skipinitialspace</span>
                                <span class="p">)</span>
        <span class="k">for</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">csv_reader</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_val</span><span class="p">:</span>
                <span class="k">yield</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">process_val</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">vals</span>
</div>
<div class="viewcode-block" id="DefaultSplitter.join"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.DefaultSplitter.html#astropy.io.ascii.DefaultSplitter.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>

        <span class="c"># In Python 2.x the inputs to csv cannot be unicode</span>
        <span class="n">escapechar</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">escapechar</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">escapechar</span><span class="p">)</span>
        <span class="n">quotechar</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span><span class="p">)</span>
        <span class="n">delimiter</span> <span class="o">=</span> <span class="s">&#39; &#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">csv_writer</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">csv_writer</span> <span class="o">=</span> <span class="n">CsvWriter</span><span class="p">(</span><span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
                                        <span class="n">doublequote</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">doublequote</span><span class="p">,</span>
                                        <span class="n">escapechar</span><span class="o">=</span><span class="n">escapechar</span><span class="p">,</span>
                                        <span class="n">quotechar</span><span class="o">=</span><span class="n">quotechar</span><span class="p">,</span>
                                        <span class="n">quoting</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quoting</span><span class="p">,</span>
                                        <span class="n">lineterminator</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_val</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">process_val</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csv_writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span>

</div></div>
<span class="k">def</span> <span class="nf">_replace_tab_with_space</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">escapechar</span><span class="p">,</span> <span class="n">quotechar</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replace tabs with spaces in given string, preserving quoted substrings</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    line : str</span>
<span class="sd">        String containing tabs to be replaced with spaces.</span>
<span class="sd">    escapechar : str</span>
<span class="sd">        Character in ``line`` used to escape special characters.</span>
<span class="sd">    quotechar: str</span>
<span class="sd">        Character in ``line`` indicating the start/end of a substring.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    line : str</span>
<span class="sd">        A copy of ``line`` with tabs replaced by spaces, preserving quoted substrings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">newline</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">in_quote</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">lastchar</span> <span class="o">=</span> <span class="s">&#39;NONE&#39;</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="n">quotechar</span> <span class="ow">and</span> <span class="n">lastchar</span> <span class="o">!=</span> <span class="n">escapechar</span><span class="p">:</span>
            <span class="n">in_quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">in_quote</span>
        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">in_quote</span><span class="p">:</span>
            <span class="n">char</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>
        <span class="n">lastchar</span> <span class="o">=</span> <span class="n">char</span>
        <span class="n">newline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">newline</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_line_index</span><span class="p">(</span><span class="n">line_or_func</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the appropriate line index, depending on ``line_or_func`` which</span>
<span class="sd">    can be either a function, a positive or negative int, or None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">line_or_func</span><span class="p">,</span> <span class="s">&#39;__call__&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">line_or_func</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">line_or_func</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line_or_func</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">line_or_func</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_lines</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">n_lines</span> <span class="o">+</span> <span class="n">line_or_func</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">line_or_func</span>


<div class="viewcode-block" id="BaseHeader"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseHeader.html#astropy.io.ascii.BaseHeader">[docs]</a><span class="k">class</span> <span class="nc">BaseHeader</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base table header reader</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">auto_format</span> <span class="o">=</span> <span class="s">&#39;col</span><span class="si">%d</span><span class="s">&#39;</span>
    <span class="sd">&quot;&quot;&quot; format string for auto-generating column names &quot;&quot;&quot;</span>
    <span class="n">start_line</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="sd">&quot;&quot;&quot; None, int, or a function of ``lines`` that returns None or int &quot;&quot;&quot;</span>
    <span class="n">comment</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="sd">&quot;&quot;&quot; regular expression for comment lines &quot;&quot;&quot;</span>
    <span class="n">splitter_class</span> <span class="o">=</span> <span class="n">DefaultSplitter</span>
    <span class="sd">&quot;&quot;&quot; Splitter class for splitting data lines into columns &quot;&quot;&quot;</span>
    <span class="n">names</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="sd">&quot;&quot;&quot; list of names corresponding to each data column &quot;&quot;&quot;</span>
    <span class="n">write_comment</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">write_spacer_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;ASCII_TABLE_WRITE_SPACER_LINE&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">splitter_class</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_cols_from_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">]</span>

<div class="viewcode-block" id="BaseHeader.update_meta"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseHeader.html#astropy.io.ascii.BaseHeader.update_meta">[docs]</a>    <span class="k">def</span> <span class="nf">update_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">meta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract any table-level metadata, e.g. keywords, comments, column metadata, from</span>
<span class="sd">        the table ``lines`` and update the OrderedDict ``meta`` in place.  This base</span>
<span class="sd">        method extracts comment lines and stores them in ``meta`` for output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">:</span>
            <span class="n">re_comment</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">)</span>
            <span class="n">comment_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="n">re_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comment_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">comment_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;^&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                         <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comment_lines</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">comment_lines</span><span class="p">:</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&#39;table&#39;</span><span class="p">,</span> <span class="p">{})[</span><span class="s">&#39;comments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comment_lines</span>
</div>
<div class="viewcode-block" id="BaseHeader.get_cols"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseHeader.html#astropy.io.ascii.BaseHeader.get_cols">[docs]</a>    <span class="k">def</span> <span class="nf">get_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the header Column objects from the table ``lines``.</span>

<span class="sd">        Based on the previously set Header attributes find or create the column names.</span>
<span class="sd">        Sets ``self.cols`` with the list of Columns.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lines : list</span>
<span class="sd">            List of table lines</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">start_line</span> <span class="o">=</span> <span class="n">_get_line_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">start_line</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># No header line so auto-generate names from n_data_cols</span>
            <span class="c"># Get the data values from the first line of table data to determine n_data_cols</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">first_data_vals</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_str_vals</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InconsistentTableError</span><span class="p">(</span><span class="s">&#39;No data lines found so cannot autogenerate &#39;</span>
                                             <span class="s">&#39;column names&#39;</span><span class="p">)</span>
            <span class="n">n_data_cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_data_vals</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">auto_format</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_data_cols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">start_line</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c"># No header line matching</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;No header line found in table&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="p">([</span><span class="n">line</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cols_from_names</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="BaseHeader.process_lines"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseHeader.html#astropy.io.ascii.BaseHeader.process_lines">[docs]</a>    <span class="k">def</span> <span class="nf">process_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generator to yield non-blank and non-comment lines&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">:</span>
            <span class="n">re_comment</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">)</span>
        <span class="c"># Yield non-comment lines</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">re_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)):</span>
                <span class="k">yield</span> <span class="n">line</span>
</div>
<div class="viewcode-block" id="BaseHeader.write_comments"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseHeader.html#astropy.io.ascii.BaseHeader.write_comments">[docs]</a>    <span class="k">def</span> <span class="nf">write_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">meta</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_comment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">False</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;comments&#39;</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">write_comment</span> <span class="o">+</span> <span class="n">comment</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseHeader.write"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseHeader.html#astropy.io.ascii.BaseHeader.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">spacer_line</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_line</span><span class="p">),</span>
                                      <span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">write_spacer_lines</span><span class="p">)):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spacer_line</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">]))</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">colnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the column names of the table&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">Column</span><span class="p">)</span> <span class="k">else</span> <span class="n">col</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">name</span>
                     <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)</span>

<div class="viewcode-block" id="BaseHeader.get_type_map_key"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseHeader.html#astropy.io.ascii.BaseHeader.get_type_map_key">[docs]</a>    <span class="k">def</span> <span class="nf">get_type_map_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">col</span><span class="o">.</span><span class="n">raw_type</span>
</div>
<div class="viewcode-block" id="BaseHeader.get_col_type"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseHeader.html#astropy.io.ascii.BaseHeader.get_col_type">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">type_map_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_type_map_key</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_type_map</span><span class="p">[</span><span class="n">type_map_key</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Unknown data type &quot;&quot;</span><span class="si">%s</span><span class="s">&quot;&quot; for column &quot;</span><span class="si">%s</span><span class="s">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">col</span><span class="o">.</span><span class="n">raw_type</span><span class="p">,</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="BaseHeader.check_column_names"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseHeader.html#astropy.io.ascii.BaseHeader.check_column_names">[docs]</a>    <span class="k">def</span> <span class="nf">check_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">strict_names</span><span class="p">,</span> <span class="n">guessing</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check column names.</span>

<span class="sd">        This must be done before applying the names transformation</span>
<span class="sd">        so that guessing will fail appropriately if ``names`` is supplied.</span>
<span class="sd">        For instance if the basic reader is given a table with no column header</span>
<span class="sd">        row.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        names : list</span>
<span class="sd">            User-supplied list of column names</span>
<span class="sd">        strict_names : bool</span>
<span class="sd">            Whether to impose extra requirements on names</span>
<span class="sd">        guessing : bool</span>
<span class="sd">            True if this method is being called while guessing the table format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">strict_names</span><span class="p">:</span>
            <span class="c"># Impose strict requirements on column names (normally used in guessing)</span>
            <span class="n">bads</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="s">&quot;|&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">colnames</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_is_number</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span>
                    <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">bads</span> <span class="ow">or</span>
                    <span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">bads</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Column name {0!r} does not meet strict name requirements&#39;</span>
                                     <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># When guessing require at least two columns</span>
        <span class="k">if</span> <span class="n">guessing</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colnames</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Strict name guessing requires at least two columns&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colnames</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Length of names argument ({0}) does not match number&#39;</span>
                             <span class="s">&#39; of table columns ({1})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colnames</span><span class="p">)))</span>

</div></div>
<div class="viewcode-block" id="BaseData"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseData.html#astropy.io.ascii.BaseData">[docs]</a><span class="k">class</span> <span class="nc">BaseData</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base table data reader.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_line</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="sd">&quot;&quot;&quot; None, int, or a function of ``lines`` that returns None or int &quot;&quot;&quot;</span>
    <span class="n">end_line</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="sd">&quot;&quot;&quot; None, int, or a function of ``lines`` that returns None or int &quot;&quot;&quot;</span>
    <span class="n">comment</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="sd">&quot;&quot;&quot; Regular expression for comment lines &quot;&quot;&quot;</span>
    <span class="n">splitter_class</span> <span class="o">=</span> <span class="n">DefaultSplitter</span>
    <span class="sd">&quot;&quot;&quot; Splitter class for splitting data lines into columns &quot;&quot;&quot;</span>
    <span class="n">write_spacer_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;ASCII_TABLE_WRITE_SPACER_LINE&#39;</span><span class="p">]</span>
    <span class="n">fill_include_names</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">fill_exclude_names</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="c"># Currently, the default matches the numpy default for masked values.</span>
    <span class="n">fill_values</span> <span class="o">=</span> <span class="p">[(</span><span class="n">masked</span><span class="p">,</span> <span class="s">&#39;--&#39;</span><span class="p">)]</span>
    <span class="n">formats</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Need to make sure fill_values list is instance attribute, not class attribute.</span>
        <span class="c"># On read, this will be overwritten by the default in the ui.read (thus, in</span>
        <span class="c"># the current implementation there can be no different default for different</span>
        <span class="c"># Readers). On write, ui.py does not specify a default, so this line here matters.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formats</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">splitter_class</span><span class="p">()</span>

<div class="viewcode-block" id="BaseData.process_lines"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseData.html#astropy.io.ascii.BaseData.process_lines">[docs]</a>    <span class="k">def</span> <span class="nf">process_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Strip out comment lines and blank lines from list of ``lines``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lines : list</span>
<span class="sd">            All lines in table</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lines : list</span>
<span class="sd">            List of lines</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nonblank_lines</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">:</span>
            <span class="n">re_comment</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nonblank_lines</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">re_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nonblank_lines</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="BaseData.get_data_lines"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseData.html#astropy.io.ascii.BaseData.get_data_lines">[docs]</a>    <span class="k">def</span> <span class="nf">get_data_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the ``data_lines`` attribute to the lines slice comprising the</span>
<span class="sd">        table data values.&quot;&quot;&quot;</span>
        <span class="n">data_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="n">start_line</span> <span class="o">=</span> <span class="n">_get_line_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_line</span><span class="p">,</span> <span class="n">data_lines</span><span class="p">)</span>
        <span class="n">end_line</span> <span class="o">=</span> <span class="n">_get_line_index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_line</span><span class="p">,</span> <span class="n">data_lines</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">end_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_lines</span> <span class="o">=</span> <span class="n">data_lines</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">start_line</span><span class="p">,</span> <span class="n">end_line</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># Don&#39;t copy entire data lines unless necessary</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_lines</span> <span class="o">=</span> <span class="n">data_lines</span>
</div>
<div class="viewcode-block" id="BaseData.get_str_vals"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseData.html#astropy.io.ascii.BaseData.get_str_vals">[docs]</a>    <span class="k">def</span> <span class="nf">get_str_vals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a generator that returns a list of column values (as strings)</span>
<span class="sd">        for each data line.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_lines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseData.masks"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseData.html#astropy.io.ascii.BaseData.masks">[docs]</a>    <span class="k">def</span> <span class="nf">masks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set fill value for each column and then apply that fill value</span>

<span class="sd">        In the first step it is evaluated with value from ``fill_values`` applies to</span>
<span class="sd">        which column using ``fill_include_names`` and ``fill_exclude_names``.</span>
<span class="sd">        In the second step all replacements are done for the appropriate columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_fill_values</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_masks</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_set_fill_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the fill values of the individual cols based on fill_values of BaseData</span>

<span class="sd">        fill values has the following form:</span>
<span class="sd">        &lt;fill_spec&gt; = (&lt;bad_value&gt;, &lt;fill_value&gt;, &lt;optional col_name&gt;...)</span>
<span class="sd">        fill_values = &lt;fill_spec&gt; or list of &lt;fill_spec&gt;&#39;s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span><span class="p">:</span>
            <span class="c"># when we write tables the columns may be astropy.table.Columns</span>
            <span class="c"># which don&#39;t carry a fill_values by default</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="k">if</span> <span class="o">~</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s">&#39;fill_values&#39;</span><span class="p">):</span>
                    <span class="n">col</span><span class="o">.</span><span class="n">fill_values</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c"># if input is only one &lt;fill_spec&gt;, then make it a list</span>
            <span class="k">with</span> <span class="n">ignored</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span><span class="p">]</span>

            <span class="c"># Step 1: Set the default list of columns which are affected by</span>
            <span class="c"># fill_values</span>
            <span class="n">colnames</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">colnames</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_include_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">colnames</span><span class="o">.</span><span class="n">intersection_update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_include_names</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_exclude_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">colnames</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_exclude_names</span><span class="p">)</span>

            <span class="c"># Step 2a: Find out which columns are affected by this tuple</span>
            <span class="c"># iterate over reversed order, so last condition is set first and</span>
            <span class="c"># overwritten by earlier conditions</span>
            <span class="k">for</span> <span class="n">replacement</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">replacement</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Format of fill_values must be &quot;</span>
                                     <span class="s">&quot;(&lt;bad&gt;, &lt;fill&gt;, &lt;optional col1&gt;, ...)&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">replacement</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">affect_cols</span> <span class="o">=</span> <span class="n">colnames</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">affect_cols</span> <span class="o">=</span> <span class="n">replacement</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">colnames</span><span class="p">)</span>
                               <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">affect_cols</span><span class="p">):</span>
                    <span class="n">cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_values</span><span class="p">[</span><span class="n">replacement</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">replacement</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_set_masks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replace string values in col.str_vals and set masks&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">(</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">fill_values</span><span class="p">):</span>
                <span class="n">col</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">str_vals</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">str_val</span> <span class="ow">in</span> <span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">str_vals</span><span class="p">)</span>
                                   <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">fill_values</span><span class="p">):</span>
                    <span class="n">col</span><span class="o">.</span><span class="n">str_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">fill_values</span><span class="p">[</span><span class="n">str_val</span><span class="p">]</span>
                    <span class="n">col</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">_replace_vals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replace string values in col.str_vals&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">(</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">fill_values</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">str_val</span> <span class="ow">in</span> <span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">str_vals</span><span class="p">)</span>
                                   <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">fill_values</span><span class="p">):</span>
                    <span class="n">col</span><span class="o">.</span><span class="n">str_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">fill_values</span><span class="p">[</span><span class="n">str_val</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">masked</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">fill_values</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s">&#39;mask&#39;</span><span class="p">):</span>
                    <span class="n">mask_val</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">fill_values</span><span class="p">[</span><span class="n">masked</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">col</span><span class="o">.</span><span class="n">str_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mask_val</span>

<div class="viewcode-block" id="BaseData.str_vals"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseData.html#astropy.io.ascii.BaseData.str_vals">[docs]</a>    <span class="k">def</span> <span class="nf">str_vals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;convert all values in table to a list of lists of strings&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_fill_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_col_formats</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
            <span class="n">col</span><span class="o">.</span><span class="n">str_vals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">iter_str_vals</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_replace_vals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">str_vals</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="BaseData.write"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseData.html#astropy.io.ascii.BaseData.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_line</span><span class="p">,</span> <span class="s">&#39;__call__&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Start_line attribute cannot be callable for write()&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_start_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_line</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">data_start_line</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">write_spacer_lines</span><span class="p">))</span>

        <span class="n">col_str_iters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_vals</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">vals</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">col_str_iters</span><span class="p">):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vals</span><span class="p">))</span>
</div>
    <span class="k">def</span> <span class="nf">_set_col_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">formats</span><span class="p">:</span>
                <span class="n">col</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">formats</span><span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="convert_numpy"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.convert_numpy.html#astropy.io.ascii.convert_numpy">[docs]</a><span class="k">def</span> <span class="nf">convert_numpy</span><span class="p">(</span><span class="n">numpy_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a tuple containing a function which converts a list into a numpy</span>
<span class="sd">    array and the type produced by the converter function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    numpy_type : numpy data-type</span>
<span class="sd">        The numpy type required of an array returned by ``converter``. Must be a</span>
<span class="sd">        valid `numpy type &lt;http://docs.scipy.org/doc/numpy/user/basics.types.html&gt;`_,</span>
<span class="sd">        e.g. numpy.int, numpy.uint, numpy.int8, numpy.int64, numpy.float,</span>
<span class="sd">        numpy.float64, numpy.str.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    (converter, converter_type) : (function, generic data-type)</span>
<span class="sd">        ``converter`` is a function which accepts a list and converts it to a</span>
<span class="sd">        numpy array of type ``numpy_type``.</span>
<span class="sd">        ``converter_type`` tracks the generic data type produced by the converter</span>
<span class="sd">        function.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Raised by ``converter`` if the list elements could not be converted to</span>
<span class="sd">        the required type.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># Infer converter type from an instance of numpy_type.</span>
    <span class="n">type_name</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy_type</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span>
    <span class="k">if</span> <span class="s">&#39;int&#39;</span> <span class="ow">in</span> <span class="n">type_name</span><span class="p">:</span>
        <span class="n">converter_type</span> <span class="o">=</span> <span class="n">IntType</span>
    <span class="k">elif</span> <span class="s">&#39;float&#39;</span> <span class="ow">in</span> <span class="n">type_name</span><span class="p">:</span>
        <span class="n">converter_type</span> <span class="o">=</span> <span class="n">FloatType</span>
    <span class="k">elif</span> <span class="s">&#39;bool&#39;</span> <span class="ow">in</span> <span class="n">type_name</span><span class="p">:</span>
        <span class="n">converter_type</span> <span class="o">=</span> <span class="n">BoolType</span>
    <span class="k">elif</span> <span class="s">&#39;str&#39;</span> <span class="ow">in</span> <span class="n">type_name</span><span class="p">:</span>
        <span class="n">converter_type</span> <span class="o">=</span> <span class="n">StrType</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">converter_type</span> <span class="o">=</span> <span class="n">AllType</span>

    <span class="k">def</span> <span class="nf">bool_converter</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert values &quot;False&quot; and &quot;True&quot; to bools.  Raise an exception</span>
<span class="sd">        for any other string values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Try a smaller subset first for a long array</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
            <span class="n">svals</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vals</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">svals</span> <span class="o">==</span> <span class="s">&#39;False&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">svals</span> <span class="o">==</span> <span class="s">&#39;True&#39;</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;bool input strings must be only False or True&#39;</span><span class="p">)</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
        <span class="n">trues</span> <span class="o">=</span> <span class="n">vals</span> <span class="o">==</span> <span class="s">&#39;True&#39;</span>
        <span class="n">falses</span> <span class="o">=</span> <span class="n">vals</span> <span class="o">==</span> <span class="s">&#39;False&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">trues</span> <span class="o">|</span> <span class="n">falses</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;bool input strings must be only False or True&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">trues</span>

    <span class="k">def</span> <span class="nf">generic_converter</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">numpy_type</span><span class="p">)</span>

    <span class="n">converter</span> <span class="o">=</span> <span class="n">bool_converter</span> <span class="k">if</span> <span class="n">converter_type</span> <span class="ow">is</span> <span class="n">BoolType</span> <span class="k">else</span> <span class="n">generic_converter</span>

    <span class="k">return</span> <span class="n">converter</span><span class="p">,</span> <span class="n">converter_type</span>

</div>
<div class="viewcode-block" id="BaseOutputter"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseOutputter.html#astropy.io.ascii.BaseOutputter">[docs]</a><span class="k">class</span> <span class="nc">BaseOutputter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Output table as a dict of column objects keyed on column name.  The</span>
<span class="sd">    table data are stored as plain python lists within the column objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">converters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c"># Derived classes must define default_converters and __call__</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_validate_and_copy</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">converters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Validate the format for the type converters and then copy those</span>
<span class="sd">        which are valid converters for this column (i.e. converter type is</span>
<span class="sd">        a subclass of col.type)&quot;&quot;&quot;</span>
        <span class="n">converters_out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">converter</span> <span class="ow">in</span> <span class="n">converters</span><span class="p">:</span>
                <span class="n">converter_func</span><span class="p">,</span> <span class="n">converter_type</span> <span class="o">=</span> <span class="n">converter</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">converter_type</span><span class="p">,</span> <span class="n">NoType</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">converter_type</span><span class="p">,</span> <span class="n">col</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
                    <span class="n">converters_out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">converter_func</span><span class="p">,</span> <span class="n">converter_type</span><span class="p">))</span>

        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Error: invalid format for converters, see documentation</span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span>
                             <span class="n">converters</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">converters_out</span>

    <span class="k">def</span> <span class="nf">_convert_vals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
            <span class="c"># If a specific dtype was specified for a column, then use that</span>
            <span class="c"># to set the defaults, otherwise use the generic defaults.</span>
            <span class="n">default_converters</span> <span class="o">=</span> <span class="p">([</span><span class="n">convert_numpy</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">dtype</span><span class="p">)]</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">dtype</span>
                                  <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_converters</span><span class="p">)</span>

            <span class="c"># If the user supplied a specific convert then that takes precedence over defaults</span>
            <span class="n">converters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">converters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">default_converters</span><span class="p">)</span>

            <span class="n">col</span><span class="o">.</span><span class="n">converters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_copy</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">converters</span><span class="p">)</span>

            <span class="c"># Catch the last error in order to provide additional information</span>
            <span class="c"># in case all attempts at column conversion fail.  The initial</span>
            <span class="c"># value of of last_error will apply if no converters are defined</span>
            <span class="c"># and the first col.converters[0] access raises IndexError.</span>
            <span class="n">last_err</span> <span class="o">=</span> <span class="s">&#39;no converters defined&#39;</span>

            <span class="k">while</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s">&#39;data&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">converter_func</span><span class="p">,</span> <span class="n">converter_type</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">converters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">converter_type</span><span class="p">,</span> <span class="n">col</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;converter type does not match column type&#39;</span><span class="p">)</span>
                    <span class="n">col</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">converter_func</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">str_vals</span><span class="p">)</span>
                    <span class="n">col</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">converter_type</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="n">col</span><span class="o">.</span><span class="n">converters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">last_err</span> <span class="o">=</span> <span class="n">err</span>
                <span class="k">except</span> <span class="ne">OverflowError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="c"># Overflow during conversion (most likely an int that doesn&#39;t fit in native C long).</span>
                    <span class="c"># Put string at the top of the converters list for the next while iteration.</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;OverflowError converting to {0} for column {1}, using string instead.&quot;</span>
                                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">converter_type</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">AstropyWarning</span><span class="p">)</span>
                    <span class="n">col</span><span class="o">.</span><span class="n">converters</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">convert_numpy</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">str</span><span class="p">))</span>
                    <span class="n">last_err</span> <span class="o">=</span> <span class="n">err</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Column {} failed to convert: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">last_err</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="TableOutputter"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.TableOutputter.html#astropy.io.ascii.TableOutputter">[docs]</a><span class="k">class</span> <span class="nc">TableOutputter</span><span class="p">(</span><span class="n">BaseOutputter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Output the table as an astropy.table.Table object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">default_converters</span> <span class="o">=</span> <span class="p">[</span><span class="n">convert_numpy</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int</span><span class="p">),</span>
                          <span class="n">convert_numpy</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float</span><span class="p">),</span>
                          <span class="n">convert_numpy</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">str</span><span class="p">)]</span>

<div class="viewcode-block" id="TableOutputter.__call__"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.TableOutputter.html#astropy.io.ascii.TableOutputter.__call__">[docs]</a>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">meta</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_convert_vals</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>

        <span class="c"># If there are any values that were filled and tagged with a mask bit then this</span>
        <span class="c"># will be a masked table.  Otherwise use a plain table.</span>
        <span class="n">masked</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s">&#39;mask&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">numpy</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">)</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">],</span> <span class="n">masked</span><span class="o">=</span><span class="n">masked</span><span class="p">,</span>
                    <span class="n">meta</span><span class="o">=</span><span class="n">meta</span><span class="p">[</span><span class="s">&#39;table&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">out_col</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">masked</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s">&#39;mask&#39;</span><span class="p">):</span>
                <span class="n">out_col</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">mask</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;format&#39;</span><span class="p">,</span> <span class="s">&#39;unit&#39;</span><span class="p">,</span> <span class="s">&#39;description&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">out_col</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s">&#39;meta&#39;</span><span class="p">):</span>
                <span class="n">out_col</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span>

</div></div>
<span class="k">class</span> <span class="nc">MetaBaseReader</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">dct</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MetaBaseReader</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">dct</span><span class="p">)</span>

        <span class="n">format</span> <span class="o">=</span> <span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;_format_name&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">format</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">fast</span> <span class="o">=</span> <span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;_fast&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fast</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">FAST_CLASSES</span><span class="p">[</span><span class="n">format</span><span class="p">]</span> <span class="o">=</span> <span class="n">cls</span>

        <span class="n">FORMAT_CLASSES</span><span class="p">[</span><span class="n">format</span><span class="p">]</span> <span class="o">=</span> <span class="n">cls</span>

        <span class="n">io_formats</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;ascii.&#39;</span> <span class="o">+</span> <span class="n">format</span><span class="p">]</span> <span class="o">+</span> <span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;_io_registry_format_aliases&#39;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">if</span> <span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;_io_registry_suffix&#39;</span><span class="p">):</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">connect</span><span class="o">.</span><span class="n">io_identify</span><span class="p">,</span> <span class="n">dct</span><span class="p">[</span><span class="s">&#39;_io_registry_suffix&#39;</span><span class="p">])</span>
            <span class="n">connect</span><span class="o">.</span><span class="n">io_registry</span><span class="o">.</span><span class="n">register_identifier</span><span class="p">(</span><span class="n">io_formats</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Table</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">io_format</span> <span class="ow">in</span> <span class="n">io_formats</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">connect</span><span class="o">.</span><span class="n">io_read</span><span class="p">,</span> <span class="n">io_format</span><span class="p">)</span>
            <span class="n">connect</span><span class="o">.</span><span class="n">io_registry</span><span class="o">.</span><span class="n">register_reader</span><span class="p">(</span><span class="n">io_format</span><span class="p">,</span> <span class="n">Table</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;_io_registry_can_write&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">):</span>
                <span class="n">func</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">connect</span><span class="o">.</span><span class="n">io_write</span><span class="p">,</span> <span class="n">io_format</span><span class="p">)</span>
                <span class="n">connect</span><span class="o">.</span><span class="n">io_registry</span><span class="o">.</span><span class="n">register_writer</span><span class="p">(</span><span class="n">io_format</span><span class="p">,</span> <span class="n">Table</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_is_number</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">ignored</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">_apply_include_exclude_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">include_names</span><span class="p">,</span> <span class="n">exclude_names</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply names, include_names and exclude_names to a table.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table : `~astropy.table.Table`</span>
<span class="sd">        Input table</span>
<span class="sd">    names : list</span>
<span class="sd">        List of names to override those in table (set to None to use existing names)</span>
<span class="sd">    include_names : list</span>
<span class="sd">        List of names to include in output</span>
<span class="sd">    exclude_names: list</span>
<span class="sd">        List of names to exclude from output (applied after ``include_names``)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># Rename table column names to those passed by user</span>
        <span class="c"># Temporarily rename with names that are not in `names` or `table.colnames`.</span>
        <span class="c"># This ensures that rename succeeds regardless of existing names.</span>
        <span class="n">xxxs</span> <span class="o">=</span> <span class="s">&#39;x&#39;</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">colnames</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">colname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">colnames</span><span class="p">):</span>
            <span class="n">table</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="n">colname</span><span class="p">,</span> <span class="n">xxxs</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
            <span class="n">table</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="n">xxxs</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>

    <span class="n">names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">colnames</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">names</span><span class="o">.</span><span class="n">intersection_update</span><span class="p">(</span><span class="n">include_names</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exclude_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">names</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="n">exclude_names</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">names</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">colnames</span><span class="p">):</span>
        <span class="n">remove_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">colnames</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">remove_names</span><span class="p">)</span>


<span class="nd">@six.add_metaclass</span><span class="p">(</span><span class="n">MetaBaseReader</span><span class="p">)</span>
<div class="viewcode-block" id="BaseReader"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseReader.html#astropy.io.ascii.BaseReader">[docs]</a><span class="k">class</span> <span class="nc">BaseReader</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class providing methods to read and write an ASCII table using the specified</span>
<span class="sd">    header, data, inputter, and outputter instances.</span>

<span class="sd">    Typical usage is to instantiate a Reader() object and customize the</span>
<span class="sd">    ``header``, ``data``, ``inputter``, and ``outputter`` attributes.  Each</span>
<span class="sd">    of these is an object of the corresponding class.</span>

<span class="sd">    There is one method ``inconsistent_handler`` that can be used to customize the</span>
<span class="sd">    behavior of ``read()`` in the event that a data row doesn&#39;t match the header.</span>
<span class="sd">    The default behavior is to raise an InconsistentTableError.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">names</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">include_names</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">exclude_names</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">strict_names</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">guessing</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="n">header_class</span> <span class="o">=</span> <span class="n">BaseHeader</span>
    <span class="n">data_class</span> <span class="o">=</span> <span class="n">BaseData</span>
    <span class="n">inputter_class</span> <span class="o">=</span> <span class="n">BaseInputter</span>
    <span class="n">outputter_class</span> <span class="o">=</span> <span class="n">TableOutputter</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_class</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_class</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputter_class</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputter_class</span><span class="p">()</span>
        <span class="c"># Data and Header instances benefit from a little cross-coupling.  Header may need to</span>
        <span class="c"># know about number of data columns for auto-column name generation and Data may</span>
        <span class="c"># need to know about header (e.g. for fixed-width tables where widths are spec&#39;d in header.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

        <span class="c"># Metadata, consisting of table-level meta and column-level meta.  The latter</span>
        <span class="c"># could include information about column type, description, formatting, etc,</span>
        <span class="c"># depending on the table meta format.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">(),</span>
                                <span class="n">cols</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">())</span>

<div class="viewcode-block" id="BaseReader.read"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseReader.html#astropy.io.ascii.BaseReader.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the ``table`` and return the results in a format determined by</span>
<span class="sd">        the ``outputter`` attribute.</span>

<span class="sd">        The ``table`` parameter is any string or object that can be processed</span>
<span class="sd">        by the instance ``inputter``.  For the base Inputter class ``table`` can be</span>
<span class="sd">        one of:</span>

<span class="sd">        * File name</span>
<span class="sd">        * File-like object</span>
<span class="sd">        * String (newline separated) with all header and data lines (must have at least 2 lines)</span>
<span class="sd">        * List of strings</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str, file_like, list</span>
<span class="sd">            Input table.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            Output table</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># If ``table`` is a file then store the name in the ``data``</span>
        <span class="c"># attribute. The ``table`` is a &quot;file&quot; if it is a string</span>
        <span class="c"># without the new line specific to the OS.</span>
        <span class="k">with</span> <span class="n">ignored</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
            <span class="c"># Strings only</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table</span> <span class="o">+</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">table_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c"># Get a list of the lines (rows) in the table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputter</span><span class="o">.</span><span class="n">get_lines</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c"># Set self.data.data_lines to a slice of lines contain the data rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_data_lines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span>

        <span class="c"># Extract table meta values (e.g. keywords, comments, etc).  Updates self.meta.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">update_meta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span>

        <span class="c"># Get the table column definitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">get_cols</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span>

        <span class="c"># Make sure columns are valid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">check_column_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">guessing</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">cols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span>
        <span class="n">n_cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">str_vals</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_str_vals</span><span class="p">()):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_vals</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_cols</span><span class="p">:</span>
                <span class="n">str_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inconsistent_handler</span><span class="p">(</span><span class="n">str_vals</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>

                <span class="c"># if str_vals is None, we skip this row</span>
                <span class="k">if</span> <span class="n">str_vals</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c"># otherwise, we raise an error only if it is still inconsistent</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_vals</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_cols</span><span class="p">:</span>
                    <span class="n">errmsg</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;Number of header columns (</span><span class="si">%d</span><span class="s">) inconsistent with &#39;</span>
                              <span class="s">&#39;data columns (</span><span class="si">%d</span><span class="s">) at data line </span><span class="si">%d</span><span class="se">\n</span><span class="s">&#39;</span>
                              <span class="s">&#39;Header values: </span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span>
                              <span class="s">&#39;Data values: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n_cols</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_vals</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span>
                                                   <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">],</span> <span class="n">str_vals</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="n">InconsistentTableError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
                <span class="n">col</span><span class="o">.</span><span class="n">str_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">str_vals</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">masks</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
        <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputter</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">,</span> <span class="s">&#39;table_meta&#39;</span><span class="p">):</span>
            <span class="n">table</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">table_meta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">cols</span>

        <span class="n">_apply_include_exclude_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclude_names</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">table</span>
</div>
<div class="viewcode-block" id="BaseReader.inconsistent_handler"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseReader.html#astropy.io.ascii.BaseReader.inconsistent_handler">[docs]</a>    <span class="k">def</span> <span class="nf">inconsistent_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">str_vals</span><span class="p">,</span> <span class="n">ncols</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjust or skip data entries if a row is inconsistent with the header.</span>

<span class="sd">        The default implementation does no adjustment, and hence will always trigger</span>
<span class="sd">        an exception in read() any time the number of data entries does not match</span>
<span class="sd">        the header.</span>

<span class="sd">        Note that this will *not* be called if the row already matches the header.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        str_vals : list</span>
<span class="sd">            A list of value strings from the current row of the table.</span>
<span class="sd">        ncols : int</span>
<span class="sd">            The expected number of entries from the table header.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str_vals : list</span>
<span class="sd">            List of strings to be parsed into data entries in the output table. If</span>
<span class="sd">            the length of this list does not match ``ncols``, an exception will be</span>
<span class="sd">            raised in read().  Can also be None, in which case the row will be</span>
<span class="sd">            skipped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># an empty list will always trigger an InconsistentTableError in read()</span>
        <span class="k">return</span> <span class="n">str_vals</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">comment_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return lines in the table that match header.comment regexp&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;lines&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Table must be read prior to accessing the header comment lines&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">comment</span><span class="p">:</span>
            <span class="n">re_comment</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">comment</span><span class="p">)</span>
            <span class="n">comment_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="k">if</span> <span class="n">re_comment</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comment_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">comment_lines</span>

<div class="viewcode-block" id="BaseReader.write_header"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseReader.html#astropy.io.ascii.BaseReader.write_header">[docs]</a>    <span class="k">def</span> <span class="nf">write_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">meta</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">write_comments</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">meta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BaseReader.write"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.BaseReader.html#astropy.io.ascii.BaseReader.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write ``table`` as list of strings.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            Input table data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lines : list</span>
<span class="sd">            List of strings corresponding to ASCII table</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Check column names before altering</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">check_column_names</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict_names</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

        <span class="n">_apply_include_exclude_names</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclude_names</span><span class="p">)</span>

        <span class="c"># Now use altered columns</span>
        <span class="n">new_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">itervalues</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
        <span class="c"># link information about the columns to the writer object (i.e. self)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="n">new_cols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="n">new_cols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">table_meta</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">meta</span>

        <span class="c"># Write header and data to lines list</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_header</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">lines</span>

</div></div>
<div class="viewcode-block" id="ContinuationLinesInputter"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.ContinuationLinesInputter.html#astropy.io.ascii.ContinuationLinesInputter">[docs]</a><span class="k">class</span> <span class="nc">ContinuationLinesInputter</span><span class="p">(</span><span class="n">BaseInputter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inputter where lines ending in ``continuation_char`` are joined</span>
<span class="sd">    with the subsequent line.  Example::</span>

<span class="sd">      col1 col2 col3</span>
<span class="sd">      1 \</span>
<span class="sd">      2 3</span>
<span class="sd">      4 5 \</span>
<span class="sd">      6</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">continuation_char</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">&#39;</span>
    <span class="n">replace_char</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>
    <span class="c"># If no_continue is not None then lines matching this regex are not subject</span>
    <span class="c"># to line continuation.  The initial use case here is Daophot.  In this</span>
    <span class="c"># case the continuation character is just replaced with replace_char.</span>
    <span class="n">no_continue</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="ContinuationLinesInputter.process_lines"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.ContinuationLinesInputter.html#astropy.io.ascii.ContinuationLinesInputter.process_lines">[docs]</a>    <span class="k">def</span> <span class="nf">process_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="n">re_no_continue</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_continue</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_continue</span> <span class="k">else</span> <span class="bp">None</span>

        <span class="n">parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">outlines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">re_no_continue</span> <span class="ow">and</span> <span class="n">re_no_continue</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">continuation_char</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_char</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">continuation_char</span><span class="p">):</span>
                <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">continuation_char</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_char</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">outlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">))</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">outlines</span>

</div></div>
<div class="viewcode-block" id="WhitespaceSplitter"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.WhitespaceSplitter.html#astropy.io.ascii.WhitespaceSplitter">[docs]</a><span class="k">class</span> <span class="nc">WhitespaceSplitter</span><span class="p">(</span><span class="n">DefaultSplitter</span><span class="p">):</span>
<div class="viewcode-block" id="WhitespaceSplitter.process_line"><a class="viewcode-back" href="../../../../api/astropy.io.ascii.WhitespaceSplitter.html#astropy.io.ascii.WhitespaceSplitter.process_line">[docs]</a>    <span class="k">def</span> <span class="nf">process_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replace tab with space within ``line`` while respecting quoted substrings&quot;&quot;&quot;</span>
        <span class="n">newline</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">in_quote</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">lastchar</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">quotechar</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">escapechar</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span>
                                           <span class="n">lastchar</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">escapechar</span><span class="p">):</span>
                <span class="n">in_quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">in_quote</span>
            <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">in_quote</span><span class="p">:</span>
                <span class="n">char</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>
            <span class="n">lastchar</span> <span class="o">=</span> <span class="n">char</span>
            <span class="n">newline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>

        <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">newline</span><span class="p">)</span>
</div></div>
<span class="n">extra_reader_pars</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;Reader&#39;</span><span class="p">,</span> <span class="s">&#39;Inputter&#39;</span><span class="p">,</span> <span class="s">&#39;Outputter&#39;</span><span class="p">,</span>
                     <span class="s">&#39;delimiter&#39;</span><span class="p">,</span> <span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;quotechar&#39;</span><span class="p">,</span> <span class="s">&#39;header_start&#39;</span><span class="p">,</span>
                     <span class="s">&#39;data_start&#39;</span><span class="p">,</span> <span class="s">&#39;data_end&#39;</span><span class="p">,</span> <span class="s">&#39;converters&#39;</span><span class="p">,</span>
                     <span class="s">&#39;data_Splitter&#39;</span><span class="p">,</span> <span class="s">&#39;header_Splitter&#39;</span><span class="p">,</span>
                     <span class="s">&#39;names&#39;</span><span class="p">,</span> <span class="s">&#39;include_names&#39;</span><span class="p">,</span> <span class="s">&#39;exclude_names&#39;</span><span class="p">,</span> <span class="s">&#39;strict_names&#39;</span><span class="p">,</span>
                     <span class="s">&#39;fill_values&#39;</span><span class="p">,</span> <span class="s">&#39;fill_include_names&#39;</span><span class="p">,</span> <span class="s">&#39;fill_exclude_names&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_reader</span><span class="p">(</span><span class="n">Reader</span><span class="p">,</span> <span class="n">Inputter</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Outputter</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize a table reader allowing for common customizations.  See ui.get_reader()</span>
<span class="sd">    for param docs.  This routine is for internal (package) use only and is useful</span>
<span class="sd">    because it depends only on the &quot;core&quot; module.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">.fastbasic</span> <span class="kn">import</span> <span class="n">FastBasic</span>
    <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">Reader</span><span class="p">,</span> <span class="n">FastBasic</span><span class="p">):</span> <span class="c"># Fast readers handle args separately</span>
        <span class="k">if</span> <span class="n">Inputter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;Inputter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Inputter</span>
        <span class="k">return</span> <span class="n">Reader</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="s">&#39;fast_reader&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fast_reader&#39;</span><span class="p">]</span> <span class="c"># ignore fast_reader parameter for slow readers</span>
    <span class="n">reader_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">extra_reader_pars</span><span class="p">)</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">(</span><span class="o">**</span><span class="n">reader_kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">Inputter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">inputter</span> <span class="o">=</span> <span class="n">Inputter</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">Outputter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">outputter</span> <span class="o">=</span> <span class="n">Outputter</span><span class="p">()</span>

    <span class="c"># Issue #855 suggested to set data_start to header_start + default_header_length</span>
    <span class="c"># Thus, we need to retrieve this from the class definition before resetting these numbers.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">default_header_length</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">start_line</span> <span class="o">-</span> <span class="n">reader</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start_line</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c"># Start line could be None or an instancemethod</span>
        <span class="n">default_header_length</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="s">&#39;delimiter&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;delimiter&#39;</span><span class="p">]</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;delimiter&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;comment&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;quotechar&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;quotechar&#39;</span><span class="p">]</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;quotechar&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;data_start&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">start_line</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;data_start&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;data_end&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">end_line</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;data_end&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;header_start&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">reader</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start_line</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;header_start&#39;</span><span class="p">]</span>
            <span class="c"># For FixedWidthTwoLine the data_start is calculated relative to the position line.</span>
            <span class="c"># However, position_line is given as absolute number and not relative to header_start.</span>
            <span class="c"># So, ignore this Reader here.</span>
            <span class="k">if</span> <span class="p">((</span><span class="s">&#39;data_start&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">default_header_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="n">reader</span><span class="o">.</span><span class="n">_format_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;fixed_width_two_line&#39;</span><span class="p">,</span> <span class="s">&#39;commented_header&#39;</span><span class="p">]):</span>
                <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">start_line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start_line</span> <span class="o">+</span> <span class="n">default_header_length</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;header_start&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># User trying to set a None header start to some value other than None</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;header_start cannot be modified for this Reader&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s">&#39;converters&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">outputter</span><span class="o">.</span><span class="n">converters</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;converters&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;data_Splitter&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">splitter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;data_Splitter&#39;</span><span class="p">]()</span>
    <span class="k">if</span> <span class="s">&#39;header_Splitter&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">splitter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;header_Splitter&#39;</span><span class="p">]()</span>
    <span class="k">if</span> <span class="s">&#39;names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;names&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;include_names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">include_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;include_names&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;exclude_names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">exclude_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;exclude_names&#39;</span><span class="p">]</span>
    <span class="c"># Strict names is normally set only within the guessing process to</span>
    <span class="c"># indicate that column names cannot be numeric or have certain</span>
    <span class="c"># characters at the beginning or end.  It gets used in</span>
    <span class="c"># BaseHeader.check_column_names().</span>
    <span class="k">if</span> <span class="s">&#39;strict_names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">strict_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;strict_names&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;fill_values&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_values</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fill_values&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;fill_include_names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_include_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fill_include_names&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;fill_exclude_names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_exclude_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fill_exclude_names&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">reader</span>

<span class="n">extra_writer_pars</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;delimiter&#39;</span><span class="p">,</span> <span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="s">&#39;quotechar&#39;</span><span class="p">,</span> <span class="s">&#39;formats&#39;</span><span class="p">,</span>
                     <span class="s">&#39;strip_whitespace&#39;</span><span class="p">,</span>
                     <span class="s">&#39;names&#39;</span><span class="p">,</span> <span class="s">&#39;include_names&#39;</span><span class="p">,</span> <span class="s">&#39;exclude_names&#39;</span><span class="p">,</span>
                     <span class="s">&#39;fill_values&#39;</span><span class="p">,</span> <span class="s">&#39;fill_include_names&#39;</span><span class="p">,</span>
                     <span class="s">&#39;fill_exclude_names&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_writer</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">fast_writer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize a table writer allowing for common customizations. This</span>
<span class="sd">    routine is for internal (package) use only and is useful because it depends</span>
<span class="sd">    only on the &quot;core&quot; module. &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">.fastbasic</span> <span class="kn">import</span> <span class="n">FastBasic</span>

    <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">FastBasic</span><span class="p">):</span> <span class="c"># Fast writers handle args separately</span>
        <span class="k">return</span> <span class="n">Writer</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">fast_writer</span> <span class="ow">and</span> <span class="s">&#39;fast_{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Writer</span><span class="o">.</span><span class="n">_format_name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">FAST_CLASSES</span><span class="p">:</span>
        <span class="c"># Switch to fast writer</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fast_writer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fast_writer</span>
        <span class="k">return</span> <span class="n">FAST_CLASSES</span><span class="p">[</span><span class="s">&#39;fast_{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Writer</span><span class="o">.</span><span class="n">_format_name</span><span class="p">)](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">writer_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">extra_writer_pars</span><span class="p">)</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">Writer</span><span class="p">(</span><span class="o">**</span><span class="n">writer_kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="s">&#39;delimiter&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;delimiter&#39;</span><span class="p">]</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;delimiter&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;comment&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">write_comment</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">write_comment</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;comment&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;quotechar&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;quotechar&#39;</span><span class="p">]</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;quotechar&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;formats&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;formats&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;strip_whitespace&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;strip_whitespace&#39;</span><span class="p">]:</span>
            <span class="c"># Restore the default SplitterClass process_val method which strips</span>
            <span class="c"># whitespace.  This may have been changed in the Writer</span>
            <span class="c"># initialization (e.g. Rdb and Tab)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">process_val</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">process_val</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="s">&#39;names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;names&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;include_names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">include_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;include_names&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;exclude_names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">exclude_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;exclude_names&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;fill_values&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_values</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fill_values&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;fill_include_names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_include_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fill_include_names&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;fill_exclude_names&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill_exclude_names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fill_exclude_names&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">writer</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2016, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1. &nbsp;
    Last built 12 May 2016. <br/>
  </p>
</footer>
  </body>
</html>